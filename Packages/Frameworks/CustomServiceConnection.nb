Notebook[{Cell[CellGroupData[{Cell["ServiceConnection", "CodeSection", 
      CellChangeTimes -> {{3.7048445511711807*^9, 3.7048445541044893*^9}}], 
     Cell[BoxData[RowBox[{RowBox[{"CustomServiceConnection", "::", "usage"}], 
         "=", "\"Builds a custom ServiceConnection paclet\""}]], "CodeInput", 
      CellChangeTimes -> {{3.704844557123069*^9, 3.704844594342607*^9}}], 
     Cell[BoxData[RowBox[{RowBox[{"Begin", "[", "\"`Private`\"", "]"}], 
         ";"}]], "InputSection"], 
     Cell[CellGroupData[{Cell["\[LeftCeiling]Setup\[RightFloor]", 
         "CodeSubsection", Evaluatable -> True, CellChangeTimes -> 
          {{3.7048446125032673*^9, 3.7048446212380047*^9}, 
           3.7048449905303793*^9}], Cell[CellGroupData[
          {Cell["\[LeftCeiling]Import Functions\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True, CellChangeTimes -> 
             {{3.704846115815501*^9, 3.7048461215344267*^9}}], 
           Cell[BoxData[RowBox[{RowBox[{RowBox[{"CustomServiceConnection", 
                   "::", "ifkey"}], "=", 
                 "\"Import function `` missing keys ``\""}], ";"}]], 
            "CodeInput", CellChangeTimes -> {{3.704846346990922*^9, 
             3.704846377707532*^9}}], Cell[BoxData[
             {RowBox[{RowBox[{RowBox[{"Options", "[", 
                    "customServiceConnectionImportFunction", "]"}], ":=", 
                  "\n", "\t", RowBox[{"{", "\n", "\t\t", RowBox[
                     {RowBox[{"\"URL\"", "\[Rule]", "None"}], ",", "\n", 
                      "\t\t", RowBox[{"\"Method\"", "\[Rule]", "\"GET\""}], 
                      ",", "\n", "\t\t", RowBox[{"\"Body\"", "\[Rule]", 
                        "None"}], ",", "\n", "\t\t", RowBox[{"\"Headers\"", 
                        "\[Rule]", "None"}], ",", "\n", "\t\t", RowBox[
                       {"\"Path\"", "\[Rule]", "None"}], ",", "\n", "\t\t", 
                      RowBox[{"\"Parameters\"", "\[Rule]", "None"}], ",", 
                      "\n", "\t\t", RowBox[{"\"Required\"", "\[Rule]", 
                        "None"}], ",", "\n", "\t\t", RowBox[{"\"Function\"", 
                        "\[Rule]", "None"}], ",", "\n", "\t\t", RowBox[
                       {"\"Permissions\"", "\[Rule]", "None"}], ",", "\n", 
                      "\t\t", RowBox[{"\"ReturnContentData\"", "\[Rule]", 
                        "None"}], ",", "\n", "\t\t", RowBox[
                       {"\"RequiredPermissions\"", "\[Rule]", "None"}], ",", 
                      "\n", "\t", "\t", RowBox[{"\"IncludeAuth\"", "\[Rule]", 
                        "None"}], ",", "\n", "\t", "\t", RowBox[
                       {"\"MultipartData\"", "\[Rule]", "None"}], ",", "\n", 
                      "\t", "\t", RowBox[{"\"BodyData\"", "\[Rule]", 
                        "None"}]}], "\n", "\t\t", "}"}]}], ";"}], "\n", 
              RowBox[{RowBox[{"customServiceConnectionImportFunction", "[", 
                  RowBox[{"name_", ",", RowBox[{"ops", ":", RowBox[
                       {"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", 
                "\t", RowBox[{"With", "[", "\n", "\t\t", RowBox[
                   {RowBox[{"{", "\n", "\t\t\t", RowBox[{RowBox[{"basic", 
                          "=", "\n", "\t\t\t\t", RowBox[{RowBox[
                          {"DeleteCases", "[", "None", "]"}], "@", "\n", 
                          "\t\t\t\t\t", RowBox[{"Association", "@", RowBox[
                          {"{", "ops", "}"}]}]}]}], ",", "\n", "\t\t\t", 
                        RowBox[{"required", "=", "\n", "\t\t\t\t", RowBox[
                          {"{", RowBox[{"\"URL\"", ",", "\"Path\""}], 
                          "}"}]}]}], "\n", "\t\t\t", "}"}], ",", "\n", 
                    "\t\t", RowBox[{"With", "[", RowBox[{RowBox[{"{", "\n", 
                          "\t\t\t", RowBox[{"function", "=", "\n", 
                          "\t\t\t\t", RowBox[{"Join", "[", "\n", 
                          "\t\t\t\t\t", RowBox[{RowBox[{RowBox[
                          {"DeleteCases", "[", RowBox[{"{", "}"}], "]"}], 
                          "@", "\n", "\t\t\t\t\t\t", RowBox[{"<|", "\n", 
                          "\t\t\t\t\t\t\t", RowBox[{RowBox[{"\"BodyData\"", 
                          "->", "\n", "\t\t\t\t\t\t\t\t", RowBox[{"Cases", 
                          "[", RowBox[{RowBox[{"Lookup", "[", RowBox[
                          {"basic", ",", "\"Body\"", ",", RowBox[{"{", 
                          "}"}]}], "]"}], ",", RowBox[{"_String", "|", 
                          "_Rule"}]}], "]"}]}], ",", "\n", "\t\t\t\t\t\t\t", 
                          RowBox[{"\"MultipartData\"", "->", "\n", 
                          "\t\t\t\t\t\t\t\t", RowBox[{"Cases", "[", RowBox[
                          {RowBox[{"Lookup", "[", RowBox[{"basic", ",", 
                          "\"Body\"", ",", RowBox[{"{", "}"}]}], "]"}], ",", 
                          "_List"}], "]"}]}]}], "\n", "\t\t\t\t\t\t\t", 
                          "|>"}]}], ",", "\n", "\t\t\t\t\t", RowBox[
                          {"KeyDrop", "[", "\n", "\t\t\t\t\t\t", RowBox[
                          {RowBox[{"KeyMap", "[", "\n", "\t\t\t\t\t\t\t", 
                          RowBox[{RowBox[{"Replace", "[", RowBox[{"{", "\n", 
                          "\t", "\t", "\t", "\t", "\t\t\t\t", RowBox[{RowBox[
                          {"\"Method\"", "\[Rule]", "\"HTTPSMethod\""}], ",", 
                          "\n", "\t", "\t", "\t", "\t", "\t\t\t\t", RowBox[
                          {"\"Path\"", "\[Rule]", "\"PathParameters\""}], 
                          ",", "\n", "\t", "\t", "\t", "\t", "\t\t\t\t", 
                          RowBox[{"\"Required\"", "\[Rule]", 
                          "\"RequiredParameters\""}], ",", "\n", "\t", "\t", 
                          "\t", "\t", "\t\t\t\t", RowBox[{"\"Function\"", 
                          "\[Rule]", "\"ResultsFunction\""}], ",", "\n", 
                          "\t\t\t\t\t\t\t\t", RowBox[{"\"Permissions\"", 
                          "->", "\"RequiredPermisssions\""}]}], "\n", 
                          "\t\t\t\t\t\t\t\t", "}"}], "]"}], ",", "\n", 
                          "\t\t\t\t\t\t\t", RowBox[{RowBox[{"If", "[", RowBox[
                          {RowBox[{"!", RowBox[{"(", RowBox[{RowBox[{
                          "KeyMemberQ", "[", RowBox[{"basic", ",", 
                          "\"Method\""}], "]"}], "&&", RowBox[{"KeyMemberQ", 
                          "[", RowBox[{"basic", ",", "\"HTTPSMethod\""}], 
                          "]"}]}], ")"}]}], ",", "\n", "\t", "\t", 
                          "\t\t\t\t\t\t", RowBox[{"Append", "[", RowBox[
                          {"\"Method\"", "\[Rule]", RowBox[{"OptionValue", 
                          "[", "\"Method\"", "]"}]}], "]"}], ",", "\n", "\t", 
                          "\t", "\t\t\t\t\t\t", "Identity"}], "\n", "\t", 
                          "\t", "\t\t\t\t\t\t", "]"}], "@", "basic"}]}], 
                          "\n", "\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                          "\t\t\t\t\t\t", "\"Body\""}], "\n", "\t\t\t\t\t\t", 
                          "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n", 
                          "\t\t\t", "}"}], ",", "\n", "\t\t\t", RowBox[
                         {"Replace", "[", "\n", "\t\t\t\t", RowBox[
                          {RowBox[{RowBox[{"Select", "[", "MissingQ", "]"}], 
                          "@", "\n", "\t\t\t\t\t", RowBox[{"Lookup", "[", 
                          RowBox[{"function", ",", RowBox[{
                          "AssociationThread", "[", RowBox[{"required", ",", 
                          "required"}], "]"}]}], "]"}]}], ",", RowBox[{"{", 
                          "\n", "\t\t\t\t\t", RowBox[{RowBox[{RowBox[{"a_", 
                          "?", RowBox[{"(", RowBox[{RowBox[{RowBox[{"Length", 
                          "@", "#"}], ">", "0"}], "&"}], ")"}]}], ":>", "\n", 
                          "\t\t\t\t\t\t", RowBox[{"(", "\n", 
                          "\t\t\t\t\t\t\t", RowBox[{RowBox[{"Message", "[", 
                          RowBox[{RowBox[{"CustomServiceConnection", "::", 
                          "ifkey"}], ",", "name", ",", RowBox[{"Keys", "@", 
                          "a"}]}], "]"}], ";", "\n", "\t\t\t\t\t\t\t", 
                          "$Failed"}], "\n", "\t\t\t\t\t\t\t", ")"}]}], ",", 
                          "\n", "\t\t\t\t\t", RowBox[{"_", ":>", "\n", 
                          "\t\t\t\t\t\t", RowBox[{"(", RowBox[{"name", "->", 
                          RowBox[{"Normal", "@", "function"}]}], ")"}]}]}], 
                          "\n", "\t\t\t\t", "}"}]}], "]"}]}], "\n", "\t\t\t", 
                      "]"}]}], "\n", "\t\t", "]"}]}]}], "CodeInput", 
            CellChangeTimes -> {{3.704845261873344*^9, 
             3.7048454801959953*^9}, {3.704845521077694*^9, 
             3.7048455811878557*^9}, {3.704845811654479*^9, 
             3.704845852546533*^9}, {3.704845935445133*^9, 
             3.704845984684044*^9}, {3.704846124271558*^9, 
             3.704846128002582*^9}, {3.704846182083682*^9, 
             3.704846209081091*^9}, {3.7048462619127607*^9, 
             3.704846342391626*^9}, {3.704846380933712*^9, 
             3.704846436392853*^9}, {3.704846572205844*^9, 
             3.704846582488903*^9}, {3.705290421720601*^9, 
             3.705290422381763*^9}, {3.705290456613323*^9, 
             3.705290518457741*^9}, {3.705315251291315*^9, 
             3.7053152753422956*^9}, {3.705315448268886*^9, 
             3.705315479504841*^9}, {3.705315594902812*^9, 
             3.70531564512586*^9}, {3.705316126571391*^9, 
             3.705316237865855*^9}, {3.7053164633223257*^9, 
             3.705316471346513*^9}, {3.7053173512935667*^9, 
             3.705317364483098*^9}, {3.7053175347846622*^9, 
             3.705317556614064*^9}, {3.705325324121282*^9, 
             3.70532532691078*^9}, {3.705410917513682*^9, 
             3.7054109244383497*^9}}]}, Closed]], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]Prep Functions\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], 
           Cell[BoxData[RowBox[{RowBox[{RowBox[{"CustomServiceConnection", 
                   "::", "pfkey"}], "=", 
                 "\"Process function `` missing keys ``\""}], ";"}]], 
            "CodeInput", CellChangeTimes -> {{3.704846346990922*^9, 
             3.704846377707532*^9}, {3.704846598825748*^9, 
             3.704846602104795*^9}}], Cell[BoxData[
             {RowBox[{RowBox[{RowBox[{"Options", "[", 
                    "customServiceConnectionProcessFunction", "]"}], "=", 
                  RowBox[{"{", "\n", "\t", RowBox[{RowBox[{"\"Call\"", 
                        "\[Rule]", "None"}], ",", "\n", "\t", RowBox[
                       {"\"Method\"", "\[Rule]", "None"}], ",", "\n", "\t", 
                      RowBox[{"\"CleanArguments\"", "\[Rule]", "None"}], ",", 
                      "\n", "\t", RowBox[{"\"Pre\"", "\[Rule]", "None"}], 
                      ",", "\n", "\t", RowBox[{"\"Import\"", "\[Rule]", 
                        "None"}], ",", "\n", "\t", RowBox[{"\"Post\"", 
                        "\[Rule]", "None"}], ",", "\n", "\t", RowBox[
                       {"\"Default\"", "\[Rule]", "None"}], ",", "\n", "\t", 
                      RowBox[{"\"Parameters\"", "\[Rule]", "None"}], ",", 
                      "\n", "\t", RowBox[{"\"Required\"", "\[Rule]", 
                        "None"}]}], "\n", "\t", "}"}]}], ";"}], "\n", 
              RowBox[{RowBox[{RowBox[
                   {"customServiceConnectionProcessFunction", "[", 
                    RowBox[{"name_", ",", RowBox[{"ops", ":", RowBox[
                         {"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
                  "\n", "\t", RowBox[{"With", "[", "\n", "\t\t", RowBox[
                     {RowBox[{"{", "\n", "\t\t\t", RowBox[{RowBox[
                          {"function", "=", "\n", "\t\t\t\t", RowBox[
                          {RowBox[{"DeleteCases", "[", "None", "]"}], "@", 
                          "\n", "\t\t\t\t\t", RowBox[{"Association", "@", 
                          RowBox[{"{", "ops", "}"}]}]}]}], ",", "\n", 
                          "\t\t\t", RowBox[{"required", "=", "\n", 
                          "\t\t\t\t", RowBox[{"{", "}"}]}]}], "\n", "\t\t\t", 
                        "}"}], ",", "\n", "\t\t", RowBox[{"Replace", "[", 
                        "\n", "\t\t\t", RowBox[{RowBox[{RowBox[{"Select", 
                          "[", "MissingQ", "]"}], "@", "\n", "\t\t\t\t", 
                          RowBox[{"Lookup", "[", RowBox[{"function", ",", 
                          RowBox[{"AssociationThread", "[", RowBox[
                          {"required", ",", "required"}], "]"}]}], "]"}]}], 
                          ",", RowBox[{"{", "\n", "\t\t\t\t", RowBox[
                          {RowBox[{RowBox[{"a_", "?", RowBox[{"(", RowBox[
                          {RowBox[{RowBox[{"Length", "@", "#"}], ">", "0"}], 
                          "&"}], ")"}]}], ":>", "\n", "\t\t\t\t\t", RowBox[
                          {"(", "\n", "\t\t\t\t\t\t", RowBox[{RowBox[
                          {"Message", "[", RowBox[{RowBox[{
                          "CustomServiceConnection", "::", "pfkey"}], ",", 
                          "name", ",", RowBox[{"Keys", "@", "a"}]}], "]"}], 
                          ";", "\n", "\t\t\t\t\t\t", "$Failed"}], "\n", 
                          "\t\t\t\t\t\t", ")"}]}], ",", "\n", "\t\t\t\t", 
                          RowBox[{"_", ":>", "\n", "\t\t\t\t\t", RowBox[
                          {"(", RowBox[{"name", "->", "function"}], 
                          ")"}]}]}], "\n", "\t\t\t", "}"}]}], "]"}]}], "\n", 
                    "\t\t", "]"}]}], ";"}], "\n", RowBox[{"\t", 
                RowBox[{RowBox[{"customServiceConnectionProcessFunction", 
                    "[", RowBox[{"name_", ",", "func_"}], "]"}], ":=", "\n", 
                  "\t\t", RowBox[{"customServiceConnectionProcessFunction", 
                    "[", RowBox[{"name", ",", "\n", "\t\t\t", RowBox[
                       {"\"Call\"", "\[Rule]", RowBox[{"\"Raw\"", "<>", 
                          "name"}]}], ",", "\n", "\t\t\t", RowBox[
                       {"\"Import\"", "\[Rule]", "func"}]}], "\n", "\t\t\t", 
                    "]"}]}]}]}], "CodeInput", CellChangeTimes -> 
             {{3.704845261873344*^9, 3.7048454801959953*^9}, 
              {3.704845521077694*^9, 3.7048455811878557*^9}, 
              {3.704845811654479*^9, 3.704845852546533*^9}, 
              {3.704845935445133*^9, 3.704845984684044*^9}, 
              {3.704846124271558*^9, 3.704846128002582*^9}, 
              {3.704846182083682*^9, 3.704846209081091*^9}, 
              {3.7048462619127607*^9, 3.704846342391626*^9}, 
              {3.704846380933712*^9, 3.7048464865200157*^9}, 
              {3.704846521481552*^9, 3.7048466127366257*^9}, 
              3.705022351617989*^9, 3.705148006831519*^9, 
              {3.705155141190957*^9, 3.705155170694578*^9}, 
              {3.705408038969358*^9, 3.7054080593805847*^9}, 
              3.7054081468378067*^9, {3.7054108550907497*^9, 
              3.705410913592656*^9}, {3.705420137815063*^9, 
              3.7054201512804613*^9}, {3.70543336226824*^9, 
              3.705433366040523*^9}, {3.721332079978291*^9, 
              3.721332104678707*^9}, {3.721332264095202*^9, 
              3.721332286709261*^9}}]}, Closed]], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]Template\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], 
           Cell[BoxData[RowBox[{RowBox[{"$customServiceExportContext", "=", 
                 "$Context"}], ";"}]], "CodeInput", CellChangeTimes -> 
             {{3.704853239422886*^9, 3.704853248341065*^9}}], 
           Cell[BoxData[RowBox[{RowBox[{RowBox[
                  {"customServiceTemplateExport", "[", "\n", "\t", 
                   RowBox[{"name_", ",", "\n", "\t", "dir_", ",", "\n", "\t", 
                     "template_", ",", "\n", "\t", "params_"}], "\n", "\t", 
                   "]"}], ":=", "\n", "\t", RowBox[{"Module", "[", "\n", 
                   "\t\t", RowBox[{RowBox[{"{", "\n", "\t\t\t", RowBox[
                        {"tf", ",", "\n", "\t\t\t", "out", ",", "\n", 
                         "\t\t\t", "pars", ",", "\n", "\t\t\t", "body", ",", 
                         "\n", "\t\t\t", "templateBody"}], "\n", "\t\t\t", 
                       "}"}], ",", "\n", "\t\t", RowBox[{RowBox[{"tf", "=", 
                         "\n", "\t\t\t", RowBox[{"PackageFilePath", "[", 
                          "\n", "\t\t\t\t", RowBox[{"\"Resources\"", ",", 
                          "\n", "\t\t\t\t", "\"Templates\"", ",", "\n", 
                          "\t\t\t\t", "\"Frameworks\"", ",", "\n", 
                          "\t\t\t\t", "\"$ServiceConnection\"", ",", "\n", 
                          "\t", "\t\t\t", "\"Kernel\"", ",", "\n", "\t", 
                          "\t\t\t", RowBox[{"template", "<>", "\".m\""}]}], 
                          "\n", "\t\t\t\t", "]"}]}], ";", "\n", "\t\t", 
                       RowBox[{"out", "=", "\n", "\t\t\t", RowBox[
                          {"FileNameJoin", "@", RowBox[{"{", "\n", 
                          "\t\t\t\t", RowBox[{"dir", ",", "\n", "\t\t\t\t", 
                          RowBox[{"\"ServiceConnection_\"", "<>", "name"}], 
                          ",", "\n", "\t\t\t\t", "\"Kernel\"", ",", "\n", 
                          "\t\t\t\t", RowBox[{RowBox[{"StringReplace", "[", 
                          "\n", "\t\t\t\t\t", RowBox[{"template", ",", "\n", 
                          "\t\t\t\t\t", RowBox[{"\"$ServiceConnection\"", 
                          "->", "\n", "\t\t\t\t\t\t", "name"}]}], "\n", 
                          "\t\t\t\t\t", "]"}], "<>", "\".m\""}]}], "\n", 
                          "\t\t\t\t", "}"}]}]}], ";", "\n", "\t\t", RowBox[
                        {"If", "[", RowBox[{RowBox[{"!", RowBox[
                          {"FileExistsQ", "@", "tf"}]}], ",", "\n", "\t\t\t", 
                          RowBox[{"PackageRaiseException", "[", "\n", 
                          "\t\t\t\t", RowBox[{"Automatic", ",", "\n", 
                          "\t\t\t\t", "\"Couldn't locate template file ``\"", 
                          ",", "\n", "\t\t\t\t", "template"}], "\n", 
                          "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}], ";", 
                       "\n", "\t\t", RowBox[{"pars", "=", "\n", "\t\t\t", 
                         RowBox[{"Internal`WithLocalSettings", "[", "\n", 
                          "\t\t\t\t", RowBox[{RowBox[{RowBox[{RowBox[
                          {"cachedSettings", "[", "\"Context\"", "]"}], "=", 
                          "$Context"}], ";", "\n", "\t\t\t\t", RowBox[
                          {RowBox[{"cachedSettings", "[", "\"ContextPath\"", 
                          "]"}], "=", "$ContextPath"}], ";", "\n", 
                          "\t\t\t\t", RowBox[{"$Context", "=", 
                          "$customServiceExportContext"}], ";", "\n", 
                          "\t\t\t\t", RowBox[{"$ContextPath", "=", "\n", 
                          "\t\t\t\t\t", RowBox[{"Join", "[", "\n", 
                          "\t\t\t\t\t\t", RowBox[{RowBox[{"{", RowBox[
                          {"\"System`\"", ",", " ", 
                          "$customServiceExportContext"}], "}"}], ",", "\n", 
                          "\t\t\t\t\t\t", RowBox[{"Select", "[", RowBox[
                          {"$ContextPath", ",", " ", "\n", "\t\t\t\t\t\t\t", 
                          RowBox[{"StringStartsQ", "[", RowBox[{
                          "\"Global`\"", "|", "\"Notebook$$\"", "|", 
                          "\"Cell$$\""}], "]"}]}], "\n", "\t\t\t\t\t\t\t", 
                          "]"}]}], "\n", "\t\t\t\t\t\t", "]"}]}]}], ",", 
                          "\n", "\t\t\t\t", RowBox[{RowBox[{RowBox[{"With", 
                          "[", RowBox[{RowBox[{"{", RowBox[{RowBox[{"obj", 
                          "=", "#2"}], ",", RowBox[{"key", "=", "#"}]}], 
                          "}"}], ",", "\n", "\t", "\t\t\t\t\t", RowBox[{"#", 
                          "->", "\n", "\t", "\t\t\t\t\t\t", RowBox[{"Switch", 
                          "[", RowBox[{"obj", ",", "\n", "\t", 
                          "\t\t\t\t\t\t\t", RowBox[{RowBox[{"Verbatim", "[", 
                          "Verbatim", "]"}], "[", "_String", "]"}], ",", 
                          "\n", "\t", "\t\t\t\t\t\t\t\t", RowBox[{"First", 
                          "@", "obj"}], ",", "\n", "\t", "\t\t\t\t\t\t\t", 
                          "_Function", ",", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                          RowBox[{"\"(\"", "<>", RowBox[{"ToString", "[", 
                          RowBox[{"#2", ",", "InputForm"}], "]"}], "<>", 
                          "\")\""}], ",", "\n", "\t", "\t\t\t\t\t\t\t", "_", 
                          ",", "\n", "\t\t\t\t\t\t\t\t\t", RowBox[{"If", "[", 
                          RowBox[{RowBox[{RowBox[{"(", RowBox[{RowBox[
                          {"ListQ", "@", "obj"}], "||", RowBox[{
                          "AssociationQ", "@", "obj"}]}], ")"}], "&&", RowBox[
                          {RowBox[{"Length", "@", "obj"}], ">", "0"}]}], ",", 
                          "\n", "\t\t\t\t\t\t\t\t\t\t", RowBox[{"Replace", 
                          "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t", RowBox[{RowBox[
                          {"NewlineateCodeRecursive", "[", "\n", 
                          "\t\t\t\t\t\t\t\t\t\t\t\t", RowBox[{"obj", ",", 
                          "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", RowBox[{"_List", 
                          "|", "_Association", "|", "_Rule"}]}], "\n", 
                          "\t\t\t\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                          "\t\t\t\t\t\t\t\t\t\t\t", RowBox[{"{", "\n", 
                          "\t\t\t\t\t\t\t\t\t\t\t\t", RowBox[{RowBox[{RowBox[
                          {"RawBoxes", "[", "r_", "]"}], "\[RuleDelayed]", 
                          "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t", RowBox[
                          {"\"\\n\"", "<>", RowBox[{"BoxesToString", "[", 
                          "r", "]"}]}]}], ",", "\n", 
                          "\t\t\t\t\t\t\t\t\t\t\t\t", RowBox[{"e_", 
                          "\[RuleDelayed]", RowBox[{"(", RowBox[{"ToString", 
                          "[", RowBox[{"obj", ",", "InputForm"}], "]"}], 
                          ")"}]}]}], "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                          "}"}]}], "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", "]"}], 
                          ",", "\n", "\t\t\t\t\t\t\t\t\t\t", RowBox[
                          {"ToString", "[", RowBox[{"obj", ",", 
                          "InputForm"}], "]"}]}], "\n", "\t", 
                          "\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t", 
                          "\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t", 
                          "\t\t\t\t\t", "]"}], "&"}], "@@@", "params"}], ",", 
                          "\n", "\t\t\t\t", RowBox[{RowBox[{"$Context", "=", 
                          RowBox[{"cachedSettings", "[", "\"Context\"", 
                          "]"}]}], ";", "\n", "\t\t\t\t", RowBox[
                          {"$ContextPath", "=", RowBox[{"cachedSettings", 
                          "[", "\"ContextPath\"", "]"}]}], ";", "\n", 
                          "\t\t\t\t", RowBox[{"cachedSettings", "//", 
                          "Clear"}]}]}], "\n", "\t\t\t\t", "]"}]}], ";", 
                       "\n", "\t\t", RowBox[{"Replace", "[", RowBox[{"pars", 
                          ",", "\n", "\t\t\t", RowBox[{RowBox[{"(", RowBox[
                          {"k_", "\[Rule]", RowBox[{"e", ":", RowBox[
                          {"Except", "[", "_String", "]"}]}]}], ")"}], ":>", 
                          "\n", "\t\t\t\t", RowBox[{"PackageRaiseException", 
                          "[", "\n", "\t\t\t\t\t", RowBox[{"Automatic", ",", 
                          "\n", "\t\t\t\t\t", 
                          "\"Failed to convert parameter `` to string\"", 
                          ",", "\n", "\t\t\t\t\t", "k"}], "\n", "\t\t\t\t\t", 
                          "]"}]}], ",", "\n", "\t\t\t", "1"}], "\n", 
                         "\t\t\t", "]"}], ";", "\n", "\t\t", RowBox[
                        {"templateBody", "=", RowBox[{"Import", "[", RowBox[
                          {"tf", ",", " ", "\"Text\""}], "]"}]}], ";", "\n", 
                       "\t\t", RowBox[{"body", "=", RowBox[{"StringReplace", 
                          "[", RowBox[{"templateBody", ",", " ", "pars"}], 
                          "]"}]}], ";", "\n", "\t\t", RowBox[{"If", "[", 
                         RowBox[{RowBox[{"templateBody", "\[Equal]", 
                          "body"}], ",", "\n", "\t\t\t", RowBox[
                          {"PackageRaiseException", "[", "\n", "\t\t\t\t", 
                          RowBox[{"Automatic", ",", "\n", "\t\t\t\t", "\"Fail\
ed to export service connection file `` for connection ``\"", ",", "\n", 
                          "\t\t\t\t", RowBox[{"StringReplace", "[", "\n", 
                          "\t\t\t\t\t", RowBox[{"template", ",", "\n", 
                          "\t\t\t\t\t", RowBox[{"\"$ServiceConnection\"", 
                          "->", "\n", "\t\t\t\t\t\t", "name"}]}], "\n", 
                          "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", 
                          "name"}], "\n", "\t\t\t\t", "]"}]}], "\n", 
                         "\t\t\t", "]"}], ";", "\n", "\t\t", RowBox[
                        {"Export", "[", RowBox[{"out", ",", " ", "body", ",", 
                          " ", "\"Text\""}], "]"}], ";", "\n", "\t\t", 
                       RowBox[{"If", "[", RowBox[{RowBox[{"!", RowBox[
                          {"FileExistsQ", "@", "out"}]}], ",", "\n", 
                          "\t\t\t", RowBox[{"PackageRaiseException", "[", 
                          "\n", "\t\t\t\t", RowBox[{"Automatic", ",", "\n", 
                          "\t\t\t\t", "\"Failed to export service connection \
file `` for connection ``\"", ",", "\n", "\t\t\t\t", RowBox[{"StringReplace", 
                          "[", "\n", "\t\t\t\t\t", RowBox[{"template", ",", 
                          "\n", "\t\t\t\t\t", RowBox[{
                          "\"$ServiceConnection\"", "->", "\n", 
                          "\t\t\t\t\t\t", "name"}]}], "\n", "\t\t\t\t\t", 
                          "]"}], ",", "\n", "\t\t\t\t", "name"}], "\n", 
                          "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}], ";", 
                       "\n", "\t\t", "out"}]}], "\n", "\t\t", "]"}]}], 
               ";"}]], "CodeInput"]}, Closed]], 
        Cell[CellGroupData[{Cell["\[LeftCeiling]Base Functions\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True, CellChangeTimes -> 
             {{3.704846115815501*^9, 3.70484614430995*^9}, 
             {3.704851386613186*^9, 3.704851387059745*^9}}], 
           Cell[BoxData[RowBox[{"$customServiceConnectionBaseFetchFunction", 
               "=", "\n", "\t", RowBox[{"(", "\n", "\t\t\t", RowBox[
                  {RowBox[{"With", "[", " ", RowBox[{RowBox[{"{", RowBox[
                          {"params", " ", "=", " ", RowBox[{"Lookup", "[", 
                          RowBox[{RowBox[{"{", "##2", "}"}], ",", 
                          "\"Parameters\"", ",", RowBox[{"{", "}"}]}], 
                          "]"}]}], "}"}], ",", "\n", "\t", "\t\t\t", 
                       RowBox[{"URLFetch", "[", RowBox[{"#1", ",", "\n", 
                          "\t", "\t\t\t\t", RowBox[{"Sequence", "@@", RowBox[
                          {"FilterRules", "[", RowBox[{RowBox[{"{", "##2", 
                          "}"}], ",", RowBox[{"Except", "[", 
                          "\"Parameters\"", "]"}]}], "]"}]}], ",", "\n", 
                          "\t", "\t\t\t\t\t", RowBox[{"\"Parameters\"", " ", 
                          "->", " ", "\n", "\t\t\t\t\t\t\t", RowBox[
                          {"FilterRules", "[", RowBox[{"params", ",", " ", 
                          "\n", "\t\t\t\t\t\t\t\t\t", RowBox[{"Except", "[", 
                          RowBox[{"{", RowBox[{"\"accountid\"", ",", " ", 
                          "\"authtoken\""}], "}"}], "]"}]}], "\n", 
                          "\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                          "\t\t\t\t\t\t", RowBox[{RowBox[{"\"Username\"", 
                          "->", "\"accountid\""}], "/.", "params"}], ",", 
                          "\n", "\t", "\t\t\t\t\t", RowBox[{RowBox[
                          {"\"Password\"", "->", "\"authtoken\""}], "/.", 
                          "params"}]}], "\n", "\t\t\t\t\t\t", "]"}]}], "\n", 
                     "\t\t\t\t", "]"}], "&"}], "\n", "\t\t\t", ")"}]}]], 
            "CodeInput", CellChangeTimes -> {{3.704848267564267*^9, 
             3.7048483067036247*^9}, {3.704849235785524*^9, 
             3.704849236808332*^9}, {3.704851956598815*^9, 
             3.704851957822432*^9}}]}, Closed]], 
        Cell[CellGroupData[
          {Cell["\[LeftCeiling]customServiceConnectionPrep\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], 
           Cell[BoxData[{RowBox[{RowBox[{RowBox[{"Options", "[", 
                    "customServiceConnectionPrep", "]"}], "=", RowBox[
                   {"{", "\n", "\t", RowBox[{RowBox[{"\"Fetch\"", "->", "\n", 
                        "\t\t", "Automatic"}], ",", "\n", "\t", RowBox[
                       {"\"Client\"", "->", "\n", "\t\t", "Automatic"}], ",", 
                      "\n", "\t", RowBox[{"\"ClientInfo\"", "->", "\n", 
                        "\t\t", "Automatic"}], ",", "\n", "\t", RowBox[
                       {"\"ClientID\"", "\[Rule]", "None"}], ",", "\n", "\t", 
                      RowBox[{"\"ClientSecret\"", "\[Rule]", "None"}], ",", 
                      "\n", "\t", RowBox[{"\"AuthorizationResponseType\"", 
                        "\[Rule]", "None"}], ",", "\n", "\t", RowBox[
                       {"\"RedirectURI\"", "\[Rule]", "None"}], ",", "\n", 
                      "\t", RowBox[{"\"AuthorizationState\"", "\[Rule]", 
                        "None"}], ",", "\n", "\t", RowBox[
                       {"\"AuthorizationScope\"", "\[Rule]", "None"}], ",", 
                      "\n", "\t", RowBox[{"\"LoginURL\"", "->", "\n", "\t\t", 
                        "None"}], ",", "\n", "\t", RowBox[{"\"LogoutURL\"", 
                        "->", "\n", "\t\t", "None"}], ",", "\n", "\t", 
                      RowBox[{"\"UseOAuth\"", "->", "\n", "\t\t", 
                        "Automatic"}], ",", "\n", "\t", RowBox[
                       {"\"AuthorizeEndpoint\"", "\[Rule]", "\n", "\t\t", 
                        "Automatic"}], ",", "\n", "\t", RowBox[
                       {"\"AccessEndpoint\"", "\[Rule]", "\n", "\t\t", 
                        "Automatic"}], ",", "\n", "\t", RowBox[
                       {"\"TokenRequestor\"", "->", "\n", "\t\t", "None"}], 
                      ",", "\n", "\t", RowBox[{"\"TokenExtractor\"", "->", 
                        "\n", "\t\t", "None"}], ",", "\n", "\t", RowBox[
                       {"\"TermsOfServiceURL\"", "->", "\n", "\t\t", 
                        "None"}], ",", "\n", "\t", RowBox[{"\"Information\"", 
                        "->", "\n", "\t\t", "None"}], ",", "\n", "\t", 
                      RowBox[{"\"Thumbnail\"", "->", "\n", "\t\t", "None"}], 
                      ",", "\n", "\t", RowBox[{"\"Functions\"", "->", "\n", 
                        "\t\t", "None"}]}], "\n", "\t", "}"}]}], ";"}], "\n", 
              RowBox[{RowBox[{"customServiceConnectionPrep", "[", "\n", "\t", 
                  RowBox[{"name_", ",", "\n", "\t", "dir_", ",", "\n", "\t", 
                    RowBox[{"functionData", ":", RowBox[{"_List", "?", 
                        "OptionQ"}]}], ",", "\n", "\t", RowBox[
                     {"cookingData", ":", RowBox[{"_List", "?", 
                        "OptionQ"}]}], ",", "\n", "\t", RowBox[{"ops", ":", 
                      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", 
                  "]"}], ":=", "\n", "\t", RowBox[{"With", "[", RowBox[
                   {RowBox[{"{", "\n", "\t\t", RowBox[{RowBox[{"imps", "=", 
                          "\n", "\t\t\t", RowBox[{"Association", "[", RowBox[
                          {"customServiceConnectionImportFunction", "@@@", 
                          "functionData"}], "]"}]}], ",", "\n", "\t\t", 
                        RowBox[{"preps", "=", "\n", "\t\t\t", RowBox[
                          {"Association", "[", RowBox[
                          {"customServiceConnectionProcessFunction", "@@@", 
                          "cookingData"}], "]"}]}]}], "\n", "\t\t", "}"}], 
                    ",", "\n", "\t\t", RowBox[{"With", "[", RowBox[
                       {RowBox[{"{", "\n", "\t\t\t", RowBox[{"params", "=", 
                          "\n", "\t", "\t\t", RowBox[{"Flatten", "@", RowBox[
                          {"{", "\n", "\t\t\t\t", RowBox[{RowBox[
                          {"\"$ServiceConnectionURLFetch\"", "->", "\n", 
                          "\t\t\t\t\t", RowBox[{"OptionValue", "@", 
                          "\"Fetch\""}]}], ",", "\n", "\t\t\t\t", RowBox[
                          {"\"$ServiceConnectionClientInfo\"", "->", "\n", 
                          "\t\t\t\t\t", RowBox[{"OptionValue", "@", 
                          "\"ClientInfo\""}]}], ",", "\n", "\t\t\t\t", RowBox[
                          {"\"$ServiceConnectionClientName\"", "->", "\n", 
                          "\t\t\t\t\t", RowBox[{"StringReplace", "[", "\n", 
                          "\t\t\t\t\t\t", RowBox[{RowBox[{RowBox[{RowBox[
                          {"Replace", "[", "\n", "\t\t\t\t\t\t\t", RowBox[
                          {RowBox[{"HoldPattern", "[", RowBox[{"Capitalize", 
                          "[", "s_String", "]"}], "]"}], "\[RuleDelayed]", 
                          "\n", "\t\t\t\t\t\t\t\t", RowBox[{"(", RowBox[
                          {RowBox[{"ToUpperCase", "@", RowBox[{"StringTake", 
                          "[", RowBox[{"s", ",", "1"}], "]"}]}], "<>", RowBox[
                          {"StringDrop", "[", RowBox[{"s", ",", "1"}], 
                          "]"}]}], ")"}]}], "\n", "\t\t\t\t\t\t\t", "]"}], 
                          "@", RowBox[{"Capitalize", "@", RowBox[{
                          "ToLowerCase", "@", "\n", "\t\t\t\t\t\t\t", RowBox[
                          {"StringTrim", "[", "\n", "\t", "\t\t\t\t\t\t\t", 
                          RowBox[{RowBox[{"Replace", "[", RowBox[{RowBox[
                          {"OptionValue", "@", "\"Client\""}], ",", RowBox[
                          {"{", "\n", "\t", "\t\t\t\t\t\t\t\t", RowBox[
                          {RowBox[{"Automatic", "\[RuleDelayed]", "\n", "\t", 
                          "\t\t\t\t\t\t\t\t\t", RowBox[{"If", "[", "\n", 
                          "\t", "\t\t\t\t\t\t\t\t\t\t", RowBox[{RowBox[{
                          RowBox[{"Replace", "[", RowBox[{RowBox[{
                          "OptionValue", "@", "\"UseOAuth\""}], ",", "\n", 
                          "\t", "\t", "\t\t\t\t\t\t\t\t\t\t", RowBox[{RowBox[
                          {"Except", "[", RowBox[{"True", "|", "False"}], 
                          "]"}], ":>", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                          RowBox[{RowBox[{"!", RowBox[{"MatchQ", "[", RowBox[
                          {RowBox[{"OptionValue", "[", 
                          "\"AuthorizeEndpoint\"", "]"}], ",", RowBox[{
                          "Automatic", "|", "None"}]}], "]"}]}], "&&", "\n", 
                          "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", RowBox[{"!", RowBox[
                          {"MatchQ", "[", RowBox[{RowBox[{"OptionValue", "[", 
                          "\"AccessEndpoint\"", "]"}], ",", RowBox[{
                          "Automatic", "|", "None"}]}], "]"}]}]}]}]}], "\n", 
                          "\t", "\t\t\t\t\t\t\t\t\t\t\t", "]"}], "//", 
                          "TrueQ"}], ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                          "\"OAuth\"", ",", "\n", "\t", 
                          "\t\t\t\t\t\t\t\t\t\t", "\"Key\""}], "\n", "\t", 
                          "\t\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t", 
                          "\t\t\t\t\t\t\t\t", RowBox[{RowBox[{"Except", "[", 
                          "_String", "]"}], "\[Rule]", "\"Key\""}]}], "\n", 
                          "\t", "\t", "\t\t\t\t\t\t\t", "}"}]}], "]"}], ",", 
                          "\n", "\t", "\t", "\t\t\t\t\t\t", "\"client\""}], 
                          "\n", "\t", "\t", "\t\t\t\t\t\t", "]"}]}]}]}], 
                          "<>", "\"Client\""}], ",", "\n", "\t\t\t\t\t\t", 
                          RowBox[{"\"Oauth\"", "\[Rule]", "\"OAuth\""}]}], 
                          "\n", "\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                          "\t\t\t\t", RowBox[{
                          "\"$ServiceConnectionUseOAuth\"", "->", "\n", 
                          "\t\t\t\t\t", RowBox[{"Replace", "[", RowBox[
                          {RowBox[{"OptionValue", "@", "\"UseOAuth\""}], ",", 
                          "\n", "\t\t\t\t\t\t", RowBox[{RowBox[{"Except", 
                          "[", RowBox[{"True", "|", "False"}], "]"}], ":>", 
                          "\n", "\t\t\t\t\t\t\t", RowBox[{RowBox[{RowBox[
                          {"StringQ", "@", RowBox[{"OptionValue", "@", 
                          "\"Client\""}]}], "&&", "\n", "\t\t\t\t\t\t\t\t", 
                          RowBox[{"StringStartsQ", "[", RowBox[{RowBox[
                          {"ToLowerCase", "@", RowBox[{"OptionValue", "@", 
                          "\"Client\""}]}], ",", "\"oauth\""}], "]"}]}], 
                          "||", "\n", "\t\t\t\t\t\t\t", RowBox[{RowBox[{"!", 
                          RowBox[{"MatchQ", "[", RowBox[{RowBox[{
                          "OptionValue", "[", "\"AuthorizeEndpoint\"", "]"}], 
                          ",", RowBox[{"Automatic", "|", "None"}]}], "]"}]}], 
                          "&&", "\n", "\t\t\t\t\t\t\t\t", RowBox[{"!", RowBox[
                          {"MatchQ", "[", RowBox[{RowBox[{"OptionValue", "[", 
                          "\"AccessEndpoint\"", "]"}], ",", RowBox[{
                          "Automatic", "|", "None"}]}], "]"}]}]}]}]}]}], 
                          "\n", "\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                          "\t\t\t\t", RowBox[{
                          "\"$ServiceConnectionAuthEndpoint\"", "->", "\n", 
                          "\t\t\t\t\t", RowBox[{"Replace", "[", RowBox[
                          {RowBox[{"OptionValue", "@", 
                          "\"AuthorizeEndpoint\""}], ",", "\n", 
                          "\t\t\t\t\t\t", RowBox[{"Automatic", ":>", "\n", 
                          "\t\t\t\t\t\t\t", RowBox[{"If", "[", "\n", 
                          "\t\t\t\t\t\t\t\t", RowBox[{RowBox[{"TrueQ", "[", 
                          "\n", "\t\t\t\t\t\t\t\t\t", RowBox[{RowBox[
                          {"TrueQ", "@", RowBox[{"OptionValue", "@", 
                          "\"UseOAuth\""}]}], "||", "\n", "\t", "\t", 
                          "\t\t\t\t\t\t\t\t", RowBox[{RowBox[{"StringQ", "@", 
                          RowBox[{"OptionValue", "@", "\"Client\""}]}], "&&", 
                          "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t", RowBox[
                          {"StringStartsQ", "[", RowBox[{RowBox[{
                          "ToLowerCase", "@", RowBox[{"OptionValue", "@", 
                          "\"Client\""}]}], ",", "\"oauth\""}], "]"}]}]}], 
                          "\n", "\t", "\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                          "\t\t\t\t\t\t\t\t", 
                          "\"https://localhost:8080/oauth2authorize\"", ",", 
                          "\n", "\t\t\t\t\t\t\t\t", "None"}], "\n", 
                          "\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", 
                          "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t", 
                          RowBox[{"\"$ServiceConnectionAccessEndpoint\"", 
                          "->", "\n", "\t\t\t\t\t", RowBox[{"Replace", "[", 
                          RowBox[{RowBox[{"OptionValue", "@", 
                          "\"AccessEndpoint\""}], ",", "\n", "\t\t\t\t\t\t", 
                          RowBox[{"Automatic", ":>", "\n", "\t\t\t\t\t\t\t", 
                          RowBox[{"If", "[", "\n", "\t\t\t\t\t\t\t\t", RowBox[
                          {RowBox[{"TrueQ", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
                          RowBox[{RowBox[{"TrueQ", "@", RowBox[{
                          "OptionValue", "@", "\"UseOAuth\""}]}], "||", "\n", 
                          "\t", "\t", "\t\t\t\t\t\t\t\t", RowBox[{RowBox[
                          {"StringQ", "@", RowBox[{"OptionValue", "@", 
                          "\"Client\""}]}], "&&", "\n", "\t", "\t", 
                          "\t\t\t\t\t\t\t\t\t", RowBox[{"StringStartsQ", "[", 
                          RowBox[{RowBox[{"ToLowerCase", "@", RowBox[{
                          "OptionValue", "@", "\"Client\""}]}], ",", 
                          "\"oauth\""}], "]"}]}]}], "\n", "\t", 
                          "\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                          "\t\t\t\t\t\t\t\t", 
                          "\"https://localhost:8080/oauth2access\"", ",", 
                          "\n", "\t\t\t\t\t\t\t\t", "None"}], "\n", 
                          "\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", 
                          "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t", 
                          RowBox[{
                          "\"$ServiceConnectionAccessTokenRequestor\"", 
                          "\[Rule]", "\n", "\t\t\t\t\t", RowBox[
                          {"OptionValue", "@", "\"TokenRequestor\""}]}], ",", 
                          "\n", "\t\t\t\t", RowBox[{
                          "\"$ServiceConnectionAccessTokenExtractor\"", 
                          "\[Rule]", "\n", "\t\t\t\t\t", RowBox[
                          {"OptionValue", "@", "\"TokenExtractor\""}]}], ",", 
                          "\n", "\t\t\t\t", RowBox[{
                          "\"$ServiceConnectionTermsOfServiceURL\"", "->", 
                          "\n", "\t\t\t\t\t", RowBox[{"OptionValue", "@", 
                          "\"TermsOfServiceURL\""}]}], ",", "\n", "\t\t\t\t", 
                          RowBox[{"\"$ServiceConnectionClientID\"", "->", 
                          "\n", "\t\t\t\t\t", RowBox[{"OptionValue", "@", 
                          "\"ClientID\""}]}], ",", "\n", "\t\t\t\t", RowBox[
                          {"\"$ServiceConnectionClientSecret\"", "->", "\n", 
                          "\t\t\t\t\t", RowBox[{"OptionValue", "@", 
                          "\"ClientSecret\""}]}], ",", "\n", "\t\t\t\t", 
                          RowBox[{"\"$ServiceConnectionAuthResponseType\"", 
                          "->", "\n", "\t\t\t\t\t", RowBox[{"OptionValue", 
                          "@", "\"AuthorizationResponseType\""}]}], ",", 
                          "\n", "\t\t\t\t", RowBox[{
                          "\"$ServiceConnectionState\"", "->", "\n", 
                          "\t\t\t\t\t", RowBox[{"OptionValue", "@", 
                          "\"AuthorizationState\""}]}], ",", "\n", 
                          "\t\t\t\t", RowBox[{
                          "\"$ServiceConnectionAuthScope\"", "->", "\n", 
                          "\t\t\t\t\t", RowBox[{"OptionValue", "@", 
                          "\"AuthorizationScope\""}]}], ",", "\n", 
                          "\t\t\t\t", RowBox[{
                          "\"$ServiceConnectionRedirectURI\"", "->", "\n", 
                          "\t\t\t\t\t", RowBox[{"Replace", "[", RowBox[
                          {RowBox[{"OptionValue", "@", "\"RedirectURI\""}], 
                          ",", "\n", "\t\t\t\t\t\t", RowBox[{"Automatic", 
                          ":>", "\n", "\t\t\t\t\t\t\t", RowBox[{"If", "[", 
                          RowBox[{RowBox[{RowBox[{"OptionValue", "@", 
                          "\"UseOAuth\""}], "||", "\n", "\t\t\t\t\t\t\t\t", 
                          RowBox[{RowBox[{"StringQ", "@", RowBox[{
                          "OptionValue", "@", "\"Client\""}]}], "&&", "\n", 
                          "\t\t\t\t\t\t\t\t\t", RowBox[{"StringStartsQ", "[", 
                          RowBox[{RowBox[{"ToLowerCase", "@", RowBox[{
                          "OptionValue", "@", "\"Client\""}]}], ",", 
                          "\"oauth\""}], "]"}]}]}], ",", "\n", 
                          "\t\t\t\t\t\t\t\t", 
                          "\"https://localhost:7000/oauth2callback\"", ",", 
                          "\n", "\t\t\t\t\t\t\t\t", "None"}], "\n", 
                          "\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", 
                          "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t", 
                          RowBox[{"\"$ServiceConnectionCalls\"", "->", "\n", 
                          "\t", "\t\t\t\t", "imps"}], ",", "\n", "\t", 
                          "\t\t\t", RowBox[{
                          "\"$ServiceConnectionCookingFunctions\"", "->", 
                          "\n", "\t\t\t\t\t", "preps"}], ",", "\n", 
                          "\t\t\t\t\t", RowBox[{RowBox[{RowBox[{"With", "[", 
                          RowBox[{RowBox[{"{", RowBox[{RowBox[{"r", "=", 
                          "#"}], ",", RowBox[{"b", "=", RowBox[{
                          "ToUpperCase", "@", RowBox[{"StringTrim", "[", 
                          RowBox[{"#", ",", "\"s\""}], "]"}]}]}]}], "}"}], 
                          ",", "\n", "\t\t\t\t\t\t", RowBox[{"With", "[", 
                          RowBox[{RowBox[{"{", "\n", "\t\t\t\t\t\t\t", RowBox[
                          {"impSpec", "=", "\n", "\t\t\t\t\t\t\t\t", RowBox[
                          {"Cases", "[", RowBox[{RowBox[{"Normal", "@", 
                          "imps"}], ",", "\n", "\t", "\t", "\t", "\t", 
                          "\t\t\t\t\t", RowBox[{RowBox[{"(", RowBox[{"k_", 
                          "\[Rule]", RowBox[{"{", "\n", "\t", "\t", "\t", 
                          "\t", "\t\t\t\t\t\t", RowBox[{"___", ",", "\n", 
                          "\t", "\t", "\t", "\t", "\t\t\t\t\t\t", RowBox[
                          {"\"HTTPSMethod\"", "\[Rule]", RowBox[{"_", "?", 
                          RowBox[{"(", "\n", "\t\t\t\t\t\t\t\t\t\t\t", RowBox[
                          {RowBox[{RowBox[{"(", RowBox[{RowBox[{
                          "ToUpperCase", "@", "#"}], "/.", RowBox[{"(", 
                          RowBox[{RowBox[{"\"PATCH\"", "|", "\"PUT\"", "|", 
                          "\"DELETE\""}], "\[Rule]", "\"POST\""}], ")"}]}], 
                          ")"}], "===", "b"}], "&"}], ")"}]}]}], ",", "\n", 
                          "\t", "\t", "\t", "\t", "\t\t\t\t\t\t", "___"}], 
                          "\n", "\t", "\t", "\t", "\t", "\t\t\t\t\t\t", 
                          "}"}]}], ")"}], "\[RuleDelayed]", "k"}]}], "\n", 
                          "\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                          "\t\t\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t\t", 
                          RowBox[{"Sequence", "@@", "\n", "\t\t\t\t\t\t\t", 
                          RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", RowBox[
                          {RowBox[{RowBox[{"\"$ServiceConnectionRaw\"", "<>", 
                          "r"}], "->", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                          "impSpec"}], ",", "\n", "\t", "\t\t\t\t\t\t\t", 
                          RowBox[{RowBox[{"\"$ServiceConnection\"", "<>", 
                          "r"}], "->", "\n", "\t\t\t\t\t\t\t\t\t", RowBox[
                          {"Join", "[", "\n", "\t\t\t\t\t\t\t\t\t\t", RowBox[
                          {RowBox[{"Keys", "@", "\n", 
                          "\t\t\t\t\t\t\t\t\t\t\t", RowBox[{"Select", "[", 
                          RowBox[{"preps", ",", "\n", 
                          "\t\t\t\t\t\t\t\t\t\t\t\t", RowBox[{RowBox[{"If", 
                          "[", RowBox[{RowBox[{"KeyMemberQ", "[", RowBox[{
                          "#", ",", "\"Method\""}], "]"}], ",", "\n", 
                          "\t\t\t\t\t\t\t\t\t\t\t\t\t", RowBox[{RowBox[{
                          "ReplaceAll", "[", "\n", 
                          "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", RowBox[{RowBox[{
                          "ToUpperCase", "@", RowBox[{"#", "[", "\"Method\"", 
                          "]"}]}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                          RowBox[{RowBox[{"\"PATCH\"", "|", "\"PUT\"", "|", 
                          "\"DELETE\""}], "\[Rule]", "\"POST\""}]}], "\n", 
                          "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}], "===", 
                          RowBox[{"ToUpperCase", "@", RowBox[{"StringTrim", 
                          "[", RowBox[{"r", ",", "\"s\""}], "]"}]}]}], ",", 
                          "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", RowBox[{
                          "MemberQ", "[", RowBox[{"impSpec", ",", RowBox[{
                          "#", "[", "\"Call\"", "]"}]}], "]"}]}], "\n", 
                          "\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}], "&"}]}], "\n", 
                          "\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                          "\t\t\t\t\t\t\t\t\t\t", RowBox[{"If", "[", RowBox[
                          {RowBox[{"r", "===", "\"Gets\""}], ",", "\n", 
                          "\t\t\t\t\t\t\t\t\t\t\t", RowBox[{"Keys", "@", 
                          "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", RowBox[{"Select", 
                          "[", RowBox[{"preps", ",", "\n", 
                          "\t\t\t\t\t\t\t\t\t\t\t\t\t", RowBox[{RowBox[{
                          "AllTrue", "[", "\n", 
                          "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", RowBox[{RowBox[{
                          "Lookup", "[", RowBox[{"#", ",", RowBox[{"{", 
                          RowBox[{"\"Call\"", ",", "\"Method\""}], "}"}]}], 
                          "]"}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                          "MissingQ"}], "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                          "]"}], "&"}]}], "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                          "]"}]}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                          RowBox[{"{", "}"}]}], "\n", 
                          "\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                          "\t\t\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", 
                          "\t\t\t\t\t\t\t\t", "}"}]}]}], "\n", 
                          "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "]"}], 
                          "&"}], "/@", RowBox[{"{", RowBox[{"\"Gets\"", ",", 
                          "\"Posts\""}], "}"}]}], ",", "\n", "\t\t\t\t", 
                          RowBox[{"\"$ServiceConnectionInformation\"", "->", 
                          "\n", "\t\t\t\t\t", RowBox[{"OptionValue", "@", 
                          "\"Information\""}]}], ",", "\n", "\t\t\t\t", 
                          RowBox[{"\"$ServiceConnectionIcon\"", "->", "\n", 
                          "\t\t\t\t\t", RowBox[{"OptionValue", "@", 
                          "\"Thumbnail\""}]}], ",", "\n", "\t\t\t\t", RowBox[
                          {"\"$ServiceConnectionHelperNames\"", "->", "\n", 
                          "\t\t\t\t\t", RowBox[{"Verbatim", "@", "\n", 
                          "\t\t\t\t\t\t", RowBox[{"StringRiffle", "[", "\n", 
                          "\t\t\t\t\t\t\t", RowBox[{RowBox[{"Replace", "[", 
                          "\n", "\t", "\t\t\t\t\t\t\t", RowBox[{RowBox[
                          {"Flatten", "@", RowBox[{RowBox[{"DeleteCases", 
                          "[", "None", "]"}], "@", RowBox[{"{", RowBox[
                          {"OptionValue", "@", "\"Functions\""}], "}"}]}]}], 
                          ",", RowBox[{"{", "\n", "\t", "\t", "\t\t\t\t\t\t", 
                          RowBox[{RowBox[{RowBox[{"(", RowBox[{"k_", 
                          "\[Rule]", "f_"}], ")"}], ":>", "\n", "\t", 
                          "\t\t\t\t\t\t\t\t", RowBox[{"ToString", "[", "k", 
                          "]"}]}], ",", "\n", "\t", "\t\t\t\t\t\t\t", RowBox[
                          {"e_", ":>", "\n", "\t", "\t\t\t\t\t\t\t\t", RowBox[
                          {"ToString", "@", "e"}]}]}], "\n", "\t", 
                          "\t\t\t\t\t\t\t", "}"}], ",", "\n", "\t", 
                          "\t\t\t\t\t\t\t", "1"}], "]"}], ",", "\n", "\t", 
                          "\t\t\t\t\t\t", "\"\\n\\n\""}], "\n", "\t", 
                          "\t\t\t\t\t\t", "]"}]}]}], ",", "\n", "\t\t\t\t", 
                          RowBox[{"\"$ServiceConnectionHelperFunctions\"", 
                          "->", "\n", "\t\t\t\t\t", RowBox[{"Block", "[", 
                          RowBox[{RowBox[{"{", RowBox[{"$ContextPath", "=", 
                          RowBox[{"{", RowBox[{"\"System`\"", ",", 
                          "$Context"}], "}"}]}], "}"}], ",", "\n", 
                          "\t\t\t\t\t\t", RowBox[{"Verbatim", "@", "\n", 
                          "\t\t\t\t\t\t\t", RowBox[{"StringRiffle", "[", 
                          "\n", "\t", "\t\t\t\t\t\t\t", RowBox[{RowBox[
                          {"Replace", "[", "\n", "\t", "\t", 
                          "\t\t\t\t\t\t\t", RowBox[{RowBox[{"Flatten", "@", 
                          RowBox[{RowBox[{"DeleteCases", "[", "None", "]"}], 
                          "@", RowBox[{"{", RowBox[{"OptionValue", "@", 
                          "\"Functions\""}], "}"}]}]}], ",", RowBox[{"{", 
                          "\n", "\t", "\t", "\t", "\t\t\t\t\t\t", RowBox[
                          {RowBox[{RowBox[{"(", RowBox[{"k_", "\[Rule]", 
                          "f_"}], ")"}], ":>", "\n", "\t", "\t", "\t", 
                          "\t\t\t\t\t\t\t", RowBox[{"(", RowBox[{RowBox[
                          {"ToString", "[", "k", "]"}], "<>", "\" = \"", 
                          "<>", RowBox[{"ToString", "[", RowBox[{"f", ",", 
                          "InputForm"}], "]"}]}], ")"}]}], ",", "\n", "\t", 
                          "\t", "\t\t\t\t\t\t\t", RowBox[{"e_", ":>", "\n", 
                          "\t", "\t\t\t\t\t\t\t\t\t", RowBox[{"ToString", 
                          "[", RowBox[{RowBox[{"Definition", "@", "e"}], ",", 
                          "InputForm"}], "]"}]}]}], "\n", 
                          "\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", 
                          "\t\t\t\t\t\t\t\t\t", "1"}], "]"}], ",", "\n", 
                          "\t", "\t", "\t\t\t\t\t\t", "\"\\n\\n\""}], "\n", 
                          "\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", 
                          "\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t", 
                          RowBox[{"\"$ServiceConnection\"", "\[Rule]", "\n", 
                          "\t\t\t\t\t", RowBox[{"Verbatim", "@", "name"}]}], 
                          ",", "\n", "\t\t\t\t", RowBox[{
                          "\"$serviceconnection\"", "->", "\n", "\t\t\t\t\t", 
                          RowBox[{"Verbatim", "@", RowBox[{"ToLowerCase", 
                          "@", "name"}]}]}]}], "\n", "\t\t\t\t", "}"}]}]}], 
                          "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", RowBox[
                         {RowBox[{RowBox[{"customServiceTemplateExport", "[", 
                          "\n", "\t\t\t", RowBox[{"name", ",", "\n", 
                          "\t\t\t", "dir", ",", "\n", "\t\t\t", "#", ",", 
                          "\n", "\t\t\t", "params"}], "\n", "\t\t\t", "]"}], 
                          "&"}], "/@", RowBox[{"{", "\n", "\t\t\t\t", RowBox[
                          {"\"load\"", ",", "\n", "\t\t\t\t", 
                          "\"$ServiceConnection\"", ",", "\n", "\t\t\t\t", 
                          "\"$ServiceConnectionFunctions\"", ",", "\n", 
                          "\t\t\t\t", "\"$ServiceConnectionLoad\""}], "\n", 
                          "\t\t\t\t", "}"}]}]}], "\n", "\t\t\t", "]"}]}], 
                  "\n", "\t\t", "]"}]}]}], "CodeInput"]}, Open]], 
        Cell[CellGroupData[
          {Cell["\[LeftCeiling]customServiceBitmapsExport\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], 
           Cell[BoxData[RowBox[{RowBox[{"customServiceBitmapsExport", "[", 
                 RowBox[{"dir_", ",", " ", "name_", ",", " ", "things_"}], 
                 "]"}], ":=", "\n", "\t", RowBox[{"Module", "[", "\n", 
                 "\t\t", RowBox[{RowBox[{"{", "\n", "\t\t\t", "bmdir", "\n", 
                     "\t\t\t", "}"}], ",", "\n", "\t\t", RowBox[
                    {RowBox[{"bmdir", "=", "\n", "\t\t\t", RowBox[
                        {"FileNameJoin", "@", RowBox[{"{", "\n", 
                          "\t\t\t\t\t", RowBox[{"dir", ",", "\n", 
                          "\t\t\t\t\t", RowBox[{"\"ServiceConnection_\"", 
                          "<>", "name"}], ",", "\n", "\t\t\t\t\t", 
                          "\"FrontEnd\"", ",", "\n", "\t\t\t\t\t", 
                          "\"SystemResources\"", ",", "\n", "\t\t\t\t\t", 
                          "\"Bitmaps\""}], "\n", "\t\t\t\t", "}"}]}]}], ";", 
                     "\n", "\t\t", RowBox[{"Quiet", "@", RowBox[
                        {"CreateDirectory", "[", RowBox[{"bmdir", ",", " ", 
                          RowBox[{"CreateIntermediateDirectories", "\[Rule]", 
                          "True"}]}], "]"}]}], ";", "\n", "\t\t", RowBox[
                      {"If", "[", RowBox[{RowBox[{"MatchQ", "[", RowBox[
                          {RowBox[{"First", "@", "things"}], ",", RowBox[
                          {RowBox[{"(", RowBox[{"_File", "|", "_String"}], 
                          ")"}], "?", "FileExistsQ"}]}], "]"}], ",", "\n", 
                         "\t\t\t", RowBox[{"CopyFile", "[", "\n", "\t\t\t\t", 
                          RowBox[{RowBox[{"First", "@", "things"}], ",", 
                          "\n", "\t\t\t\t", RowBox[{"FileNameJoin", "@", 
                          RowBox[{"{", "\n", "\t\t\t\t\t", RowBox[{"bmdir", 
                          ",", "\n", "\t\t\t\t\t", RowBox[{RowBox[
                          {"ToLowerCase", "@", "name"}], "<>", 
                          "\".png\""}]}], "\n", "\t\t\t\t\t", "}"}]}]}], 
                          "\n", "\t\t\t\t", "]"}], ",", "\n", "\t\t\t", 
                         RowBox[{"Export", "[", "\n", "\t\t\t\t", RowBox[
                          {RowBox[{"FileNameJoin", "@", RowBox[{"{", "\n", 
                          "\t\t\t\t\t", RowBox[{"bmdir", ",", "\n", 
                          "\t\t\t\t\t", RowBox[{RowBox[{"ToLowerCase", "@", 
                          "name"}], "<>", "\".png\""}]}], "\n", "\t\t\t\t\t", 
                          "}"}]}], ",", "\n", "\t\t\t\t", RowBox[{"First", 
                          "@", "things"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", 
                       "\t\t\t", "]"}], ";", "\n", "\t\t", RowBox[{"If", "[", 
                       RowBox[{RowBox[{"MatchQ", "[", RowBox[{RowBox[{"Last", 
                          "@", "things"}], ",", RowBox[{RowBox[{"(", RowBox[
                          {"_File", "|", "_String"}], ")"}], "?", 
                          "FileExistsQ"}]}], "]"}], ",", "\n", "\t\t\t", 
                         RowBox[{"CopyFile", "[", "\n", "\t\t\t\t", RowBox[
                          {RowBox[{"Last", "@", "things"}], ",", "\n", 
                          "\t\t\t\t", RowBox[{"FileNameJoin", "@", RowBox[
                          {"{", "\n", "\t\t\t\t\t", RowBox[{"bmdir", ",", 
                          "\n", "\t\t\t\t\t", RowBox[{RowBox[{"ToLowerCase", 
                          "@", "name"}], "<>", "\"@2.png\""}]}], "\n", 
                          "\t\t\t\t\t", "}"}]}]}], "\n", "\t\t\t\t", "]"}], 
                         ",", "\n", "\t\t\t", RowBox[{"Export", "[", "\n", 
                          "\t\t\t\t", RowBox[{RowBox[{"FileNameJoin", "@", 
                          RowBox[{"{", "\n", "\t\t\t\t\t", RowBox[{"bmdir", 
                          ",", "\n", "\t\t\t\t\t", RowBox[{RowBox[
                          {"ToLowerCase", "@", "name"}], "<>", 
                          "\"@2.png\""}]}], "\n", "\t\t\t\t\t", "}"}]}], ",", 
                          "\n", "\t\t\t\t", RowBox[{"Last", "@", 
                          "things"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", 
                       "\t\t\t", "]"}]}]}], "\n", "\t\t", "]"}]}]], 
            "CodeInput"]}, Closed]], Cell[CellGroupData[
          {Cell["\[LeftCeiling]customServicePacletExport\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], 
           Cell[BoxData[RowBox[{RowBox[{"customServicePacletExport", "[", 
                 RowBox[{"dir_", ",", " ", "name_", ",", " ", RowBox[
                    {"ops", ":", RowBox[{"OptionsPattern", "[", "]"}]}]}], 
                 "]"}], ":=", "\n", "\t", RowBox[{"Module", "[", "\n", 
                 "\t\t", RowBox[{RowBox[{"{", "\n", "\t\t\t", "bundle", "\n", 
                     "\t\t\t", "}"}], ",", "\n", "\t\t", RowBox[
                    {RowBox[{"bundle", "=", "\n", "\t\t\t", RowBox[
                        {"PacletInfoExpressionBundle", "[", "\n", "\t\t\t\t", 
                         RowBox[{RowBox[{"FileNameJoin", "@", RowBox[{"{", 
                          RowBox[{"dir", ",", RowBox[{
                          "\"ServiceConnection_\"", "<>", "name"}]}], 
                          "}"}]}], ",", "\n", "\t\t\t\t", RowBox[
                          {"FilterRules", "[", "\n", "\t\t\t\t\t", RowBox[
                          {RowBox[{"Flatten", "@", RowBox[{"{", "\n", 
                          "\t\t\t\t\t\t", RowBox[{RowBox[{"FilterRules", "[", 
                          RowBox[{RowBox[{"{", "ops", "}"}], ",", " ", RowBox[
                          {"Except", "[", "\"Thumbnail\"", "]"}]}], "]"}], 
                          ",", "\n", "\t\t\t\t\t\t", RowBox[{"\"Thumbnail\"", 
                          "->", "\n", "\t\t\t\t\t\t\t", RowBox[{
                          "FileNameJoin", "@", RowBox[{"{", "\n", "\t", "\t", 
                          "\t", "\t\t\t\t\t\t", RowBox[{"\"FrontEnd\"", ",", 
                          "\n", "\t", "\t", "\t", "\t\t\t\t\t\t", 
                          "\"SystemResources\"", ",", "\n", "\t", "\t", "\t", 
                          "\t\t\t\t\t\t", "\"Bitmaps\"", ",", "\n", "\t", 
                          "\t", "\t", "\t\t\t\t\t\t", RowBox[{RowBox[
                          {"ToLowerCase", "@", "name"}], "<>", 
                          "\"@2.png\""}]}], "\n", "\t", "\t", "\t", 
                          "\t\t\t\t\t\t", "}"}]}]}]}], "\n", "\t", "\t", 
                          "\t", "\t\t\t\t", "}"}]}], ",", "\n", "\t", "\t", 
                          "\t", "\t\t\t", RowBox[{"Options", "@", 
                          "PacletInfoExpressionBundle"}]}], "\n", "\t", "\t", 
                          "\t", "\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", 
                         "]"}]}], ";", "\n", "\t\t\t", RowBox[{"If", "[", 
                       RowBox[{RowBox[{"!", RowBox[
                          {"PacletManager`VerifyPaclet", "@", "bundle"}]}], 
                         ",", "\n", "\t\t\t\t", RowBox[
                          {"PackageRaiseException", "[", "\n", "\t\t\t\t\t", 
                          RowBox[{"Automatic", ",", "\n", "\t\t\t\t\t", 
                          "\"Couldn't make PacletInfo.m for connection ``\"", 
                          ",", "\n", "\t\t\t\t\t", "name"}], "\n", 
                          "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}], 
                     ";", "\n", "\t\t\t", RowBox[{"PacletBundle", "@", 
                       RowBox[{"FileNameJoin", "@", RowBox[{"{", RowBox[
                          {"dir", ",", " ", RowBox[{"\"ServiceConnection_\"", 
                          "<>", "name"}]}], "}"}]}]}]}]}], "\n", "\t\t\t", 
                 "]"}]}]], "CodeInput"]}, Open]], 
        Cell[CellGroupData[
          {Cell["\[LeftCeiling]customServicePostProcess\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True], 
           Cell[BoxData[RowBox[{RowBox[{"customServicePostProcess", "[", 
                 "\n", "\t", RowBox[{"dir_", ",", " ", "name_", ",", " ", 
                   "\n", "\t", "iconList_", ",", "\n", "\t", "pack_", ",", 
                   "\n", "\t", RowBox[{"ops", ":", RowBox[{"OptionsPattern", 
                       "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", "\t", 
               RowBox[{"Module", "[", "\n", "\t\t", RowBox[
                  {RowBox[{"{", "\n", "\t\t\t", "icons", "\n", "\t\t\t", 
                     "}"}], ",", "\n", "\t\t", RowBox[{RowBox[{"icons", "=", 
                       "\n", "\t\t\t", RowBox[{"Replace", "[", RowBox[
                          {"iconList", ",", "\n", "\t\t\t\t", RowBox[{"{", 
                          "\n", "\t\t\t\t\t", RowBox[{RowBox[{"g_Graphics", 
                          ":>", "\n", "\t\t\t\t\t\t", RowBox[{"{", "\n", 
                          "\t\t\t\t\t\t\t", RowBox[{RowBox[{"Insert", "[", 
                          RowBox[{"g", ",", "\n", "\t\t\t\t\t\t\t\t", RowBox[
                          {"ImageSize", "\[Rule]", "24"}], ",", "\n", 
                          "\t\t\t\t\t\t\t\t", "2"}], "\n", 
                          "\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                          "\t\t\t\t\t\t\t", RowBox[{"Insert", "[", RowBox[
                          {"g", ",", "\n", "\t\t\t\t\t\t\t\t", RowBox[
                          {"ImageSize", "\[Rule]", "48"}], ",", "\n", 
                          "\t\t\t\t\t\t\t\t", "2"}], "\n", 
                          "\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                          "\t\t\t\t\t\t\t", "}"}]}], ",", "\n", "\t\t\t\t\t", 
                          RowBox[{RowBox[{"i_", "?", "ImageQ"}], ":>", "\n", 
                          "\t\t\t\t\t\t", RowBox[{"{", "\n", 
                          "\t\t\t\t\t\t\t", RowBox[{RowBox[{"ImageResize", 
                          "[", RowBox[{"i", ",", RowBox[{"{", "24", "}"}]}], 
                          "]"}], ",", "\n", "\t\t\t\t\t\t\t", RowBox[
                          {"ImageResize", "[", RowBox[{"i", ",", RowBox[{"{", 
                          "48", "}"}]}], "]"}]}], "\n", "\t\t\t\t\t\t\t", 
                          "}"}]}], ",", "\n", "\t\t\t\t\t", RowBox[{RowBox[
                          {"e", ":", RowBox[{"Except", "[", RowBox[{"None", 
                          "|", RowBox[{"{", RowBox[{"_", ",", "_"}], "}"}]}], 
                          "]"}]}], ":>", "\n", "\t\t\t\t\t\t", RowBox[{"{", 
                          "\n", "\t\t\t\t\t\t\t", RowBox[{RowBox[
                          {"Rasterize", "[", RowBox[{"e", ",", "\"Image\"", 
                          ",", "\n", "\t\t\t\t\t\t\t\t", RowBox[{
                          "RasterSize", "\[Rule]", RowBox[{"{", RowBox[{"24", 
                          ",", "24"}], "}"}]}]}], "]"}], ",", "\n", 
                          "\t\t\t\t\t\t\t", RowBox[{"Rasterize", "[", RowBox[
                          {"e", ",", "\"Image\"", ",", "\n", 
                          "\t\t\t\t\t\t\t\t", RowBox[{"RasterSize", 
                          "\[Rule]", RowBox[{"{", RowBox[{"48", ",", "48"}], 
                          "}"}]}]}], "]"}]}], "\n", "\t\t\t\t\t\t\t", 
                          "}"}]}]}], "\n", "\t\t\t\t\t", "}"}]}], "\n", 
                         "\t\t\t\t", "]"}]}], ";", "\n", "\t\t", RowBox[
                      {"If", "[", RowBox[{RowBox[{RowBox[{"ListQ", "@", 
                          "icons"}], "&&", RowBox[{RowBox[{"Length", "@", 
                          "icons"}], "\[Equal]", "2"}]}], ",", "\n", 
                         "\t\t\t", RowBox[{"customServiceBitmapsExport", "[", 
                          RowBox[{"dir", ",", " ", "name", ",", " ", 
                          "icons"}], "]"}]}], "\n", "\t\t\t", "]"}], ";", 
                     "\n", "\t\t", RowBox[{"If", "[", RowBox[{"pack", ",", 
                         "\n", "\t\t\t", RowBox[{"customServicePacletExport", 
                          "[", RowBox[{"dir", ",", " ", "name", ",", " ", 
                          "ops"}], "]"}], ",", "\n", "\t\t\t", RowBox[
                          {"FileNameJoin", "@", RowBox[{"{", RowBox[{"dir", 
                          ",", RowBox[{"\"ServiceConnection_\"", "<>", 
                          "name"}]}], "}"}]}]}], "\n", "\t\t\t", "]"}]}]}], 
                 "\n", "\t\t", "]"}]}]], "CodeInput"]}, Closed]], 
        Cell[CellGroupData[
          {Cell["\[LeftCeiling]CustomServiceConnection\[RightFloor]", 
            "CodeSubsubsection", Evaluatable -> True, CellChangeTimes -> 
             {3.704851321451747*^9}], Cell[BoxData[RowBox[
              {"CustomServiceConnection", "//", "Clear"}]], "CodeInput"], 
           Cell[BoxData[RowBox[{RowBox[{RowBox[{"Options", "[", 
                   "CustomServiceConnection", "]"}], "=", "\n", "\t", 
                 RowBox[{"Join", "[", "\n", "\t\t", RowBox[{RowBox[{"{", 
                       "\n", "\t\t\t", RowBox[{RowBox[{"\"ImportFunctions\"", 
                          "\[Rule]", RowBox[{"{", "}"}]}], ",", "\n", "\t", 
                         "\t", "\t", RowBox[{"\"ProcessFunctions\"", 
                          "\[Rule]", RowBox[{"{", "}"}]}], ",", "\n", 
                         "\t\t\t", RowBox[{"\"Thumbnail\"", "\[Rule]", 
                          "None"}]}], "\n", "\t\t\t", "}"}], ",", "\n", 
                     "\t\t", RowBox[{"Options", "@", 
                       "customServiceConnectionPrep"}], ",", "\n", "\t\t", 
                     RowBox[{"Options", "@", 
                       "PacletInfoExpressionBundle"}]}], "\n", "\t\t", 
                   "]"}]}], ";"}]], "CodeInput"], 
           Cell[CellGroupData[
             {Cell["\[LeftCeiling]iCustomServiceConnection\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True], Cell[BoxData[
                {RowBox[{RowBox[{RowBox[{"Options", "[", 
                       "iCustomServiceConnection", "]"}], "=", "\n", "\t", 
                     RowBox[{"Options", "[", "CustomServiceConnection", 
                       "]"}]}], ";"}], "\n", RowBox[{RowBox[
                    {"iCustomServiceConnection", "[", "\n", "\t", RowBox[
                      {RowBox[{"name_String", "?", RowBox[{"(", RowBox[
                          {"StringMatchQ", "[", RowBox[{"WordCharacter", 
                          ".."}], "]"}], ")"}]}], ",", "\n", "\t", RowBox[
                        {"directory", ":", RowBox[{RowBox[{"_String", "?", 
                          "DirectoryQ"}], "|", "Automatic"}], ":", 
                         "Automatic"}], ",", "\n", "\t", RowBox[{"pack", ":", 
                         RowBox[{"True", "|", "False"}], ":", "True"}], ",", 
                       "\n", "\t", RowBox[{"ops", ":", RowBox[
                          {"OptionsPattern", "[", "]"}]}]}], "\n", "\t", 
                     "]"}], ":=", "\n", "\t", RowBox[{"Module", "[", "\n", 
                     "\t\t", RowBox[{RowBox[{"{", "\n", "\t\t\t", RowBox[
                          {"dir", ",", "\n", "\t\t\t", "res", ",", "\n", 
                          "\t\t\t", "out"}], "\n", "\t\t\t", "}"}], ",", 
                       "\n", "\t\t", RowBox[{RowBox[{"dir", "=", RowBox[
                          {"Replace", "[", RowBox[{"directory", ",", " ", 
                          RowBox[{"Automatic", "\[RuleDelayed]", 
                          "$TemporaryDirectory"}]}], "]"}]}], ";", "\n", 
                         "\t\t", RowBox[{"Quiet", "@", "\n", "\t\t\t", 
                          RowBox[{"CreateDirectory", "[", "\n", "\t\t\t\t", 
                          RowBox[{RowBox[{"FileNameJoin", "@", "\n", "\t", 
                          "\t\t\t\t", RowBox[{"{", "\n", "\t", "\t\t\t\t\t", 
                          RowBox[{"dir", ",", "\n", "\t", "\t\t\t\t\t", 
                          RowBox[{"\"ServiceConnection_\"", "<>", "name"}], 
                          ",", "\n", "\t", "\t", "\t\t\t\t", "\"Kernel\""}], 
                          "\n", "\t\t\t\t\t\t", "}"}]}], ",", "\n", 
                          "\t\t\t\t", RowBox[{
                          "CreateIntermediateDirectories", "\[Rule]", 
                          "True"}]}], "\n", "\t\t\t\t", "]"}]}], ";", "\n", 
                         "\t\t", RowBox[{"res", "=", "\n", "\t\t\t", RowBox[
                          {"customServiceConnectionPrep", "[", "\n", 
                          "\t\t\t\t", RowBox[{"name", ",", "\n", "\t", 
                          "\t\t\t", "dir", ",", "\n", "\t", "\t\t\t", RowBox[
                          {"OptionValue", "@", "\"ImportFunctions\""}], ",", 
                          "\n", "\t", "\t\t\t", RowBox[{"OptionValue", "@", 
                          "\"ProcessFunctions\""}], ",", "\n", "\t", 
                          "\t\t\t", RowBox[{"FilterRules", "[", "\n", 
                          "\t\t\t\t\t", RowBox[{RowBox[{"{", "\n", 
                          "\t\t\t\t\t\t", RowBox[{RowBox[{"\"Thumbnail\"", 
                          "\[Rule]", "\n", "\t\t\t\t\t\t\t", RowBox[
                          {"Replace", "[", RowBox[{RowBox[{"OptionValue", 
                          "@", "\"Thumbnail\""}], ",", "\n", 
                          "\t\t\t\t\t\t\t\t", RowBox[{"{", "\n", "\t", 
                          "\t\t\t\t\t\t\t\t", RowBox[{RowBox[{RowBox[
                          {"Graphics", "[", RowBox[{"e_", ",", "o___"}], 
                          "]"}], ":>", "\n", "\t", "\t", "\t\t\t\t\t\t\t\t", 
                          RowBox[{"Graphics", "[", RowBox[{"e", ",", RowBox[
                          {"ImageSize", "\[Rule]", "24"}], ",", "o"}], 
                          "]"}]}], ",", "\n", "\t", "\t", "\t\t\t\t\t\t\t", 
                          RowBox[{RowBox[{"Except", "[", RowBox[{"None", "|", 
                          "_Graphics", "|", RowBox[{"_", "?", "ImageQ"}]}], 
                          "]"}], "\[Rule]", "Automatic"}]}], "\n", "\t", 
                          "\t\t\t\t\t\t\t\t", "}"}]}], "\n", "\t", 
                          "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t", 
                          "\t\t\t\t\t\t", "ops"}], "\n", "\t", "\t\t\t\t\t", 
                          "}"}], ",", "\n", "\t", "\t\t\t\t", RowBox[
                          {"Options", "@", "customServiceConnectionPrep"}]}], 
                          "\n", "\t", "\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", 
                          "]"}]}], ";", "\n", "\t\t", RowBox[{"If", "[", 
                          RowBox[{RowBox[{"!", RowBox[{"(", RowBox[{RowBox[
                          {"ListQ", "@", "res"}], "&&", RowBox[{"AllTrue", 
                          "[", RowBox[{"res", ",", " ", RowBox[{RowBox[
                          {RowBox[{"StringQ", "@", "#"}], "&&", RowBox[
                          {"FileExistsQ", "@", "#"}]}], "&"}]}], "]"}]}], 
                          ")"}]}], ",", "\n", "\t\t\t", RowBox[
                          {"PackageRaiseException", "[", "\n", "\t\t\t\t", 
                          RowBox[{"Automatic", ",", "\n", "\t\t\t\t", 
                          "\"Generated service connection files `` invalid\""\
, ",", "\n", "\t\t\t\t", "res"}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", 
                          "]"}], ";", "\n", "\t\t", RowBox[{"out", "=", "\n", 
                          "\t\t\t", RowBox[{"customServicePostProcess", "[", 
                          "\n", "\t", "\t\t\t", RowBox[{"dir", ",", "\n", 
                          "\t", "\t\t\t", "name", ",", "\n", "\t", "\t\t\t", 
                          RowBox[{"OptionValue", "[", "\"Thumbnail\"", "]"}], 
                          ",", "\n", "\t\t\t\t", "pack", ",", "\n", 
                          "\t\t\t\t", "ops"}], "\n", "\t\t\t\t", "]"}]}], 
                         ";", "\n", "\t\t", RowBox[{"If", "[", RowBox[
                          {RowBox[{"!", RowBox[{"FileExistsQ", "@", 
                          "out"}]}], ",", "\n", "\t\t\t", RowBox[
                          {"PackageRaiseException", "[", "\n", "\t\t\t\t", 
                          RowBox[{"Automatic", ",", "\n", "\t\t\t\t", 
                          "\"Generated service connection `` invalid\"", ",", 
                          "\n", "\t\t\t\t", "out"}], "\n", "\t\t\t\t", 
                          "]"}]}], "\n", "\t\t\t", "]"}], ";", "\n", "\t\t", 
                         "out"}]}], "\n", "\t\t", "]"}]}]}], "CodeInput"]}, 
             Open]], Cell[CellGroupData[
             {Cell["\[LeftCeiling]CustomServiceConnection\[RightFloor]", 
               "CodeSubsubsubsection", Evaluatable -> True], Cell[BoxData[
                RowBox[{RowBox[{"CustomServiceConnection", "[", "\n", "\t", 
                    RowBox[{RowBox[{"name_String", "?", RowBox[{"(", RowBox[
                          {"StringMatchQ", "[", RowBox[{"WordCharacter", 
                          ".."}], "]"}], ")"}]}], ",", "\n", "\t", RowBox[
                       {"directory", ":", RowBox[{RowBox[{"_String", "?", 
                          "DirectoryQ"}], "|", "Automatic"}], ":", 
                        "Automatic"}], ",", "\n", "\t", RowBox[{"pack", ":", 
                        RowBox[{"True", "|", "False"}], ":", "True"}], ",", 
                      "\n", "\t", RowBox[{"ops", ":", RowBox[
                         {"OptionsPattern", "[", "]"}]}]}], "\n", "\t", 
                    "]"}], ":=", "\n", "\t", RowBox[{RowBox[
                     {"PackageExceptionBlock", "[", 
                      "\"CustomServiceConnection\"", "]"}], "@", "\n", 
                    "\t\t", RowBox[{"iCustomServiceConnection", "[", 
                      RowBox[{"name", ",", " ", "directory", ",", " ", 
                        "pack", ",", " ", "ops"}], "]"}]}]}]], "CodeInput"]}, 
             Open]]}, Open]]}, Open]], 
     Cell[BoxData[RowBox[{RowBox[{"End", "[", "]"}], ";"}]], 
      "InputSection"]}, Open]], Cell["", "SectionSeparator"]}, 
 WindowSize -> {808, 755}, WindowMargins -> 
  {{Automatic, 41}, {Automatic, 0}}, FrontEndVersion -> 
  "11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, 2018)", 
 StyleDefinitions -> FrontEnd`FileName[{"BTools"}, "CodePackage.nb", 
   CharacterEncoding -> "UTF-8"]]
