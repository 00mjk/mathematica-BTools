Notebook[{

Cell[CellGroupData[{
Cell["ServiceConnection", "CodeSection",
 CellChangeTimes->{{3.7048445511711807`*^9, 
  3.7048445541044893`*^9}},ExpressionUUID->"351929a8-8dae-4e2d-935c-\
23bb44b4f867"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CustomServiceConnection", "::", "usage"}], "=", 
  "\"\<Builds a custom ServiceConnection paclet\>\""}]], "CodeInput",
 CellChangeTimes->{{3.704844557123069*^9, 
  3.704844594342607*^9}},ExpressionUUID->"7bde3193-98ad-4f15-a933-\
9887ab1b1e4a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], 
  ";"}]], "InputSection",ExpressionUUID->"29b70ca7-8bea-4bbb-ae61-\
1e947ad89be3"],

Cell[CellGroupData[{

Cell["Setup", "CodeSubsection",
 CellChangeTimes->{{3.7048446125032673`*^9, 3.7048446212380047`*^9}, 
   3.7048449905303793`*^9},ExpressionUUID->"703c3465-dc95-4ead-984d-\
26e2672c0c5a"],

Cell[CellGroupData[{

Cell["Import Functions", "CodeSubsubsection",
 CellChangeTimes->{{3.704846115815501*^9, 
  3.7048461215344267`*^9}},ExpressionUUID->"2ca833e9-d81a-4cca-bc4e-\
15d37cfca884"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CustomServiceConnection", "::", "ifkey"}], "=", 
   "\"\<Import function `` missing keys ``\>\""}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.704846346990922*^9, 
  3.704846377707532*^9}},ExpressionUUID->"0175460f-7598-4cea-a3be-\
9d7fdb3d2200"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "customServiceConnectionImportFunction", "]"}], ":=",
    "\n", "\t", 
   RowBox[{"{", "\n", "\t\t", 
    RowBox[{
     RowBox[{"\"\<URL\>\"", "\[Rule]", "None"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<Method\>\"", "\[Rule]", "\"\<GET\>\""}], ",", "\n", "\t\t", 
     
     RowBox[{"\"\<Body\>\"", "\[Rule]", "None"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<Headers\>\"", "\[Rule]", "None"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<Path\>\"", "\[Rule]", "None"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<Parameters\>\"", "\[Rule]", "None"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<Required\>\"", "\[Rule]", "None"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<Function\>\"", "\[Rule]", "None"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<Permissions\>\"", "\[Rule]", "None"}], ",", "\n", "\t\t", 
     RowBox[{"\"\<ReturnContentData\>\"", "\[Rule]", "None"}], ",", "\n", 
     "\t\t", 
     RowBox[{"\"\<RequiredPermissions\>\"", "\[Rule]", "None"}], ",", "\n", 
     "\t", "\t", 
     RowBox[{"\"\<IncludeAuth\>\"", "\[Rule]", "None"}], ",", "\n", "\t", 
     "\t", 
     RowBox[{"\"\<MultipartData\>\"", "\[Rule]", "None"}], ",", "\n", "\t", 
     "\t", 
     RowBox[{"\"\<BodyData\>\"", "\[Rule]", "None"}]}], "\n", "\t\t", "}"}]}],
   ";"}], "\n", 
 RowBox[{
  RowBox[{"customServiceConnectionImportFunction", "[", 
   RowBox[{"name_", ",", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
  RowBox[{"With", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"basic", "=", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"DeleteCases", "[", "None", "]"}], "@", "\n", "\t\t\t\t\t", 
        RowBox[{"Association", "@", 
         RowBox[{"{", "ops", "}"}]}]}]}], ",", "\n", "\t\t\t", 
      RowBox[{"required", "=", "\n", "\t\t\t\t", 
       RowBox[{"{", 
        RowBox[{"\"\<URL\>\"", ",", "\"\<Path\>\""}], "}"}]}]}], "\n", 
     "\t\t\t", "}"}], ",", "\n", "\t\t", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{"function", "=", "\n", "\t\t\t\t", 
        RowBox[{"Join", "[", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"DeleteCases", "[", 
            RowBox[{"{", "}"}], "]"}], "@", "\n", "\t\t\t\t\t\t", 
           RowBox[{"<|", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"\"\<BodyData\>\"", "->", "\n", "\t\t\t\t\t\t\t\t", 
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"Lookup", "[", 
                 RowBox[{"basic", ",", "\"\<Body\>\"", ",", 
                  RowBox[{"{", "}"}]}], "]"}], ",", 
                RowBox[{"_String", "|", "_Rule"}]}], "]"}]}], ",", "\n", 
             "\t\t\t\t\t\t\t", 
             RowBox[{
             "\"\<MultipartData\>\"", "->", "\n", "\t\t\t\t\t\t\t\t", 
              RowBox[{"Cases", "[", 
               RowBox[{
                RowBox[{"Lookup", "[", 
                 RowBox[{"basic", ",", "\"\<Body\>\"", ",", 
                  RowBox[{"{", "}"}]}], "]"}], ",", "_List"}], "]"}]}]}], 
            "\n", "\t\t\t\t\t\t\t", "|>"}]}], ",", "\n", "\t\t\t\t\t", 
          RowBox[{"KeyDrop", "[", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"KeyMap", "[", "\n", "\t\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"Replace", "[", 
               RowBox[{"{", "\n", "\t", "\t", "\t", "\t", "\t\t\t\t", 
                RowBox[{
                 RowBox[{"\"\<Method\>\"", "\[Rule]", "\"\<HTTPSMethod\>\""}],
                  ",", "\n", "\t", "\t", "\t", "\t", "\t\t\t\t", 
                 RowBox[{
                 "\"\<Path\>\"", "\[Rule]", "\"\<PathParameters\>\""}], ",", 
                 "\n", "\t", "\t", "\t", "\t", "\t\t\t\t", 
                 RowBox[{
                 "\"\<Required\>\"", "\[Rule]", 
                  "\"\<RequiredParameters\>\""}], ",", "\n", "\t", "\t", "\t",
                  "\t", "\t\t\t\t", 
                 RowBox[{
                 "\"\<Function\>\"", "\[Rule]", "\"\<ResultsFunction\>\""}], 
                 ",", "\n", "\t\t\t\t\t\t\t\t", 
                 RowBox[{
                 "\"\<Permissions\>\"", "->", 
                  "\"\<RequiredPermisssions\>\""}]}], "\n", 
                "\t\t\t\t\t\t\t\t", "}"}], "]"}], ",", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"!", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"KeyMemberQ", "[", 
                    RowBox[{"basic", ",", "\"\<Method\>\""}], "]"}], "&&", 
                    RowBox[{"KeyMemberQ", "[", 
                    RowBox[{"basic", ",", "\"\<HTTPSMethod\>\""}], "]"}]}], 
                   ")"}]}], ",", "\n", "\t", "\t", "\t\t\t\t\t\t", 
                 RowBox[{"Append", "[", 
                  RowBox[{"\"\<Method\>\"", "\[Rule]", 
                   RowBox[{"OptionValue", "[", "\"\<Method\>\"", "]"}]}], 
                  "]"}], ",", "\n", "\t", "\t", "\t\t\t\t\t\t", "Identity"}], 
                "\n", "\t", "\t", "\t\t\t\t\t\t", "]"}], "@", "basic"}]}], 
             "\n", "\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t\t", 
            "\"\<Body\>\""}], "\n", "\t\t\t\t\t\t", "]"}]}], "\n", 
         "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t\t", 
      RowBox[{"Replace", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"Select", "[", "MissingQ", "]"}], "@", "\n", "\t\t\t\t\t", 
         RowBox[{"Lookup", "[", 
          RowBox[{"function", ",", 
           RowBox[{"AssociationThread", "[", 
            RowBox[{"required", ",", "required"}], "]"}]}], "]"}]}], ",", 
        RowBox[{"{", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"a_", "?", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"Length", "@", "#"}], ">", "0"}], "&"}], ")"}]}], ":>",
            "\n", "\t\t\t\t\t\t", 
           RowBox[{"(", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"Message", "[", 
              RowBox[{
               RowBox[{"CustomServiceConnection", "::", "ifkey"}], ",", 
               "name", ",", 
               RowBox[{"Keys", "@", "a"}]}], "]"}], ";", "\n", 
             "\t\t\t\t\t\t\t", "$Failed"}], "\n", "\t\t\t\t\t\t\t", ")"}]}], 
          ",", "\n", "\t\t\t\t\t", 
          RowBox[{"_", ":>", "\n", "\t\t\t\t\t\t", 
           RowBox[{"(", 
            RowBox[{"name", "->", 
             RowBox[{"Normal", "@", "function"}]}], ")"}]}]}], "\n", 
         "\t\t\t\t", "}"}]}], "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
   "]"}]}]}], "CodeInput",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQAWIQnf9pd2XerNeOM1zZpoLoihqlWSD6FdOyhSC67mPJ
PhBtXDvxMIjusHt3FkRveCx6BUTP2tDxFESrizI8A9Ftaw+9AdE+M5Q+gOgw
073fwPo7zjDkA+kfD+aygmiHST08INptWpssiJZYel4ORGvxb7/mPvu1Y7r5
GTAdsUD4Noi+sPTcIxBdEpT5LRhIi33J+gmit8/i4A8B0ivUPwiB6GuPYxRB
NA/7EnUw3+NSMogW27q7EETXBbzqBdGLxF73gehnKS//gOiu0v5/IPqL9E3h
UCCdtWyyGIjuftj8MAJIy6jeBdOiBRvWNAHpb2x9a0E0ACqYrAs=
  
  "],ExpressionUUID->"7d9b2eff-738a-4160-95ec-ec030005354a"]
}, Closed]],

Cell[CellGroupData[{

Cell["Prep Functions", "CodeSubsubsection",
 CellChangeTimes->{{3.704846115815501*^9, 
  3.704846137269944*^9}},ExpressionUUID->"c5eceb81-461e-42d7-b12c-\
8f8c1791cbd5"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"CustomServiceConnection", "::", "pfkey"}], "=", 
   "\"\<Process function `` missing keys ``\>\""}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.704846346990922*^9, 3.704846377707532*^9}, {
  3.704846598825748*^9, 
  3.704846602104795*^9}},ExpressionUUID->"cc13b1ef-505e-4351-ac54-\
5f6cd1f111d3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "customServiceConnectionProcessFunction", "]"}], 
   "=", 
   RowBox[{"{", "\n", "\t", 
    RowBox[{
     RowBox[{"\"\<Call\>\"", "\[Rule]", "None"}], ",", "\n", "\t", 
     RowBox[{"\"\<Method\>\"", "\[Rule]", "None"}], ",", "\n", "\t", 
     RowBox[{"\"\<CleanArguments\>\"", "\[Rule]", "None"}], ",", "\n", "\t", 
     RowBox[{"\"\<Pre\>\"", "\[Rule]", "None"}], ",", "\n", "\t", 
     RowBox[{"\"\<Import\>\"", "\[Rule]", "None"}], ",", "\n", "\t", 
     RowBox[{"\"\<Post\>\"", "\[Rule]", "None"}], ",", "\n", "\t", 
     RowBox[{"\"\<Default\>\"", "\[Rule]", "None"}], ",", "\n", "\t", 
     RowBox[{"\"\<Parameters\>\"", "\[Rule]", "None"}], ",", "\n", "\t", 
     RowBox[{"\"\<Required\>\"", "\[Rule]", "None"}]}], "\n", "\t", "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"customServiceConnectionProcessFunction", "[", 
    RowBox[{"name_", ",", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"function", "=", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"DeleteCases", "[", "None", "]"}], "@", "\n", "\t\t\t\t\t", 
         RowBox[{"Association", "@", 
          RowBox[{"{", "ops", "}"}]}]}]}], ",", "\n", "\t\t\t", 
       RowBox[{"required", "=", "\n", "\t\t\t\t", 
        RowBox[{"{", "}"}]}]}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{"Replace", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"Select", "[", "MissingQ", "]"}], "@", "\n", "\t\t\t\t", 
        RowBox[{"Lookup", "[", 
         RowBox[{"function", ",", 
          RowBox[{"AssociationThread", "[", 
           RowBox[{"required", ",", "required"}], "]"}]}], "]"}]}], ",", 
       RowBox[{"{", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"a_", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Length", "@", "#"}], ">", "0"}], "&"}], ")"}]}], ":>", 
          "\n", "\t\t\t\t\t", 
          RowBox[{"(", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"Message", "[", 
             RowBox[{
              RowBox[{"CustomServiceConnection", "::", "pfkey"}], ",", "name",
               ",", 
              RowBox[{"Keys", "@", "a"}]}], "]"}], ";", "\n", "\t\t\t\t\t\t", 
            "$Failed"}], "\n", "\t\t\t\t\t\t", ")"}]}], ",", "\n", "\t\t\t\t", 
         RowBox[{"_", ":>", "\n", "\t\t\t\t\t", 
          RowBox[{"(", 
           RowBox[{"name", "->", "function"}], ")"}]}]}], "\n", "\t\t\t", 
        "}"}]}], "]"}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{"\t", 
  RowBox[{
   RowBox[{"customServiceConnectionProcessFunction", "[", 
    RowBox[{"name_", ",", "func_"}], "]"}], ":=", "\n", "\t\t", 
   RowBox[{"customServiceConnectionProcessFunction", "[", 
    RowBox[{"name", ",", "\n", "\t\t\t", 
     RowBox[{"\"\<Call\>\"", "\[Rule]", 
      RowBox[{"\"\<Raw\>\"", "<>", "name"}]}], ",", "\n", "\t\t\t", 
     RowBox[{"\"\<Import\>\"", "\[Rule]", "func"}]}], "\n", "\t\t\t", 
    "]"}]}]}]}], "CodeInput",
 CellChangeTimes->{{3.704845261873344*^9, 3.7048454801959953`*^9}, {
   3.704845521077694*^9, 3.7048455811878557`*^9}, {3.704845811654479*^9, 
   3.704845852546533*^9}, {3.704845935445133*^9, 3.704845984684044*^9}, {
   3.704846124271558*^9, 3.704846128002582*^9}, {3.704846182083682*^9, 
   3.704846209081091*^9}, {3.7048462619127607`*^9, 3.704846342391626*^9}, {
   3.704846380933712*^9, 3.7048464865200157`*^9}, {3.704846521481552*^9, 
   3.7048466127366257`*^9}, 3.705022351617989*^9, 3.705148006831519*^9, {
   3.705155141190957*^9, 3.705155170694578*^9}, {3.705408038969358*^9, 
   3.7054080593805847`*^9}, 3.7054081468378067`*^9, {3.7054108550907497`*^9, 
   3.705410913592656*^9}, {3.705420137815063*^9, 3.7054201512804613`*^9}, {
   3.70543336226824*^9, 3.705433366040523*^9}, {3.721332079978291*^9, 
   3.721332104678707*^9}, {3.721332264095202*^9, 
   3.721332286709261*^9}},ExpressionUUID->"2cab8b99-704c-4f69-b3fe-\
b7755d9298a4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Template", "CodeSubsubsection",
 CellChangeTimes->{{3.7048513797247047`*^9, 
  3.7048513806599007`*^9}},ExpressionUUID->"d3eeb05f-728e-43b8-8193-\
57319b2f04cb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$customServiceExportContext", "=", "$Context"}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.704853239422886*^9, 
  3.704853248341065*^9}},ExpressionUUID->"9c632caf-9337-4315-adcc-\
1e8eec66b15f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"customServiceTemplateExport", "[", "\n", "\t", 
    RowBox[{
    "name_", ",", "\n", "\t", "dir_", ",", "\n", "\t", "template_", ",", "\n",
      "\t", "params_"}], "\n", "\t", "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"tf", "=", "\n", "\t\t\t", 
        RowBox[{"PackageFilePath", "[", "\n", "\t\t\t\t", 
         RowBox[{
         "\"\<Resources\>\"", ",", "\n", "\t\t\t\t", "\"\<Templates\>\"", ",",
           "\n", "\t", "\t\t\t", "\"\<$ServiceConnection\>\"", ",", "\n", 
          "\t", "\t\t\t", "\"\<Kernel\>\"", ",", "\n", "\t", "\t\t\t", 
          RowBox[{"template", "<>", "\"\<.m\>\""}]}], "\n", "\t", "\t\t\t", 
         "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"out", "=", "\n", "\t\t\t", 
        RowBox[{"FileNameJoin", "@", 
         RowBox[{"{", "\n", "\t\t\t\t", 
          RowBox[{"dir", ",", "\n", "\t\t\t\t", 
           RowBox[{"\"\<ServiceConnection_\>\"", "<>", "name"}], ",", "\n", 
           "\t\t\t\t", "\"\<Kernel\>\"", ",", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{"StringReplace", "[", "\n", "\t\t\t\t\t", 
             RowBox[{"template", ",", "\n", "\t\t\t\t\t", 
              RowBox[{
              "\"\<$ServiceConnection\>\"", "->", "\n", "\t\t\t\t\t\t", 
               "name"}]}], "\n", "\t\t\t\t\t", "]"}], "<>", "\"\<.m\>\""}]}], 
          "\n", "\t\t\t\t", "}"}]}]}]}], "\n", "\t\t", "}"}], ",", "\n", 
     "\t\t", 
     RowBox[{"Block", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"$Context", "=", "$customServiceExportContext"}], "}"}], ",", 
       "\n", "\t\t\t", 
       RowBox[{"Export", "[", 
        RowBox[{"out", ",", "\n", "\t", "\t\t\t", 
         RowBox[{"StringReplace", "[", "\n", "\t", "\t\t\t\t", 
          RowBox[{
           RowBox[{"Import", "[", 
            RowBox[{"tf", ",", "\"\<Text\>\""}], "]"}], ",", "\n", "\t", 
           "\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"obj", "=", "#2"}], ",", 
                 RowBox[{"key", "=", "#"}]}], "}"}], ",", "\n", "\t", 
               "\t\t\t\t\t", 
               RowBox[{"#", "->", "\n", "\t", "\t\t\t\t\t\t", 
                RowBox[{"Switch", "[", 
                 RowBox[{"obj", ",", "\n", "\t", "\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"Verbatim", "[", "Verbatim", "]"}], "[", "_String",
                    "]"}], ",", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                  RowBox[{"First", "@", "obj"}], ",", "\n", "\t", 
                  "\t\t\t\t\t\t\t", "_Function", ",", "\n", "\t", 
                  "\t\t\t\t\t\t\t\t", 
                  RowBox[{"\"\<(\>\"", "<>", 
                   RowBox[{"ToString", "[", 
                    RowBox[{"#2", ",", "InputForm"}], "]"}], "<>", 
                   "\"\<)\>\""}], ",", "\n", "\t", "\t\t\t\t\t\t\t", "_", ",",
                   "\n", "\t\t\t\t\t\t\t\t\t", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ListQ", "@", "obj"}], "||", 
                    RowBox[{"AssociationQ", "@", "obj"}]}], ")"}], "&&", 
                    RowBox[{
                    RowBox[{"Length", "@", "obj"}], ">", "0"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Replace", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    "NewlineateCodeRecursive", "[", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"obj", ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"_List", "|", "_Association", "|", "_Rule"}]}], 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", "]"}], ",", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"RawBoxes", "[", "r_", "]"}], "\[RuleDelayed]", 
                    "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "\"\<\\n\>\"", "<>", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    "FrontEndExecute", "[", "\n", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "ExportPacket", "[", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    "Cell", "[", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"BoxData", "@", "r"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "\"\<Input\>\""}], "\n", 
                    "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                    "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t", "\"\<InputText\>\""}],
                     "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"e_", "\[RuleDelayed]", 
                    RowBox[{"(", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"obj", ",", "InputForm"}], "]"}], ")"}]}]}], "\n",
                     "\t\t\t\t\t\t\t\t\t\t", "}"}]}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"obj", ",", "InputForm"}], "]"}]}], "\n", "\t", 
                   "\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t", 
                 "\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t", "\t\t\t\t\t", "]"}],
              "&"}], "@@@", "params"}]}], "\n", "\t\t\t\t\t", "]"}], ",", 
         "\n", "\t\t\t\t", "\"\<Text\>\""}], "\n", "\t", "\t\t\t", "]"}]}], 
      "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.704847165062221*^9, 3.7048473910936623`*^9}, {
   3.704847499576294*^9, 3.704847528793981*^9}, {3.704851984995627*^9, 
   3.7048520814855757`*^9}, {3.7048521874960003`*^9, 3.704852212637393*^9}, {
   3.70485234906286*^9, 3.7048523818960867`*^9}, {3.704852451292027*^9, 
   3.704852481849318*^9}, {3.704852554976377*^9, 3.704852557110806*^9}, {
   3.704853085862464*^9, 3.704853147288746*^9}, 3.704853200336111*^9, {
   3.7048532524374533`*^9, 3.704853286104062*^9}, 3.705178597440868*^9, 
   3.705289325558154*^9, {3.705322742238703*^9, 3.705322788615266*^9}, {
   3.705323218716687*^9, 3.705323269135006*^9}, {3.70532437623041*^9, 
   3.705324379293344*^9}, {3.705324415486349*^9, 3.705324434654057*^9}, 
   3.705324818560433*^9, 3.7053262704454536`*^9, {3.7099894746768*^9, 
   3.7099894764418983`*^9}, {3.712615013267201*^9, 
   3.7126150255612373`*^9}},ExpressionUUID->"cf9e1d5c-ba65-441b-96eb-\
675565e971af"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Base Functions", "CodeSubsubsection",
 CellChangeTimes->{{3.704846115815501*^9, 3.70484614430995*^9}, {
  3.704851386613186*^9, 
  3.704851387059745*^9}},ExpressionUUID->"ca36e81e-c330-4c17-8116-\
17d7ff848af6"],

Cell[BoxData[
 RowBox[{"$customServiceConnectionBaseFetchFunction", "=", "\n", "\t", 
  RowBox[{"(", "\n", "\t\t\t", 
   RowBox[{
    RowBox[{"With", "[", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"params", " ", "=", " ", 
        RowBox[{"Lookup", "[", 
         RowBox[{
          RowBox[{"{", "##2", "}"}], ",", "\"\<Parameters\>\"", ",", 
          RowBox[{"{", "}"}]}], "]"}]}], "}"}], ",", "\n", "\t", "\t\t\t", 
      RowBox[{"URLFetch", "[", 
       RowBox[{"#1", ",", "\n", "\t", "\t\t\t\t", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"FilterRules", "[", 
          RowBox[{
           RowBox[{"{", "##2", "}"}], ",", 
           RowBox[{"Except", "[", "\"\<Parameters\>\"", "]"}]}], "]"}]}], ",",
         "\n", "\t", "\t\t\t\t\t", 
        RowBox[{
        "\"\<Parameters\>\"", " ", "->", " ", "\n", "\t\t\t\t\t\t\t", 
         RowBox[{"FilterRules", "[", 
          RowBox[{"params", ",", " ", "\n", "\t\t\t\t\t\t\t\t\t", 
           RowBox[{"Except", "[", 
            RowBox[{"{", 
             RowBox[{"\"\<accountid\>\"", ",", " ", "\"\<authtoken\>\""}], 
             "}"}], "]"}]}], "\n", "\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
        "\t\t\t\t\t\t", 
        RowBox[{
         RowBox[{"\"\<Username\>\"", "->", "\"\<accountid\>\""}], "/.", 
         "params"}], ",", "\n", "\t", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{"\"\<Password\>\"", "->", "\"\<authtoken\>\""}], "/.", 
         "params"}]}], "\n", "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}],
     "&"}], "\n", "\t\t\t", ")"}]}]], "CodeInput",
 CellChangeTimes->{{3.704848267564267*^9, 3.7048483067036247`*^9}, {
  3.704849235785524*^9, 3.704849236808332*^9}, {3.704851956598815*^9, 
  3.704851957822432*^9}},ExpressionUUID->"017a9bca-84ec-4a39-a599-\
5b62c08cff19"]
}, Closed]],

Cell[CellGroupData[{

Cell["Prep", "CodeSubsubsection",
 CellChangeTimes->{{3.704851392179089*^9, 
  3.7048513926035023`*^9}},ExpressionUUID->"d018fd76-b3bd-4579-b256-\
67890715df38"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "customServiceConnectionPrep", "]"}], "=", 
   RowBox[{"{", "\n", "\t", 
    RowBox[{
     RowBox[{"\"\<Fetch\>\"", "->", "\n", "\t\t", "Automatic"}], ",", "\n", 
     "\t", 
     RowBox[{"\"\<Client\>\"", "->", "\n", "\t\t", "Automatic"}], ",", "\n", 
     "\t", 
     RowBox[{"\"\<ClientInfo\>\"", "->", "\n", "\t\t", "Automatic"}], ",", 
     "\n", "\t", 
     RowBox[{"\"\<ClientID\>\"", "\[Rule]", "None"}], ",", "\n", "\t", 
     RowBox[{"\"\<ClientSecret\>\"", "\[Rule]", "None"}], ",", "\n", "\t", 
     RowBox[{"\"\<AuthorizationResponseType\>\"", "\[Rule]", "None"}], ",", 
     "\n", "\t", 
     RowBox[{"\"\<RedirectURI\>\"", "\[Rule]", "None"}], ",", "\n", "\t", 
     RowBox[{"\"\<AuthorizationState\>\"", "\[Rule]", "None"}], ",", "\n", 
     "\t", 
     RowBox[{"\"\<AuthorizationScope\>\"", "\[Rule]", "None"}], ",", "\n", 
     "\t", 
     RowBox[{"\"\<LoginURL\>\"", "->", "\n", "\t\t", "None"}], ",", "\n", 
     "\t", 
     RowBox[{"\"\<LogoutURL\>\"", "->", "\n", "\t\t", "None"}], ",", "\n", 
     "\t", 
     RowBox[{"\"\<UseOAuth\>\"", "->", "\n", "\t\t", "Automatic"}], ",", "\n",
      "\t", 
     RowBox[{
     "\"\<AuthorizeEndpoint\>\"", "\[Rule]", "\n", "\t\t", "Automatic"}], ",",
      "\n", "\t", 
     RowBox[{"\"\<AccessEndpoint\>\"", "\[Rule]", "\n", "\t\t", "Automatic"}],
      ",", "\n", "\t", 
     RowBox[{"\"\<TokenRequestor\>\"", "->", "\n", "\t\t", "None"}], ",", 
     "\n", "\t", 
     RowBox[{"\"\<TokenExtractor\>\"", "->", "\n", "\t\t", "None"}], ",", 
     "\n", "\t", 
     RowBox[{"\"\<TermsOfServiceURL\>\"", "->", "\n", "\t\t", "None"}], ",", 
     "\n", "\t", 
     RowBox[{"\"\<Information\>\"", "->", "\n", "\t\t", "None"}], ",", "\n", 
     "\t", 
     RowBox[{"\"\<Icon\>\"", "->", "\n", "\t\t", "None"}], ",", "\n", "\t", 
     RowBox[{"\"\<Functions\>\"", "->", "\n", "\t\t", "None"}]}], "\n", "\t", 
    "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"customServiceConnectionPrep", "[", "\n", "\t", 
   RowBox[{"name_", ",", "\n", "\t", "dir_", ",", "\n", "\t", 
    RowBox[{"functionData", ":", 
     RowBox[{"_List", "?", "OptionQ"}]}], ",", "\n", "\t", 
    RowBox[{"cookingData", ":", 
     RowBox[{"_List", "?", "OptionQ"}]}], ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t", 
     RowBox[{
      RowBox[{"imps", "=", "\n", "\t\t\t", 
       RowBox[{"Association", "[", 
        RowBox[{
        "customServiceConnectionImportFunction", "@@@", "functionData"}], 
        "]"}]}], ",", "\n", "\t\t", 
      RowBox[{"preps", "=", "\n", "\t\t\t", 
       RowBox[{"Association", "[", 
        RowBox[{
        "customServiceConnectionProcessFunction", "@@@", "cookingData"}], 
        "]"}]}]}], "\n", "\t\t", "}"}], ",", "\n", "\t\t", 
    RowBox[{"With", "[", 
     RowBox[{
      RowBox[{"{", "\n", "\t\t\t", 
       RowBox[{"params", "=", "\n", "\t", "\t\t", 
        RowBox[{"Flatten", "@", 
         RowBox[{"{", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{
           "\"\<$ServiceConnectionURLFetch\>\"", "->", "\n", "\t\t\t\t\t", 
            RowBox[{"OptionValue", "@", "\"\<Fetch\>\""}]}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{
           "\"\<$ServiceConnectionClientInfo\>\"", "->", "\n", "\t\t\t\t\t", 
            RowBox[{"OptionValue", "@", "\"\<ClientInfo\>\""}]}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{
           "\"\<$ServiceConnectionClientName\>\"", "->", "\n", "\t\t\t\t\t", 
            RowBox[{"StringReplace", "[", "\n", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"Replace", "[", "\n", "\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"HoldPattern", "[", 
                   RowBox[{"Capitalize", "[", "s_String", "]"}], "]"}], 
                  "\[RuleDelayed]", "\n", "\t\t\t\t\t\t\t\t", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"ToUpperCase", "@", 
                    RowBox[{"StringTake", "[", 
                    RowBox[{"s", ",", "1"}], "]"}]}], "<>", 
                    RowBox[{"StringDrop", "[", 
                    RowBox[{"s", ",", "1"}], "]"}]}], ")"}]}], "\n", 
                 "\t\t\t\t\t\t\t", "]"}], "@", 
                RowBox[{"Capitalize", "@", 
                 RowBox[{"ToLowerCase", "@", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{"StringTrim", "[", "\n", "\t", "\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"Replace", "[", 
                    RowBox[{
                    RowBox[{"OptionValue", "@", "\"\<Client\>\""}], ",", 
                    RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    "Automatic", "\[RuleDelayed]", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Replace", "[", 
                    RowBox[{
                    RowBox[{"OptionValue", "@", "\"\<UseOAuth\>\""}], ",", 
                    "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Except", "[", 
                    RowBox[{"True", "|", "False"}], "]"}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"!", 
                    RowBox[{"MatchQ", "[", 
                    RowBox[{
                    RowBox[{
                    "OptionValue", "[", "\"\<AuthorizeEndpoint\>\"", "]"}], 
                    ",", 
                    RowBox[{"Automatic", "|", "None"}]}], "]"}]}], "&&", "\n",
                     "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"!", 
                    RowBox[{"MatchQ", "[", 
                    RowBox[{
                    RowBox[{
                    "OptionValue", "[", "\"\<AccessEndpoint\>\"", "]"}], ",", 
                    
                    RowBox[{"Automatic", "|", "None"}]}], "]"}]}]}]}]}], "\n",
                     "\t", "\t\t\t\t\t\t\t\t\t\t\t", "]"}], "//", "TrueQ"}], 
                    ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", "\"\<OAuth\>\"", 
                    ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", "\"\<Key\>\""}], 
                    "\n", "\t", "\t\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                    "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Except", "[", "_String", "]"}], "\[Rule]", 
                    "\"\<Key\>\""}]}], "\n", "\t", "\t", "\t\t\t\t\t\t\t", 
                    "}"}]}], "]"}], ",", "\n", "\t", "\t", "\t\t\t\t\t\t", 
                    "\"\<client\>\""}], "\n", "\t", "\t", "\t\t\t\t\t\t", 
                   "]"}]}]}]}], "<>", "\"\<Client\>\""}], ",", "\n", 
              "\t\t\t\t\t\t", 
              RowBox[{"\"\<Oauth\>\"", "\[Rule]", "\"\<OAuth\>\""}]}], "\n", 
             "\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t", 
           RowBox[{
           "\"\<$ServiceConnectionUseOAuth\>\"", "->", "\n", "\t\t\t\t\t", 
            RowBox[{"Replace", "[", 
             RowBox[{
              RowBox[{"OptionValue", "@", "\"\<UseOAuth\>\""}], ",", "\n", 
              "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Except", "[", 
                RowBox[{"True", "|", "False"}], "]"}], ":>", "\n", 
               "\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{"StringQ", "@", 
                  RowBox[{"OptionValue", "@", "\"\<Client\>\""}]}], "&&", 
                 "\n", "\t\t\t\t\t\t\t\t", 
                 RowBox[{"StringStartsQ", "[", 
                  RowBox[{
                   RowBox[{"ToLowerCase", "@", 
                    RowBox[{"OptionValue", "@", "\"\<Client\>\""}]}], ",", 
                   "\"\<oauth\>\""}], "]"}]}], "||", "\n", "\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"!", 
                  RowBox[{"MatchQ", "[", 
                   RowBox[{
                    RowBox[{
                    "OptionValue", "[", "\"\<AuthorizeEndpoint\>\"", "]"}], 
                    ",", 
                    RowBox[{"Automatic", "|", "None"}]}], "]"}]}], "&&", "\n",
                  "\t\t\t\t\t\t\t\t", 
                 RowBox[{"!", 
                  RowBox[{"MatchQ", "[", 
                   RowBox[{
                    RowBox[{
                    "OptionValue", "[", "\"\<AccessEndpoint\>\"", "]"}], ",", 
                    
                    RowBox[{"Automatic", "|", "None"}]}], "]"}]}]}]}]}]}], 
             "\n", "\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t\t", 
           RowBox[{
           "\"\<$ServiceConnectionAuthEndpoint\>\"", "->", "\n", "\t\t\t\t\t", 
            RowBox[{"Replace", "[", 
             RowBox[{
              RowBox[{"OptionValue", "@", "\"\<AuthorizeEndpoint\>\""}], ",", 
              "\n", "\t\t\t\t\t\t", 
              RowBox[{"Automatic", ":>", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"If", "[", "\n", "\t\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"TrueQ", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"TrueQ", "@", 
                    RowBox[{"OptionValue", "@", "\"\<UseOAuth\>\""}]}], "||", 
                   "\n", "\t", "\t", "\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"StringQ", "@", 
                    RowBox[{"OptionValue", "@", "\"\<Client\>\""}]}], "&&", 
                    "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"StringStartsQ", "[", 
                    RowBox[{
                    RowBox[{"ToLowerCase", "@", 
                    RowBox[{"OptionValue", "@", "\"\<Client\>\""}]}], ",", 
                    "\"\<oauth\>\""}], "]"}]}]}], "\n", "\t", 
                  "\t\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t\t\t\t", 
                 "\"\<https://localhost:8080/oauth2authorize\>\"", ",", "\n", 
                 "\t\t\t\t\t\t\t\t", "None"}], "\n", "\t\t\t\t\t\t\t\t", 
                "]"}]}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{
           "\"\<$ServiceConnectionAccessEndpoint\>\"", "->", "\n", 
            "\t\t\t\t\t", 
            RowBox[{"Replace", "[", 
             RowBox[{
              RowBox[{"OptionValue", "@", "\"\<AccessEndpoint\>\""}], ",", 
              "\n", "\t\t\t\t\t\t", 
              RowBox[{"Automatic", ":>", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"If", "[", "\n", "\t\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"TrueQ", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"TrueQ", "@", 
                    RowBox[{"OptionValue", "@", "\"\<UseOAuth\>\""}]}], "||", 
                   "\n", "\t", "\t", "\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"StringQ", "@", 
                    RowBox[{"OptionValue", "@", "\"\<Client\>\""}]}], "&&", 
                    "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"StringStartsQ", "[", 
                    RowBox[{
                    RowBox[{"ToLowerCase", "@", 
                    RowBox[{"OptionValue", "@", "\"\<Client\>\""}]}], ",", 
                    "\"\<oauth\>\""}], "]"}]}]}], "\n", "\t", 
                  "\t\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t\t\t\t", 
                 "\"\<https://localhost:8080/oauth2access\>\"", ",", "\n", 
                 "\t\t\t\t\t\t\t\t", "None"}], "\n", "\t\t\t\t\t\t\t\t", 
                "]"}]}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{
           "\"\<$ServiceConnectionAccessTokenRequestor\>\"", "\[Rule]", "\n", 
            "\t\t\t\t\t", 
            RowBox[{"OptionValue", "@", "\"\<TokenRequestor\>\""}]}], ",", 
           "\n", "\t\t\t\t", 
           RowBox[{
           "\"\<$ServiceConnectionAccessTokenExtractor\>\"", "\[Rule]", "\n", 
            "\t\t\t\t\t", 
            RowBox[{"OptionValue", "@", "\"\<TokenExtractor\>\""}]}], ",", 
           "\n", "\t\t\t\t", 
           RowBox[{
           "\"\<$ServiceConnectionTermsOfServiceURL\>\"", "->", "\n", 
            "\t\t\t\t\t", 
            RowBox[{"OptionValue", "@", "\"\<TermsOfServiceURL\>\""}]}], ",", 
           "\n", "\t\t\t\t", 
           RowBox[{
           "\"\<$ServiceConnectionClientID\>\"", "->", "\n", "\t\t\t\t\t", 
            RowBox[{"OptionValue", "@", "\"\<ClientID\>\""}]}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{
           "\"\<$ServiceConnectionClientSecret\>\"", "->", "\n", "\t\t\t\t\t", 
            RowBox[{"OptionValue", "@", "\"\<ClientSecret\>\""}]}], ",", "\n",
            "\t\t\t\t", 
           RowBox[{
           "\"\<$ServiceConnectionAuthResponseType\>\"", "->", "\n", 
            "\t\t\t\t\t", 
            RowBox[{
            "OptionValue", "@", "\"\<AuthorizationResponseType\>\""}]}], ",", 
           "\n", "\t\t\t\t", 
           RowBox[{
           "\"\<$ServiceConnectionState\>\"", "->", "\n", "\t\t\t\t\t", 
            RowBox[{"OptionValue", "@", "\"\<AuthorizationState\>\""}]}], ",",
            "\n", "\t\t\t\t", 
           RowBox[{
           "\"\<$ServiceConnectionAuthScope\>\"", "->", "\n", "\t\t\t\t\t", 
            RowBox[{"OptionValue", "@", "\"\<AuthorizationScope\>\""}]}], ",",
            "\n", "\t\t\t\t", 
           RowBox[{
           "\"\<$ServiceConnectionRedirectURI\>\"", "->", "\n", "\t\t\t\t\t", 
            
            RowBox[{"Replace", "[", 
             RowBox[{
              RowBox[{"OptionValue", "@", "\"\<RedirectURI\>\""}], ",", "\n", 
              "\t\t\t\t\t\t", 
              RowBox[{"Automatic", ":>", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"OptionValue", "@", "\"\<UseOAuth\>\""}], "||", 
                  "\n", "\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"StringQ", "@", 
                    RowBox[{"OptionValue", "@", "\"\<Client\>\""}]}], "&&", 
                   "\n", "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"StringStartsQ", "[", 
                    RowBox[{
                    RowBox[{"ToLowerCase", "@", 
                    RowBox[{"OptionValue", "@", "\"\<Client\>\""}]}], ",", 
                    "\"\<oauth\>\""}], "]"}]}]}], ",", "\n", 
                 "\t\t\t\t\t\t\t\t", 
                 "\"\<https://localhost:7000/oauth2callback\>\"", ",", "\n", 
                 "\t\t\t\t\t\t\t\t", "None"}], "\n", "\t\t\t\t\t\t\t\t", 
                "]"}]}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{
           "\"\<$ServiceConnectionCalls\>\"", "->", "\n", "\t", "\t\t\t\t", 
            "imps"}], ",", "\n", "\t", "\t\t\t", 
           RowBox[{
           "\"\<$ServiceConnectionCookingFunctions\>\"", "->", "\n", 
            "\t\t\t\t\t", "preps"}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"r", "=", "#"}], ",", 
                 RowBox[{"b", "=", 
                  RowBox[{"ToUpperCase", "@", 
                   RowBox[{"StringTrim", "[", 
                    RowBox[{"#", ",", "\"\<s\>\""}], "]"}]}]}]}], "}"}], ",", 
               "\n", "\t\t\t\t\t\t", 
               RowBox[{"With", "[", 
                RowBox[{
                 RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{"impSpec", "=", "\n", "\t\t\t\t\t\t\t\t", 
                   RowBox[{"Cases", "[", 
                    RowBox[{
                    RowBox[{"Normal", "@", "imps"}], ",", "\n", "\t", "\t", 
                    "\t", "\t", "\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"k_", "\[Rule]", 
                    RowBox[{"{", "\n", "\t", "\t", "\t", "\t", "\t\t\t\t\t\t", 
                    RowBox[{
                    "___", ",", "\n", "\t", "\t", "\t", "\t", "\t\t\t\t\t\t", 
                    
                    RowBox[{"\"\<HTTPSMethod\>\"", "\[Rule]", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ToUpperCase", "@", "#"}], "/.", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    "\"\<PATCH\>\"", "|", "\"\<PUT\>\"", "|", 
                    "\"\<DELETE\>\""}], "\[Rule]", "\"\<POST\>\""}], ")"}]}], 
                    ")"}], "===", "b"}], "&"}], ")"}]}]}], ",", "\n", "\t", 
                    "\t", "\t", "\t", "\t\t\t\t\t\t", "___"}], "\n", "\t", 
                    "\t", "\t", "\t", "\t\t\t\t\t\t", "}"}]}], ")"}], 
                    "\[RuleDelayed]", "k"}]}], "\n", "\t\t\t\t\t\t\t\t\t", 
                    "]"}]}], "\n", "\t\t\t\t\t\t\t", "}"}], ",", "\n", 
                 "\t\t\t\t\t\t", 
                 RowBox[{"Sequence", "@@", "\n", "\t\t\t\t\t\t\t", 
                  RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"\"\<$ServiceConnectionRaw\>\"", "<>", "r"}], "->",
                     "\n", "\t", "\t\t\t\t\t\t\t\t", "impSpec"}], ",", "\n", 
                    "\t", "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"\"\<$ServiceConnection\>\"", "<>", "r"}], "->", 
                    "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Join", "[", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Keys", "@", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Select", "[", 
                    RowBox[{"preps", ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"KeyMemberQ", "[", 
                    RowBox[{"#", ",", "\"\<Method\>\""}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    "ReplaceAll", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"ToUpperCase", "@", 
                    RowBox[{"#", "[", "\"\<Method\>\"", "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    "\"\<PATCH\>\"", "|", "\"\<PUT\>\"", "|", 
                    "\"\<DELETE\>\""}], "\[Rule]", "\"\<POST\>\""}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}], "===", 
                    RowBox[{"ToUpperCase", "@", 
                    RowBox[{"StringTrim", "[", 
                    RowBox[{"r", ",", "\"\<s\>\""}], "]"}]}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"MemberQ", "[", 
                    RowBox[{"impSpec", ",", 
                    RowBox[{"#", "[", "\"\<Call\>\"", "]"}]}], "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}], "&"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"r", "===", "\"\<Gets\>\""}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Keys", "@", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Select", "[", 
                    RowBox[{"preps", ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    
                    RowBox[{
                    RowBox[{
                    "AllTrue", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Lookup", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"{", 
                    RowBox[{"\"\<Call\>\"", ",", "\"\<Method\>\""}], "}"}]}], 
                    "]"}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    "MissingQ"}], "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}],
                     "&"}]}], "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], 
                    ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", "}"}]}], "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                    "]"}]}], "\n", "\t\t\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", 
                   "\t\t\t\t\t\t\t\t", "}"}]}]}], "\n", "\t\t\t\t\t\t", 
                "]"}]}], "\n", "\t\t\t\t\t", "]"}], "&"}], "/@", 
            RowBox[{"{", 
             RowBox[{"\"\<Gets\>\"", ",", "\"\<Posts\>\""}], "}"}]}], ",", 
           "\n", "\t\t\t\t", 
           RowBox[{
           "\"\<$ServiceConnectionInformation\>\"", "->", "\n", "\t\t\t\t\t", 
            
            RowBox[{"OptionValue", "@", "\"\<Information\>\""}]}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{"\"\<$ServiceConnectionIcon\>\"", "->", "\n", "\t\t\t\t\t", 
            RowBox[{"OptionValue", "@", "\"\<Icon\>\""}]}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{
           "\"\<$ServiceConnectionHelperNames\>\"", "->", "\n", "\t\t\t\t\t", 
            
            RowBox[{"Verbatim", "@", "\n", "\t\t\t\t\t\t", 
             RowBox[{"StringRiffle", "[", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Replace", "[", "\n", "\t", "\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"Flatten", "@", 
                  RowBox[{
                   RowBox[{"DeleteCases", "[", "None", "]"}], "@", 
                   RowBox[{"{", 
                    RowBox[{"OptionValue", "@", "\"\<Functions\>\""}], 
                    "}"}]}]}], ",", 
                 RowBox[{"{", "\n", "\t", "\t", "\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"k_", "\[Rule]", "f_"}], ")"}], ":>", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"ToString", "[", "k", "]"}]}], ",", "\n", "\t", 
                   "\t\t\t\t\t\t\t", 
                   RowBox[{"e_", ":>", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"ToString", "@", "e"}]}]}], "\n", "\t", 
                  "\t\t\t\t\t\t\t", "}"}], ",", "\n", "\t", "\t\t\t\t\t\t\t", 
                 "1"}], "]"}], ",", "\n", "\t", "\t\t\t\t\t\t", 
               "\"\<\\n\\n\>\""}], "\n", "\t", "\t\t\t\t\t\t", "]"}]}]}], ",",
            "\n", "\t\t\t\t", 
           RowBox[{
           "\"\<$ServiceConnectionHelperFunctions\>\"", "->", "\n", 
            "\t\t\t\t\t", 
            RowBox[{"Block", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"$ContextPath", "=", 
                RowBox[{"{", 
                 RowBox[{"\"\<System`\>\"", ",", "$Context"}], "}"}]}], "}"}],
               ",", "\n", "\t\t\t\t\t\t", 
              RowBox[{"Verbatim", "@", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"StringRiffle", "[", "\n", "\t", "\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"Replace", "[", "\n", "\t", "\t", "\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"Flatten", "@", 
                    RowBox[{
                    RowBox[{"DeleteCases", "[", "None", "]"}], "@", 
                    RowBox[{"{", 
                    RowBox[{"OptionValue", "@", "\"\<Functions\>\""}], 
                    "}"}]}]}], ",", 
                   RowBox[{"{", "\n", "\t", "\t", "\t", "\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"k_", "\[Rule]", "f_"}], ")"}], ":>", "\n", "\t", 
                    "\t", "\t", "\t\t\t\t\t\t\t", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ToString", "[", "k", "]"}], "<>", "\"\< = \>\"", 
                    "<>", 
                    RowBox[{"ToString", "[", 
                    RowBox[{"f", ",", "InputForm"}], "]"}]}], ")"}]}], ",", 
                    "\n", "\t", "\t", "\t\t\t\t\t\t\t", 
                    RowBox[{"e_", ":>", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ToString", "[", 
                    RowBox[{
                    RowBox[{"Definition", "@", "e"}], ",", "InputForm"}], 
                    "]"}]}]}], "\n", "\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", 
                   "\t\t\t\t\t\t\t\t\t", "1"}], "]"}], ",", "\n", "\t", "\t", 
                 "\t\t\t\t\t\t", "\"\<\\n\\n\>\""}], "\n", "\t\t\t\t\t\t\t\t",
                 "]"}]}]}], "\n", "\t\t\t\t\t\t", "]"}]}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{
           "\"\<$ServiceConnection\>\"", "\[Rule]", "\n", "\t\t\t\t\t", 
            RowBox[{"Verbatim", "@", "name"}]}], ",", "\n", "\t\t\t\t", 
           RowBox[{"\"\<$serviceconnection\>\"", "->", "\n", "\t\t\t\t\t", 
            RowBox[{"Verbatim", "@", 
             RowBox[{"ToLowerCase", "@", "name"}]}]}]}], "\n", "\t\t\t\t", 
          "}"}]}]}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"customServiceTemplateExport", "[", "\n", "\t", "\t\t\t", 
          RowBox[{
          "name", ",", "\n", "\t", "\t\t\t", "dir", ",", "\n", "\t", "\t\t\t",
            "#", ",", "\n", "\t", "\t\t\t", "params"}], "\n", "\t", "\t\t\t", 
          "]"}], "&"}], "/@", 
        RowBox[{"{", "\n", "\t", "\t\t\t\t", 
         RowBox[{
         "\"\<load\>\"", ",", "\n", "\t", "\t\t\t\t", 
          "\"\<$ServiceConnection\>\"", ",", "\n", "\t", "\t\t\t\t", 
          "\"\<$ServiceConnectionFunctions\>\"", ",", "\n", "\t", "\t\t\t\t", 
          "\"\<$ServiceConnectionLoad\>\""}], "\n", "\t\t\t\t\t", "}"}]}], 
       ";"}]}], "\n", "\t\t\t", "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
   "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.704845003332704*^9, 3.7048450458921003`*^9}, {
   3.704845570109336*^9, 3.704845573348674*^9}, {3.70484662356954*^9, 
   3.704846688980835*^9}, {3.704847157223494*^9, 3.704847157812715*^9}, {
   3.704847433019809*^9, 3.704847494774953*^9}, {3.704847539298208*^9, 
   3.704847623150115*^9}, {3.7048477516325073`*^9, 3.704847802496751*^9}, {
   3.704847835522629*^9, 3.704848029584899*^9}, {3.7048482509800777`*^9, 
   3.704848262286035*^9}, {3.7048492480385027`*^9, 3.704849324895853*^9}, {
   3.704849675298152*^9, 3.704849756042488*^9}, {3.7048510748574343`*^9, 
   3.704851271047122*^9}, {3.704851884990727*^9, 3.704851887134542*^9}, 
   3.704852110447575*^9, {3.704852402301465*^9, 3.704852404858663*^9}, {
   3.704852865506488*^9, 3.7048528974230633`*^9}, {3.704852928947195*^9, 
   3.704852942391205*^9}, {3.704852985374401*^9, 3.704852996579585*^9}, {
   3.70485333873055*^9, 3.704853361282782*^9}, {3.704856783712947*^9, 
   3.704856789647621*^9}, {3.704857858205467*^9, 3.704857862670093*^9}, {
   3.704932539077814*^9, 3.704932543667262*^9}, {3.704932594525734*^9, 
   3.704932599923663*^9}, {3.704934062833179*^9, 3.7049341332773237`*^9}, {
   3.7049343352032423`*^9, 3.704934403109735*^9}, {3.7049345216695557`*^9, 
   3.7049345242849903`*^9}, {3.705021611007515*^9, 3.7050216189737463`*^9}, {
   3.705021691676599*^9, 3.705021708809937*^9}, {3.705021950905601*^9, 
   3.7050221682443123`*^9}, 3.7050222030583076`*^9, {3.7050224104363937`*^9, 
   3.705022440323524*^9}, {3.705022511615055*^9, 3.7050225721677*^9}, {
   3.705147379916095*^9, 3.705147413897987*^9}, {3.705147467784795*^9, 
   3.705147542224161*^9}, {3.705147614196809*^9, 3.705147672223934*^9}, {
   3.705147733493284*^9, 3.7051477435225286`*^9}, 3.705151211098477*^9, {
   3.705151369540731*^9, 3.705151373909952*^9}, {3.705151419234462*^9, 
   3.705151463327622*^9}, {3.705151619173358*^9, 3.705151631065495*^9}, {
   3.705152227211658*^9, 3.7051522831862707`*^9}, 3.70515240400609*^9, {
   3.705152856980685*^9, 3.705152858156227*^9}, {3.705153024691011*^9, 
   3.705153027859742*^9}, {3.705153175092936*^9, 3.705153177268942*^9}, {
   3.70515327527367*^9, 3.705153279879026*^9}, {3.7051533199109364`*^9, 
   3.705153361076577*^9}, {3.7051536059137897`*^9, 3.705153611367866*^9}, {
   3.705161830016161*^9, 3.705161873492139*^9}, {3.7051619342448397`*^9, 
   3.705161935834586*^9}, {3.705162082901868*^9, 3.705162157634857*^9}, {
   3.705177742154603*^9, 3.7051777649443817`*^9}, {3.705288164513803*^9, 
   3.705288165953865*^9}, {3.7053264139936037`*^9, 3.705326547968391*^9}, {
   3.7053271803804417`*^9, 3.705327192098118*^9}, 3.7053272776058283`*^9, {
   3.705329066492902*^9, 3.7053292780671*^9}, {3.705330062959016*^9, 
   3.705330065997443*^9}, {3.7053305369448*^9, 3.705330561451076*^9}, {
   3.705330907081669*^9, 3.705330908231827*^9}, {3.7053492063448553`*^9, 
   3.705349222949329*^9}, {3.705355705467106*^9, 3.705355754298788*^9}, {
   3.705358607780656*^9, 3.705358654942419*^9}, {3.705359057893914*^9, 
   3.705359069953722*^9}, 3.705359186911427*^9, {3.705370118494025*^9, 
   3.705370132390299*^9}, {3.705433207989818*^9, 3.7054333204702806`*^9}, {
   3.705433565116991*^9, 3.705433566743965*^9}, 3.705523486210868*^9, {
   3.705532626646428*^9, 3.705532636994026*^9}, {3.7055327178613377`*^9, 
   3.705532792845791*^9}, {3.705593608788415*^9, 3.70559361343547*^9}, {
   3.705594206631936*^9, 3.70559420763243*^9}, {3.705594618207233*^9, 
   3.705594666587207*^9}, {3.7055952122463617`*^9, 3.7055952151451893`*^9}, {
   3.705612242988681*^9, 3.7056122434198713`*^9}, {3.709420794999734*^9, 
   3.709420849878447*^9}, {3.70942091724708*^9, 
   3.709420921045558*^9}},ExpressionUUID->"7553e118-72b4-4047-9ac1-\
3a73f858d477"]
}, Closed]],

Cell[CellGroupData[{

Cell["CustomServiceConnection", "CodeSubsubsection",
 CellChangeTimes->{
  3.704851321451747*^9},ExpressionUUID->"945e2d0c-ac7c-4200-b934-\
637458ec988a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "CustomServiceConnection", "]"}], "=", "\n", "\t", 
   
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"\"\<ImportFunctions\>\"", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", "\n", "\t", "\t", "\t", 
       RowBox[{"\"\<ProcessFunctions\>\"", "\[Rule]", 
        RowBox[{"{", "}"}]}], ",", "\n", "\t\t\t", 
       RowBox[{"\"\<Icon\>\"", "\[Rule]", "None"}]}], "\n", "\t\t\t", "}"}], 
     ",", "\n", "\t\t", 
     RowBox[{"Options", "@", "customServiceConnectionPrep"}], ",", "\n", 
     "\t\t", 
     RowBox[{"Options", "@", "PacletInfoExpressionBundle"}]}], "\n", "\t\t", 
    "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.704851325056922*^9, 3.704851367343534*^9}, {
   3.704851402551193*^9, 3.704851409735743*^9}, {3.7048541359486227`*^9, 
   3.7048541409931927`*^9}, {3.705636538950344*^9, 3.7056365480358353`*^9}, 
   3.705636594920611*^9, 
   3.728150826880739*^9},ExpressionUUID->"e33ca9f4-b2e9-4fc4-8cf8-\
12f75b1aa975"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CustomServiceConnection", "[", "\n", "\t", 
   RowBox[{
    RowBox[{"name_String", "?", 
     RowBox[{"(", 
      RowBox[{"StringMatchQ", "[", 
       RowBox[{"WordCharacter", ".."}], "]"}], ")"}]}], ",", "\n", "\t", 
    RowBox[{"directory", ":", 
     RowBox[{
      RowBox[{"_String", "?", "DirectoryQ"}], "|", "Automatic"}], ":", 
     "Automatic"}], ",", "\n", "\t", 
    RowBox[{"pack", ":", 
     RowBox[{"True", "|", "False"}], ":", "True"}], ",", "\n", "\t", 
    RowBox[{"ops", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", "\n", 
  "\t", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"dir", "=", 
      RowBox[{"Replace", "[", 
       RowBox[{"directory", ",", 
        RowBox[{"Automatic", "\[RuleDelayed]", "$TemporaryDirectory"}]}], 
       "]"}]}], "}"}], ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Quiet", "@", 
      RowBox[{"CreateDirectory", "@", "\n", "\t\t\t", 
       RowBox[{"FileNameJoin", "@", 
        RowBox[{"{", "\n", "\t\t\t\t", 
         RowBox[{"dir", ",", "\n", "\t\t\t\t", 
          RowBox[{"\"\<ServiceConnection_\>\"", "<>", "name"}], ",", "\n", 
          "\t\t\t\t", "\"\<Kernel\>\""}], "\n", "\t\t\t\t", "}"}]}]}]}], ";", 
     "\n", "\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"res", "=", "\n", "\t\t\t", 
         RowBox[{"customServiceConnectionPrep", "[", "\n", "\t\t\t\t", 
          RowBox[{
          "name", ",", "\n", "\t", "\t\t\t", "dir", ",", "\n", "\t", "\t\t\t", 
           RowBox[{"OptionValue", "@", "\"\<ImportFunctions\>\""}], ",", "\n",
            "\t", "\t\t\t", 
           RowBox[{"OptionValue", "@", "\"\<ProcessFunctions\>\""}], ",", 
           "\n", "\t\t\t\t", 
           RowBox[{"FilterRules", "[", 
            RowBox[{
             RowBox[{"{", "\n", "\t\t\t\t\t", 
              RowBox[{
               RowBox[{"\"\<Icon\>\"", "\[Rule]", "\n", "\t\t\t\t\t\t", 
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"OptionValue", "@", "\"\<Icon\>\""}], ",", 
                  RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Graphics", "[", 
                    RowBox[{"e_", ",", "o___"}], "]"}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Graphics", "[", 
                    RowBox[{"e", ",", 
                    RowBox[{"ImageSize", "\[Rule]", "24"}], ",", "o"}], 
                    "]"}]}], ",", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Except", "[", 
                    RowBox[{"None", "|", "_Graphics"}], "]"}], "\[Rule]", 
                    "Automatic"}]}], "\n", "\t\t\t\t\t\t\t", "}"}]}], "]"}]}],
                ",", "\n", "\t\t\t\t\t\t", "ops"}], "}"}], ",", "\n", 
             "\t\t\t\t\t", 
             RowBox[{"Options", "@", "customServiceConnectionPrep"}]}], 
            "]"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "}"}], ",", 
       "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"AllTrue", "[", 
           RowBox[{"res", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"StringQ", "@", "#"}], "&&", 
              RowBox[{"FileExistsQ", "@", "#"}]}], "&"}]}], "]"}], ",", "\n", 
          "\t\t\t\t", 
          RowBox[{
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", "\n", "\t\t\t\t\t", 
              RowBox[{
               RowBox[{"bmdir", "=", "\n", "\t\t\t\t\t\t", 
                RowBox[{"FileNameJoin", "@", 
                 RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t", 
                  RowBox[{"dir", ",", "\n", "\t", "\t\t\t\t\t\t\t", 
                   RowBox[{"\"\<ServiceConnection_\>\"", "<>", "name"}], ",", 
                   "\n", "\t", "\t\t\t\t\t\t\t", "\"\<FrontEnd\>\"", ",", 
                   "\n", "\t", "\t\t\t\t\t\t\t", "\"\<SystemResources\>\"", 
                   ",", "\n", "\t", "\t\t\t\t\t\t\t", "\"\<Bitmaps\>\""}], 
                  "\n", "\t", "\t\t\t\t\t\t", "}"}]}]}], ",", "\n", 
               "\t\t\t\t\t", 
               RowBox[{"things", "=", "\n", "\t\t\t\t\t\t", 
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"OptionValue", "@", "\"\<Icon\>\""}], ",", 
                  RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"g_Graphics", ":>", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Insert", "[", 
                    RowBox[{"g", ",", "\n", "\t", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"ImageSize", "\[Rule]", "24"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t\t", "2"}], "\n", "\t\t\t\t\t\t\t\t\t\t",
                     "]"}], ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Insert", "[", 
                    RowBox[{"g", ",", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"ImageSize", "\[Rule]", "48"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "2"}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t", "}"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"i_", "?", "ImageQ"}], ":>", "\n", "\t", 
                    "\t\t\t\t\t\t\t", 
                    RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"ImageResize", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", "24", "}"}]}], "]"}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"ImageResize", "[", 
                    RowBox[{"i", ",", 
                    RowBox[{"{", "48", "}"}]}], "]"}]}], "\n", "\t", 
                    "\t\t\t\t\t\t\t\t", "}"}]}], ",", "\n", "\t", 
                    "\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"e", ":", 
                    RowBox[{"Except", "[", 
                    RowBox[{"None", "|", 
                    RowBox[{"{", 
                    RowBox[{"_", ",", "_"}], "}"}]}], "]"}]}], ":>", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Rasterize", "[", 
                    RowBox[{
                    "e", ",", "\"\<Image\>\"", ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"RasterSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"24", ",", "24"}], "}"}]}]}], "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Rasterize", "[", 
                    RowBox[{
                    "e", ",", "\"\<Image\>\"", ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"RasterSize", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"48", ",", "48"}], "}"}]}]}], "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t", "}"}]}]}], "\n", "\t\t\t\t\t\t\t", 
                   "}"}]}], "]"}]}]}], "\n", "\t\t\t\t\t", "}"}], ",", "\n", 
             "\t\t\t\t\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"ListQ", "@", "things"}], "&&", 
                RowBox[{
                 RowBox[{"Length", "@", "things"}], "\[Equal]", "2"}]}], ",", 
               "\n", "\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"Quiet", "@", 
                 RowBox[{"CreateDirectory", "@", "bmdir"}]}], ";", "\n", 
                "\t\t\t\t\t\t\t", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"MatchQ", "[", 
                   RowBox[{
                    RowBox[{"First", "@", "things"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"_File", "|", "_String"}], ")"}], "?", 
                    "FileExistsQ"}]}], "]"}], ",", "\n", "\t\t\t\t\t\t\t\t", 
                  RowBox[{"CopyFile", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"First", "@", "things"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"FileNameJoin", "@", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"bmdir", ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"ToLowerCase", "@", "name"}], "<>", 
                    "\"\<.png\>\""}]}], "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    "}"}]}]}], "\n", "\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                  "\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"Export", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"FileNameJoin", "@", 
                    RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"bmdir", ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"ToLowerCase", "@", "name"}], "<>", 
                    "\"\<.png\>\""}]}], "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    "}"}]}], ",", "\n", "\t", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"First", "@", "things"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t", "]"}], ";", "\n", "\t\t\t\t\t\t\t", 
                   
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"MatchQ", "[", 
                    RowBox[{
                    RowBox[{"Last", "@", "things"}], ",", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"_File", "|", "_String"}], ")"}], "?", 
                    "FileExistsQ"}]}], "]"}], ",", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"CopyFile", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Last", "@", "things"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"FileNameJoin", "@", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"bmdir", ",", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"ToLowerCase", "@", "name"}], "<>", 
                    "\"\<@2.png\>\""}]}], "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    "}"}]}]}], "\n", "\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Export", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"FileNameJoin", "@", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"bmdir", ",", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"ToLowerCase", "@", "name"}], "<>", 
                    "\"\<@2.png\>\""}]}], "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    "}"}]}], ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Last", "@", "things"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t\t\t", 
                    "]"}]}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}]}], "\n", 
              "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "]"}], ";", "\n", 
           "\t\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{"pack", ",", "\n", "\t\t\t\t\t", 
             RowBox[{
              RowBox[{"PacletInfoExpressionBundle", "[", "\n", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"FileNameJoin", "@", 
                 RowBox[{"{", 
                  RowBox[{"dir", ",", 
                   RowBox[{"\"\<ServiceConnection_\>\"", "<>", "name"}]}], 
                  "}"}]}], ",", "\n", "\t\t\t\t\t\t", 
                RowBox[{"FilterRules", "[", 
                 RowBox[{
                  RowBox[{"Flatten", "@", 
                   RowBox[{"{", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"FilterRules", "[", 
                    RowBox[{
                    RowBox[{"{", "ops", "}"}], ",", " ", 
                    RowBox[{"Except", "[", "\"\<Icon\>\"", "]"}]}], "]"}], 
                    ",", "\n", "\t\t\t\t\t\t\t", 
                    RowBox[{"\"\<Icon\>\"", "->", "\n", "\t\t\t\t\t\t\t\t", 
                    RowBox[{"FileNameJoin", "@", 
                    RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    "\"\<FrontEnd\>\"", ",", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    "\"\<SystemResources\>\"", ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "\"\<Bitmaps\>\"", ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"ToLowerCase", "@", "name"}], "<>", 
                    "\"\<@2.png\>\""}]}], "\n", "\t\t\t\t\t\t\t\t\t\t", 
                    "}"}]}]}]}], "\n", "\t\t\t\t\t\t\t\t", "}"}]}], ",", "\n",
                   "\t\t\t\t\t\t\t", 
                  RowBox[{"Options", "@", "PacletInfoExpressionBundle"}]}], 
                 "\n", "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t", "]"}],
               ";", "\n", "\t\t\t\t\t", 
              RowBox[{"PacletBundle", "@", 
               RowBox[{"FileNameJoin", "@", 
                RowBox[{"{", 
                 RowBox[{"dir", ",", 
                  RowBox[{"\"\<ServiceConnection_\>\"", "<>", "name"}]}], 
                 "}"}]}]}]}], ",", "\n", "\t", "\t\t\t\t", 
             RowBox[{"FileNameJoin", "@", 
              RowBox[{"{", 
               RowBox[{"dir", ",", 
                RowBox[{"\"\<ServiceConnection_\>\"", "<>", "name"}]}], 
               "}"}]}]}], "\n", "\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t", 
         "]"}], "/;", 
        RowBox[{"AllTrue", "[", 
         RowBox[{"res", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"StringQ", "@", "#"}], "&&", 
            RowBox[{"FileExistsQ", "@", "#"}]}], "&"}]}], "]"}]}]}], "\n", 
      "\t\t\t", "]"}]}]}], "\n", "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.7048514948116207`*^9, 3.704851808924111*^9}, {
   3.704851914514351*^9, 3.704851936464603*^9}, {3.704852227884761*^9, 
   3.704852237622634*^9}, {3.704854154320897*^9, 3.7048541648987713`*^9}, {
   3.704854203946783*^9, 3.7048542458907223`*^9}, {3.7048543141396103`*^9, 
   3.7048543276416197`*^9}, {3.704854372379118*^9, 3.7048544031104097`*^9}, {
   3.704854513741249*^9, 3.7048546674459743`*^9}, {3.704932420214341*^9, 
   3.704932452157689*^9}, {3.704934812342885*^9, 3.7049348165256157`*^9}, {
   3.704934888116539*^9, 3.704934927448769*^9}, {3.704935002798273*^9, 
   3.70493500571714*^9}, {3.704936967266111*^9, 3.704937155948433*^9}, {
   3.704944096597715*^9, 3.7049441091708813`*^9}, {3.704944211851027*^9, 
   3.704944216722764*^9}, {3.704944305150876*^9, 3.704944307541629*^9}, {
   3.704944592254834*^9, 3.7049446101718082`*^9}, {3.7050202760935917`*^9, 
   3.705020362495323*^9}, {3.705020428404941*^9, 3.705020540953555*^9}, 
   3.70502059394281*^9, {3.705020664712771*^9, 3.7050206648953867`*^9}, {
   3.705020757625041*^9, 3.705020777736761*^9}, {3.705020814203286*^9, 
   3.7050208666483593`*^9}, {3.705636572578662*^9, 3.705636590061873*^9}, {
   3.724891443737162*^9, 3.7248914446525803`*^9}, {3.724891475680118*^9, 
   3.7248915648906*^9}, {3.724891732956417*^9, 3.724891734795376*^9}, {
   3.724891787324588*^9, 3.72489179796481*^9}, {3.724891863504882*^9, 
   3.72489190004949*^9}, {3.728150826908856*^9, 
   3.728150826920247*^9}},ExpressionUUID->"48a16208-431e-4eb1-a937-\
6a9ca25be902"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], 
  ";"}]], "InputSection",ExpressionUUID->"76ae058e-c3f5-44ae-bcbf-\
e48e6952aa3a"]
}, Open  ]],

Cell["", "SectionSeparator",ExpressionUUID->"08ea357f-c99d-4856-810b-\
cfd2abf887ff"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"PacletBundle", "//", "Options"}]], "Input",
 CellChangeTimes->{{3.7110270446103067`*^9, 
  3.711027046879527*^9}},ExpressionUUID->"78e06ca4-6237-450e-a4c2-\
7b3cf79e5ccf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\<\"RemovePaths\"\>", "\[Rule]", 
    RowBox[{"{", "}"}]}], ",", 
   RowBox[{"\<\"RemovePatterns\"\>", "\[Rule]", "\<\".DS_Store\"\>"}], ",", 
   RowBox[{"\<\"BuildRoot\"\>", "\[RuleDelayed]", 
    "BTools`Private`$PacletBuildRoot"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7110270471616287`*^9},ExpressionUUID->"0ee9689d-b8a1-4938-a4ed-\
0e4d8f12de5c"]
}, Open  ]]
},
WindowSize->{808, 755},
WindowMargins->{{Automatic, 226}, {Automatic, 1}},
FrontEndVersion->"11.2 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
10, 2017)",
StyleDefinitions->FrontEnd`FileName[{"BTools"}, "CodePackage.nb", 
  CharacterEncoding -> "UTF-8"]
]

