Notebook[{

Cell[CellGroupData[{
Cell["FrontEnd Menus", "CodeSection",
 CellChangeTimes->{{3.703512950083434*^9, 3.703512955369205*^9}, 
   3.703513011208558*^9},ExpressionUUID->"1a767712-f90d-4679-863b-\
6c2934d3babe"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FEMenus", "::", "usage"}], "=", "\"\<Gets menus by names\>\""}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.6852122960781937`*^9, 3.685212344905334*^9}, {
  3.690732557748056*^9, 3.690732590734581*^9}, {3.691154594979775*^9, 
  3.691154609826427*^9}, {3.6911550051743393`*^9, 3.691155013611163*^9}, {
  3.691156486346375*^9, 3.691156524359187*^9}, {3.691160648494729*^9, 
  3.691160656579445*^9}, {3.691160687140791*^9, 3.691160725171051*^9}, {
  3.691164327389447*^9, 3.6911643511246223`*^9}, {3.691174592888832*^9, 
  3.6911746085095997`*^9}, {3.691175978027115*^9, 3.691176065568201*^9}, {
  3.691197828841567*^9, 3.6911978976775017`*^9}, {3.6911979480269117`*^9, 
  3.691197948865972*^9}},ExpressionUUID->"fcd6b3ab-76bf-4b4a-a65e-\
244acf54371c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuFind", "::", "usage"}], "=", 
   "\"\<Finds a menu in a menu structure\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuChildren", "::", "usage"}], "=", 
   "\"\<Finds a menu's children in a menu structure\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuParent", "::", "usage"}], "=", 
   "\"\<Finds a menu's parent in a menu structure\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuDrop", "::", "usage"}], "=", 
   "\"\<Drops a menu from a menu structure\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuTake", "::", "usage"}], "=", 
   "\"\<Takes a menus from a menu structure\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuReplace", "::", "usage"}], "=", 
   "\"\<Replaces a menu in a menu structure\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuInsert", "::", "usage"}], "=", 
   "\"\<Inserts a menu at a position\>\""}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6852122960781937`*^9, 3.685212344905334*^9}, {
  3.690732557748056*^9, 3.690732590734581*^9}, {3.691154594979775*^9, 
  3.691154609826427*^9}, {3.6911550051743393`*^9, 3.691155013611163*^9}, {
  3.691156486346375*^9, 3.691156524359187*^9}, {3.691160648494729*^9, 
  3.691160656579445*^9}, {3.691160687140791*^9, 3.691160725171051*^9}, {
  3.691164327389447*^9, 3.6911643511246223`*^9}, {3.691174592888832*^9, 
  3.6911746085095997`*^9}, {3.691175978027115*^9, 3.691176039224275*^9}, {
  3.691176499495531*^9, 3.691176526435788*^9}, {3.691177666422162*^9, 
  3.691177675876534*^9}, {3.691198432635301*^9, 
  3.691198443492526*^9}},ExpressionUUID->"9fa8e233-60a5-4688-89eb-\
2579cce107cc"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuAdd", "::", "usage"}], "=", 
   "\"\<Adds a set of options chunk to the front end menus\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuRemove", "::", "usage"}], "=", 
   "\"\<Removes entries from menus\>\""}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6852122960781937`*^9, 3.685212344905334*^9}, {
   3.690732557748056*^9, 3.690732590734581*^9}, {3.691154594979775*^9, 
   3.691154609826427*^9}, {3.6911550051743393`*^9, 3.691155013611163*^9}, {
   3.691156486346375*^9, 3.691156524359187*^9}, {3.691160648494729*^9, 
   3.691160656579445*^9}, {3.691160687140791*^9, 3.691160725171051*^9}, {
   3.691164327389447*^9, 3.6911643511246223`*^9}, {3.691174592888832*^9, 
   3.6911746085095997`*^9}, {3.691175978027115*^9, 3.691176039224275*^9}, 
   3.691176499495531*^9, {3.6911985092577267`*^9, 
   3.691198510005999*^9}},ExpressionUUID->"7836fe5a-4d03-4e3c-909b-\
571b3a778859"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuGraph", "::", "usage"}], "=", 
   "\"\<Creates a graph of the menu structure\>\""}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.691176400144743*^9, 
  3.691176415071362*^9}},ExpressionUUID->"bd760fb7-85ce-4a45-804f-\
6341b62e4caf"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"$FrontEndMenu", "::", "usage"}], "=", 
   "\"\<The displayed front end menu\>\""}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.6911771125001307`*^9, 
  3.691177127226549*^9}},ExpressionUUID->"d1709391-ff46-45e0-b4d4-\
f3fd133f2215"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$FEMenuRoot", "::", "usage"}], "=", "\"\<The root menu\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuReset", "::", "usage"}], "=", "\"\<Resets the menus\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuSet", "::", "usage"}], "=", "\"\<Sets a menu\>\""}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6852122960781937`*^9, 3.685212344905334*^9}, {
  3.690732557748056*^9, 3.690732590734581*^9}, {3.691154594979775*^9, 
  3.691154609826427*^9}, {3.6911550051743393`*^9, 3.691155013611163*^9}, {
  3.691156486346375*^9, 3.691156524359187*^9}, {3.691160648494729*^9, 
  3.691160656579445*^9}, {3.691160687140791*^9, 3.691160725171051*^9}, {
  3.691164327389447*^9, 3.6911643511246223`*^9}, {3.691174592888832*^9, 
  3.6911746085095997`*^9}, {3.691175978027115*^9, 3.691176033896194*^9}, {
  3.691176077578937*^9, 3.691176085598599*^9}, {3.691177100983898*^9, 
  3.691177102746627*^9}},ExpressionUUID->"b2f649d8-ed31-4f7d-8450-\
2c63f97207e4"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuGet", "::", "usage"}], "=", 
   "\"\<Uses the menu list get function. Might work on a standard \
menu.\>\""}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.6852122960781937`*^9, 3.685212344905334*^9}, {
  3.690732557748056*^9, 3.690732590734581*^9}, {3.691154594979775*^9, 
  3.691154609826427*^9}, {3.6911550051743393`*^9, 3.691155013611163*^9}, {
  3.691156486346375*^9, 3.691156524359187*^9}, {3.691160648494729*^9, 
  3.691160656579445*^9}, {3.691160687140791*^9, 3.691160725171051*^9}, {
  3.691164327389447*^9, 3.6911643511246223`*^9}, {3.691174592888832*^9, 
  3.6911746085095997`*^9}, {3.691175978027115*^9, 
  3.691176033896194*^9}},ExpressionUUID->"8c871349-7549-45c2-a463-\
e4da237a1a91"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], 
  ";"}]], "InputSection",ExpressionUUID->"de32a090-590d-4c8c-bcc5-\
c8a15d602638"],

Cell[CellGroupData[{

Cell["Menu resources", "CodeSubsubsection",
 CellChangeTimes->{{3.6911765702192087`*^9, 
  3.6911765930594873`*^9}},ExpressionUUID->"e9bb0706-ed76-4cbb-add2-\
ff8db53541e3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$MenuSetupTR", "=", "\n", "\t", 
   RowBox[{"FileNameJoin", "@", 
    RowBox[{"{", "\n", "\t\t", 
     RowBox[{
     "$InstallationDirectory", ",", "\n", "\t\t", "\"\<SystemFiles\>\"", ",", 
      "\"\<FrontEnd\>\"", ",", "\"\<TextResources\>\"", ",", "\n", "\t\t", 
      "\"\<Macintosh\>\"", ",", "\"\<MenuSetup.tr\>\""}], "}"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"$MenuStringsTR", "=", "\n", "\t", 
   RowBox[{"FileNameJoin", "@", 
    RowBox[{"{", 
     RowBox[{
     "$InstallationDirectory", ",", "\n", "\t\t", "\"\<SystemFiles\>\"", ",", 
      "\"\<FrontEnd\>\"", ",", "\"\<TextResources\>\"", ",", "\n", "\t\t", 
      "\"\<MenuStrings.tr\>\""}], "}"}]}]}], ";"}]}], "CodeInput",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAGIQfabIcp5fw2tHtYdBC0E0/8z1ef5Aetm/qcUgOiqp
pgJE6/TeqQLRMWkmnSDao0a1G0SbaHosBNF6Gk1LQPQstQObQfR137lbQLSb
8NsnIHpB1efnYP4lfbEAIL1OglkLRG/ebKMPoqU28dqCaCUTjzIQ7STM1QGi
2a6p6gYCaYZ/DgYgetV/5t9BQNo2WARMC8vY/QfRDNsVGIKBdFP8c2YQvWim
DBeITgq9yw+ivb3Wi4Fon/peKRBdscVJBkQHce8yA9Ehh9fZgGi/vzedQfQs
Dg83EL1MK7E0BKT+98tKEB3jeaERRF+QedICoo+87b8IossOn7wMohu+fXwG
lt9s9AJEO6+e9hFE7/jh9AlE97sueBoKpHXF2l+AaAAfbLtl
  
  "],ExpressionUUID->"464acdde-10f2-4745-be7a-acf7cb134be2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$FEMenuRoot", "=", "\n", "\t", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"$Context", "=", "\"\<System`\>\""}], ",", 
       RowBox[{"$ContextPath", "=", 
        RowBox[{"Append", "[", 
         RowBox[{"$ContextPath", ",", "\"\<FrontEnd`\>\""}], "]"}]}]}], "}"}],
      ",", "\n", "\t\t", 
     RowBox[{"Quiet", "[", 
      RowBox[{
       RowBox[{"Import", "@", "$MenuSetupTR"}], ",", 
       RowBox[{"General", "::", "shdw"}]}], "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"$menuStrings", "=", "\n", "\t", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"$Context", "=", "\"\<System`\>\""}], ",", 
       RowBox[{"$ContextPath", "=", 
        RowBox[{"Append", "[", 
         RowBox[{"$ContextPath", ",", "\"\<FrontEnd`\>\""}], "]"}]}]}], "}"}],
      ",", "\n", "\t\t", 
     RowBox[{"Quiet", "[", 
      RowBox[{
       RowBox[{"Import", "@", "$MenuStringsTR"}], ",", 
       RowBox[{"General", "::", "shdw"}]}], "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6911485297952633`*^9, 3.691148554589984*^9}, {
   3.691150197487434*^9, 3.691150236687335*^9}, {3.691150275887006*^9, 
   3.691150294892233*^9}, {3.691150409637495*^9, 3.691150425171421*^9}, {
   3.6911506022550297`*^9, 3.6911506280674047`*^9}, {3.691150750004712*^9, 
   3.691150756915752*^9}, {3.6911511434086027`*^9, 3.691151167608719*^9}, {
   3.691151537494418*^9, 3.6911516960967627`*^9}, {3.691151737896936*^9, 
   3.691151848427991*^9}, {3.691152306256364*^9, 3.691152448314851*^9}, {
   3.691153769182376*^9, 3.691153794031006*^9}, {3.691157464124959*^9, 
   3.691157464635161*^9}, {3.691157497940927*^9, 3.691157505022339*^9}, {
   3.6911575352304087`*^9, 3.691157584893754*^9}, {3.6911576309166727`*^9, 
   3.691157685477819*^9}, {3.691157716421789*^9, 3.69115773008453*^9}, {
   3.691157941813882*^9, 3.691157989461344*^9}, {3.691158046812171*^9, 
   3.69115806625105*^9}, {3.691160491036456*^9, 3.691160527311947*^9}, {
   3.691160590508955*^9, 3.691160615128517*^9}, {3.691161228497774*^9, 
   3.69116124630511*^9}, {3.6911613995613403`*^9, 3.69116140958445*^9}, {
   3.691161484708406*^9, 3.691161490092861*^9}, {3.691163437008491*^9, 
   3.691163460221457*^9}, 3.6911764464904337`*^9, {3.6911979610429573`*^9, 
   3.691197977661786*^9}},ExpressionUUID->"4ea0e66a-01ff-46ff-98be-\
582405b7a78d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$menuNames", "=", "\n", "\t", 
   RowBox[{"Cases", "[", 
    RowBox[{"$FEMenuRoot", ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"MenuItem", "[", 
         RowBox[{"__", ",", 
          RowBox[{"name_String", "?", 
           RowBox[{"(", 
            RowBox[{"StringContainsQ", "[", "\"\<Dialog\>\"", "]"}], 
            ")"}]}]}], "]"}], "|", 
        RowBox[{"Menu", "[", 
         RowBox[{"name_", ",", "___"}], "]"}]}], ")"}], "\[RuleDelayed]", 
      "name"}], ",", "\[Infinity]"}], "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.6911485297952633`*^9, 3.691148554589984*^9}, {
  3.691150197487434*^9, 3.691150236687335*^9}, {3.691150275887006*^9, 
  3.691150294892233*^9}, {3.691150409637495*^9, 3.691150425171421*^9}, {
  3.6911506022550297`*^9, 3.6911506280674047`*^9}, {3.691150750004712*^9, 
  3.691150756915752*^9}, {3.6911511434086027`*^9, 3.691151167608719*^9}, {
  3.691151537494418*^9, 3.6911516960967627`*^9}, {3.691151737896936*^9, 
  3.691151848427991*^9}, {3.691152306256364*^9, 3.691152448314851*^9}, {
  3.691153769182376*^9, 3.691153804785665*^9}, {3.691176378875677*^9, 
  3.6911763837519827`*^9}, {3.691176445188957*^9, 
  3.691176453200053*^9}},ExpressionUUID->"e2e510c7-d532-400c-b45c-\
049d407e6135"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$FEMenus", "=", "\n", "\t", 
   RowBox[{"{", "\n", "\t\t", 
    RowBox[{
    "\"\<Open\>\"", ",", "\n", "\t", "\t", "\"\<BackgroundDialog\>\""}], "\n",
     "\t\t", "}"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$FEMenuLists", "=", "\[IndentingNewLine]", 
   RowBox[{"{", "\n", "\t\t", 
    RowBox[{
    "\"\<MenuListBoxFormFormatTypes\>\"", ",", "\n", "\t\t", 
     "\"\<MenuListCellEvaluators\>\"", ",", "\n", "\t\t", 
     "\"\<MenuListCellTags\>\"", ",", "\n", "\t\t", 
     "\"\<MenuListCommonDefaultFormatTypesInput\>\"", ",", "\n", "\t\t", 
     "\"\<MenuListCommonDefaultFormatTypesInputInline\>\"", ",", "\n", 
     "\t\t", "\"\<MenuListCommonDefaultFormatTypesOutput\>\"", ",", "\n", 
     "\t\t", "\"\<MenuListCommonDefaultFormatTypesOutputInline\>\"", ",", 
     "\n", "\t\t", "\"\<MenuListCommonDefaultFormatTypesText\>\"", ",", "\n", 
     "\t\t", "\"\<MenuListCommonDefaultFormatTypesTextInline\>\"", ",", "\n", 
     "\t\t", "\"\<MenuListConvertFormatTypes\>\"", ",", 
     "\"\<MenuListDisplayAsFormatTypes\>\"", ",", "\n", "\t\t", 
     "\"\<MenuListExportClipboardSpecial\>\"", ",", "\n", "\t\t", 
     "\"\<MenuListFonts\>\"", ",", "\n", "\t\t", 
     "\"\<MenuListFontSubstitutions\>\"", ",", "\n", "\t\t", 
     "\"\<MenuListGlobalEvaluators\>\"", ",", "\n", "\t\t", 
     "\"\<MenuListHelpWindows\>\"", ",", "\n", "\t\t", 
     "\"\<MenuListNotebookEvaluators\>\"", ",", "\n", "\t\t", 
     "\"\<MenuListNotebooksMenu\>\"", ",", "\n", "\t\t", 
     "\"\<MenuListPackageWindows\>\"", ",", "\n", "\t\t", 
     "\"\<MenuListPalettesMenu\>\"", ",", "\n", "\t\t", 
     "\"\<MenuListPaletteWindows\>\"", ",", "\n", "\t\t", 
     "\"\<MenuListPlayerWindows\>\"", ",", "\n", "\t\t", 
     "\"\<MenuListPlugInCommands\>\"", ",", "\n", "\t\t", 
     "\"\<MenuListPrintingStyleEnvironments\>\"", ",", "\n", "\t\t", 
     "\"\<MenuListQuitEvaluators\>\"", ",", "\n", "\t\t", 
     "\"\<MenuListRelatedFilesMenu\>\"", ",", "\n", "\t\t", 
     "\"\<MenuListSaveClipboardSpecial\>\"", ",", "\n", "\t\t", 
     "\"\<MenuListScreenStyleEnvironments\>\"", ",", "\n", "\t\t", 
     "\"\<MenuListStartEvaluators\>\"", ",", "\n", "\t\t", 
     "\"\<MenuListStyleDefinitions\>\"", ",", "\n", "\t\t", 
     "\"\<MenuListStyles\>\"", ",", "\n", "\t\t", 
     "\"\<MenuListStylesheetWindows\>\"", ",", "\n", "\t\t", 
     "\"\<MenuListTextWindows\>\"", ",", "\n", "\t\t", 
     "\"\<MenuListWindows\>\""}], "}"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.685212188353066*^9, 3.685212221973096*^9}, {
   3.685212348699581*^9, 3.685212349641021*^9}, {3.686657257097193*^9, 
   3.686657264719397*^9}, {3.686657327578783*^9, 3.686657328761376*^9}, {
   3.690732461148662*^9, 3.690732497530295*^9}, {3.691144893237125*^9, 
   3.691144946314096*^9}, {3.691145044409031*^9, 3.691145050633309*^9}, {
   3.691149860721084*^9, 3.691149861573957*^9}, 3.6911511915855103`*^9, {
   3.691153881018115*^9, 3.691153888462846*^9}, {3.691154522137232*^9, 
   3.6911545235608473`*^9}},ExpressionUUID->"afc19387-9f2f-41f9-b3e7-\
23fcc346bcc2"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FEMenus", "[", 
    RowBox[{"pat_:", "\"\<\>\""}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Join", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Sort", "@", "\n", "\t\t\t", 
      RowBox[{"Select", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"Select", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{"$FEMenus", ",", "$menuNames"}], "]"}], ",", 
          RowBox[{"StringContainsQ", "[", "pat", "]"}]}], "]"}], ",", "\n", 
        "\t\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"StringContainsQ", "[", 
           RowBox[{"#", ",", "WordCharacter"}], "]"}], "&&", 
          RowBox[{"!", 
           RowBox[{"StringContainsQ", "[", 
            RowBox[{"#", ",", "WhitespaceCharacter"}], "]"}]}]}], "&"}]}], 
       "\n", "\t\t\t\t", "]"}]}], ",", "\n", "\t\t", 
     RowBox[{"Select", "[", 
      RowBox[{"$FEMenuLists", ",", 
       RowBox[{"StringContainsQ", "[", "pat", "]"}]}], "]"}]}], "\n", "\t\t", 
    "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.69115375969024*^9, 3.691153762184732*^9}, {
  3.691154524943413*^9, 3.691154564435742*^9}, {3.691154616443956*^9, 
  3.6911546205147448`*^9}, {3.6911546661396437`*^9, 3.691154690143653*^9}, {
  3.691154767502437*^9, 
  3.6911548649662657`*^9}},ExpressionUUID->"5406ca27-a1ea-4084-b36e-\
9068432a5d4d"]
}, Closed]],

Cell[CellGroupData[{

Cell["$FrontEndMenu", "CodeSubsubsection",
 CellChangeTimes->{{3.691177140002496*^9, 
  3.691177143177494*^9}},ExpressionUUID->"6cd05a66-258d-4eaf-8a54-\
2e0aa7e6589d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$feStoredMenu", "=", "Automatic"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FrontEndMenu", ":=", 
   RowBox[{"Replace", "[", 
    RowBox[{"$feStoredMenu", ",", 
     RowBox[{"Automatic", "\[Rule]", "$FEMenuRoot"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FrontEndMenu", "/:", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{"Set", "[", 
     RowBox[{"$FrontEndMenu", ",", 
      RowBox[{"m", ":", 
       RowBox[{"_Menu", "|", "_List", "|", "None"}]}]}], "]"}], "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"r", "=", 
       RowBox[{"FEMenuSet", "[", "m", "]"}]}], "}"}], ",", "\n", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"MatchQ", "[", 
        RowBox[{"r", ",", "_Menu"}], "]"}], ",", 
       RowBox[{"$feStoredMenu", "=", "r"}]}], "]"}]}], "\n", "\t\t", "]"}]}], 
  " ", ";"}], "\n", 
 RowBox[{
  RowBox[{"$FrontEndMenu", "/:", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{"Set", "[", 
     RowBox[{"$FrontEndMenu", ",", "Automatic"}], "]"}], "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"$feStoredMenu", "=", "Automatic"}], ";", 
     RowBox[{"FEMenuReset", "[", "]"}]}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$FrontEndMenu", "/:", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{"Unset", "[", "$FrontEndMenu", "]"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"$FrontEndMenu", "=", "Automatic"}], ";"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$FrontEndMenu", "/:", 
   RowBox[{"HoldPattern", "[", 
    RowBox[{"$FrontEndMenu", "[", "key_", "]"}], "]"}], ":=", 
   RowBox[{"FEMenuTake", "[", 
    RowBox[{"$FrontEndMenu", ",", "key"}], "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6911771454990396`*^9, 3.6911772078427267`*^9}, {
   3.69117723887361*^9, 3.6911772498867083`*^9}, {3.691177294363497*^9, 
   3.69117742074865*^9}, {3.691177563624023*^9, 3.691177632307226*^9}, {
   3.691178112672819*^9, 3.691178112895274*^9}, {3.69117822496731*^9, 
   3.691178235902329*^9}, {3.691201248818872*^9, 3.691201277562258*^9}, 
   3.691201580597271*^9, {3.691437661244935*^9, 
   3.691437661928985*^9}},ExpressionUUID->"43e62a99-cd77-401c-9e14-\
ef57c4743f0c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Menu graphs", "CodeSubsubsection",
 CellChangeTimes->{{3.691176577900622*^9, 
  3.691176594482225*^9}},ExpressionUUID->"8bc867e4-6188-43be-bc32-\
0b7eeae19f6a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"menuRules", "[", 
    RowBox[{"Menu", "[", 
     RowBox[{"name_", ",", "e_"}], "]"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Menu", "[", "name", "]"}], "\[Rule]", 
    RowBox[{"menuRules", "@", "e"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"menuRules", "[", 
    RowBox[{"ignore", ":", 
     RowBox[{"(", 
      RowBox[{
      "_String", "|", "_MenuItem", "|", "Delimiter", "|", "_AlternateItems"}],
       ")"}]}], "]"}], ":=", "ignore"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetAttributes", "[", 
   RowBox[{"menuRules", ",", "Listable"}], "]"}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6911485297952633`*^9, 3.691148554589984*^9}, {
  3.691150197487434*^9, 3.691150236687335*^9}, {3.691150275887006*^9, 
  3.691150294892233*^9}, {3.691150409637495*^9, 3.691150425171421*^9}, {
  3.6911506022550297`*^9, 3.6911506280674047`*^9}, {3.691150750004712*^9, 
  3.691150756915752*^9}, {3.6911511434086027`*^9, 3.691151167608719*^9}, {
  3.691151537494418*^9, 3.6911516960967627`*^9}, {3.691151737896936*^9, 
  3.691151848427991*^9}, {3.691152306256364*^9, 3.691152448314851*^9}, {
  3.691153769182376*^9, 
  3.691153811442765*^9}},ExpressionUUID->"1bcaab10-36ff-4dd1-bd1a-\
68a0e5ce8295"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"menuPart", "[", 
    RowBox[{"menu_", ",", "name_"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"FirstCase", "[", 
    RowBox[{"menu", ",", 
     RowBox[{"Menu", "[", 
      RowBox[{"name", ",", "_"}], "]"}], ",", "None", ",", "\[Infinity]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"menuPart", "[", 
    RowBox[{"menu_", ",", "name1_", ",", "names__"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Fold", "[", 
    RowBox[{"menuPart", ",", "menu", ",", 
     RowBox[{"{", 
      RowBox[{"name1", ",", "names"}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"menuEdges", "[", "menu_", "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"ReplaceAll", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"Cases", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"DeleteCases", "[", 
          RowBox[{
           RowBox[{"menuRules", "@", "menu"}], ",", "\[IndentingNewLine]", 
           RowBox[{"Except", "[", 
            RowBox[{"_Menu", "|", "_MenuItem", "|", 
             RowBox[{"Rule", "[", 
              RowBox[{"_Menu", ",", "_"}], "]"}], "|", "_List", "|", 
             "_String", "|", "_AlternateItems"}], "]"}], ",", 
           "\[IndentingNewLine]", "\[Infinity]"}], "]"}], "//.", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Rule", "[", 
             RowBox[{"m_", ",", 
              RowBox[{"expr", ":", 
               RowBox[{"Except", "[", "_Rule", "]"}]}]}], "]"}], 
            "\[RuleDelayed]", 
            RowBox[{"Thread", "[", 
             RowBox[{"m", "->", "expr"}], "]"}]}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"Rule", "[", 
             RowBox[{"m_Menu", ",", 
              RowBox[{"Rule", "[", 
               RowBox[{"subm_Menu", ",", "e_"}], "]"}]}], "]"}], 
            "\[RuleDelayed]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"m", "\[Rule]", "subm"}], ",", 
              RowBox[{"subm", "\[Rule]", "e"}]}], "}"}]}]}], 
          "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", "_Rule",
         ",", "\[IndentingNewLine]", "\[Infinity]"}], "]"}], "//", 
      "Flatten"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Rule", "\[Rule]", "DirectedEdge"}]}], "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6911485297952633`*^9, 3.691148554589984*^9}, {
   3.691150197487434*^9, 3.691150236687335*^9}, {3.691150275887006*^9, 
   3.691150294892233*^9}, {3.691150409637495*^9, 3.691150425171421*^9}, {
   3.6911506022550297`*^9, 3.6911506280674047`*^9}, {3.691150750004712*^9, 
   3.691150756915752*^9}, {3.6911511434086027`*^9, 3.691151167608719*^9}, {
   3.691151537494418*^9, 3.6911516960967627`*^9}, {3.691151737896936*^9, 
   3.691151848427991*^9}, {3.691152306256364*^9, 3.691152448314851*^9}, {
   3.691153769182376*^9, 3.691153811442765*^9}, {3.6911763895487967`*^9, 
   3.6911763912103443`*^9}, 
   3.691176599596932*^9},ExpressionUUID->"d0a1699a-e30f-4203-9654-\
54c1382ad588"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuGraph", "[", 
    RowBox[{"menu_:", "Automatic"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"edges", "=", 
       RowBox[{"menuEdges", "@", 
        RowBox[{"Replace", "[", 
         RowBox[{"menu", ",", 
          RowBox[{"Automatic", "\[Rule]", "$FrontEndMenu"}]}], "]"}]}]}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Graph", "[", "\[IndentingNewLine]", 
      RowBox[{"edges", ",", "\[IndentingNewLine]", 
       RowBox[{"VertexShape", "\[Rule]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"Menu", "[", "n_", "]"}], ":>", 
           RowBox[{"Graphics", "[", 
            RowBox[{"Tooltip", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Hue", "[", 
                 RowBox[{".1", ",", ".8", ",", "1"}], "]"}], ",", 
                RowBox[{"Disk", "[", "]"}]}], "}"}], ",", "n"}], "]"}], 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"m_MenuItem", ":>", 
           RowBox[{"Graphics", "[", 
            RowBox[{"Tooltip", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Hue", "[", 
                 RowBox[{".6", ",", ".8", ",", "1"}], "]"}], ",", 
                RowBox[{"Disk", "[", "]"}]}], "}"}], ",", "m"}], "]"}], 
            "]"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"e_AlternateItems", ":>", 
           RowBox[{"Graphics", "[", 
            RowBox[{"Tooltip", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Hue", "[", 
                 RowBox[{".4", ",", ".8", ",", "1"}], "]"}], ",", 
                RowBox[{"Disk", "[", "]"}]}], "}"}], ",", "e"}], "]"}], 
            "]"}]}]}], "\[IndentingNewLine]", "}"}]}]}], 
      "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.6911485297952633`*^9, 3.691148554589984*^9}, {
   3.691150197487434*^9, 3.691150236687335*^9}, {3.691150275887006*^9, 
   3.691150294892233*^9}, {3.691150409637495*^9, 3.691150425171421*^9}, {
   3.6911506022550297`*^9, 3.6911506280674047`*^9}, {3.691150750004712*^9, 
   3.691150756915752*^9}, {3.6911511434086027`*^9, 3.691151167608719*^9}, {
   3.691151537494418*^9, 3.6911516960967627`*^9}, {3.691151737896936*^9, 
   3.691151848427991*^9}, {3.691152306256364*^9, 3.691152448314851*^9}, {
   3.691153769182376*^9, 3.691153811442765*^9}, {3.6911763895487967`*^9, 
   3.6911763912103443`*^9}, 3.691176599596932*^9, {3.691177836818843*^9, 
   3.691177856872993*^9}, 
   3.691178202694833*^9},ExpressionUUID->"a91a8193-e9f3-428e-be2f-\
4b035cb85f91"]
}, Closed]],

Cell[CellGroupData[{

Cell["Menu finding", "CodeSubsubsection",
 CellChangeTimes->{{3.691176621491126*^9, 3.691176627121917*^9}, {
  3.691200118241542*^9, 3.6912001401901817`*^9}, {3.691323959621216*^9, 
  3.691323960617655*^9}},ExpressionUUID->"7471af0a-e4c6-4869-bf48-\
e74e08bc2239"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuFind", "[", 
    RowBox[{"structure_Menu", ",", 
     RowBox[{
      RowBox[{"menu_:", "_String"}], "|", "_Alternatives", "|", 
      "_PatternTest"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"FEMenuFind", "[", 
    RowBox[{"menu", ",", "structure"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuFind", "[", 
    RowBox[{
     RowBox[{"menu", ":", 
      RowBox[{"_String", "|", "_Alternatives", "|", "_PatternTest"}]}], ",", 
     RowBox[{"structure_:", "Automatic"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"FirstCase", "[", 
    RowBox[{
     RowBox[{"Replace", "[", 
      RowBox[{"structure", ",", 
       RowBox[{"Automatic", ":>", "$FrontEndMenu"}]}], "]"}], ",", "\n", 
     "\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Menu", "|", "MenuItem"}], ")"}], "[", 
       RowBox[{"menu", ",", "___"}], "]"}], "|", 
      RowBox[{"MenuItem", "[", 
       RowBox[{"__", ",", "menu"}], "]"}]}], ",", "\n", "\t\t", "None", ",", 
     "\[Infinity]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuFind", "[", 
    RowBox[{
     RowBox[{"m", ":", 
      RowBox[{"(", 
       RowBox[{"_Menu", "|", "_MenuItem"}], ")"}]}], ",", 
     RowBox[{"structure_:", "Automatic"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"FirstCase", "[", 
    RowBox[{
     RowBox[{"Replace", "[", 
      RowBox[{"structure", ",", 
       RowBox[{"Automatic", ":>", "$FrontEndMenu"}]}], "]"}], ",", "m", ",", 
     "None", ",", "\[Infinity]"}], "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.685212177666068*^9, 3.685212242012533*^9}, {
   3.6852136075457153`*^9, 3.685213616200076*^9}, {3.686657310339933*^9, 
   3.686657321012219*^9}, {3.6907324496222553`*^9, 3.690732452931162*^9}, {
   3.6911512054863663`*^9, 3.691151232725165*^9}, {3.691154919247011*^9, 
   3.69115492019182*^9}, {3.691154965952899*^9, 3.691154995723712*^9}, {
   3.6911559557748137`*^9, 3.6911560012020073`*^9}, {3.6911563041181498`*^9, 
   3.691156332499732*^9}, {3.691156384827495*^9, 3.691156473959626*^9}, {
   3.691156546830552*^9, 3.6911565641358557`*^9}, {3.691156601033854*^9, 
   3.691156818171328*^9}, {3.69115684859662*^9, 3.691156878658984*^9}, 
   3.691157005162943*^9, {3.691157153062092*^9, 3.691157179274995*^9}, {
   3.691176693655466*^9, 3.691176694492111*^9}, 3.691177793504488*^9, 
   3.691177824571512*^9, {3.691323986490498*^9, 
   3.691324027060623*^9}},ExpressionUUID->"99d80267-371d-49b1-b903-\
b2420086217b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuParent", "[", 
    RowBox[{
     RowBox[{"menu", ":", 
      RowBox[{"_String", "|", "_Alternatives", "|", "_PatternTest"}]}], ",", 
     RowBox[{"structure_:", "Automatic"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"FirstCase", "[", 
    RowBox[{
     RowBox[{"Replace", "[", 
      RowBox[{"structure", ",", 
       RowBox[{"Automatic", ":>", "$FrontEndMenu"}]}], "]"}], ",", "\n", 
     "\t\t", 
     RowBox[{
      RowBox[{"Menu", "[", 
       RowBox[{"___", ",", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Menu", "|", "MenuItem"}], ")"}], "[", 
          RowBox[{"menu", ",", "___"}], "]"}], "|", 
         RowBox[{"MenuItem", "[", 
          RowBox[{"__", ",", "menu"}], "]"}]}], ",", "___"}], "]"}], "|", 
      "\n", "\t\t", 
      RowBox[{"Menu", "[", 
       RowBox[{"___", ",", 
        RowBox[{"{", 
         RowBox[{"___", ",", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Menu", "|", "MenuItem"}], ")"}], "[", 
            RowBox[{"menu", ",", "___"}], "]"}], "|", 
           RowBox[{"MenuItem", "[", 
            RowBox[{"__", ",", "menu"}], "]"}]}], ",", "___"}], "}"}], ",", 
        "___"}], "]"}]}], ",", "\n", "\t\t", "None", ",", "\[Infinity]"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuParent", "[", 
    RowBox[{
     RowBox[{"m", ":", 
      RowBox[{"(", 
       RowBox[{"_Menu", "|", "_MenuItem"}], ")"}]}], ",", 
     RowBox[{"structure_:", "$FrontEndMenu"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"FirstCase", "[", 
    RowBox[{
     RowBox[{"Replace", "[", 
      RowBox[{"structure", ",", 
       RowBox[{"Automatic", ":>", "$FrontEndMenu"}]}], "]"}], ",", "\n", 
     "\t\t", 
     RowBox[{
      RowBox[{"Menu", "[", 
       RowBox[{"___", ",", "m", ",", "___"}], "]"}], "|", 
      RowBox[{"Menu", "[", 
       RowBox[{"___", ",", 
        RowBox[{"{", 
         RowBox[{"___", ",", "m", ",", "___"}], "}"}], ",", "___"}], "]"}]}], 
     ",", "\n", "\t\t", "None", ",", "\[Infinity]"}], "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.685212177666068*^9, 3.685212242012533*^9}, {
  3.6852136075457153`*^9, 3.685213616200076*^9}, {3.686657310339933*^9, 
  3.686657321012219*^9}, {3.6907324496222553`*^9, 3.690732452931162*^9}, {
  3.6911512054863663`*^9, 3.691151232725165*^9}, {3.691154919247011*^9, 
  3.69115492019182*^9}, {3.691154965952899*^9, 3.691154995723712*^9}, {
  3.6911559557748137`*^9, 3.6911560012020073`*^9}, {3.6911563041181498`*^9, 
  3.691156332499732*^9}, {3.691156384827495*^9, 3.691156473959626*^9}, {
  3.691156546830552*^9, 3.6911565641358557`*^9}, {3.691156601033854*^9, 
  3.691156839665112*^9}, {3.691156928943494*^9, 3.6911569352954884`*^9}, {
  3.6911569704354887`*^9, 3.691157022110318*^9}, {3.691157183788995*^9, 
  3.6911571842526903`*^9}, {3.691176689668172*^9, 3.6911766919379377`*^9}, {
  3.691177790619244*^9, 
  3.691177792776669*^9}},ExpressionUUID->"59c90ab9-147b-4f9f-92d3-\
b4b7800ba056"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuChildren", "[", 
    RowBox[{
     RowBox[{"menu", ":", 
      RowBox[{"_String", "|", "_Alternatives", "|", "_PatternTest"}]}], ",", 
     RowBox[{"structure_:", "Automatic"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"FirstCase", "[", 
    RowBox[{
     RowBox[{"Replace", "[", 
      RowBox[{"structure", ",", 
       RowBox[{"Automatic", ":>", "$FrontEndMenu"}]}], "]"}], ",", "\n", 
     "\t\t", 
     RowBox[{
      RowBox[{"Menu", "[", 
       RowBox[{"menu", ",", "c_", ",", "___"}], "]"}], "\[RuleDelayed]", 
      "c"}], ",", "\n", "\t\t", "None", ",", "\[Infinity]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuChildren", "[", 
    RowBox[{"m_Menu", ",", 
     RowBox[{"structure_:", "Automatic"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "@", "m"}], ">", "1"}], ",", 
     RowBox[{"m", "[", 
      RowBox[{"[", "2", "]"}], "]"}], ",", 
     RowBox[{"FEMenuChildren", "[", 
      RowBox[{
       RowBox[{"First", "@", "m"}], ",", "structure"}], "]"}]}], "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.685212177666068*^9, 3.685212242012533*^9}, {
   3.6852136075457153`*^9, 3.685213616200076*^9}, {3.686657310339933*^9, 
   3.686657321012219*^9}, {3.6907324496222553`*^9, 3.690732452931162*^9}, {
   3.6911512054863663`*^9, 3.691151232725165*^9}, {3.691154919247011*^9, 
   3.69115492019182*^9}, {3.691154965952899*^9, 3.691154995723712*^9}, {
   3.6911559557748137`*^9, 3.6911560012020073`*^9}, {3.6911563041181498`*^9, 
   3.691156332499732*^9}, {3.691156384827495*^9, 3.691156473959626*^9}, {
   3.691156546830552*^9, 3.6911565641358557`*^9}, {3.691156601033854*^9, 
   3.6911568209527082`*^9}, {3.6911571863085823`*^9, 3.691157186867979*^9}, {
   3.691176686105665*^9, 3.69117669903918*^9}, 
   3.691177789681507*^9},ExpressionUUID->"75584a87-4b84-4056-9a6c-\
21a89c323ea9"]
}, Closed]],

Cell[CellGroupData[{

Cell["Menu structural changes", "CodeSubsubsection",
 CellChangeTimes->{{3.69120022312407*^9, 
  3.69120022422749*^9}},ExpressionUUID->"583a6e0c-6c55-4270-a784-\
93a4094a701a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuDrop", "[", 
    RowBox[{"m_List", ",", "structure_"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"DeleteCases", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Replace", "[", 
      RowBox[{"structure", ",", 
       RowBox[{"Automatic", "\[Rule]", "$FrontEndMenu"}]}], "]"}], ",", "\n", 
     "\t\t", 
     RowBox[{"Alternatives", "@@", 
      RowBox[{"FEMenuFind", "/@", "m"}]}], ",", "\[Infinity]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuDrop", "[", 
    RowBox[{"m_", ",", 
     RowBox[{"structure_:", "Automatic"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"FEMenuDrop", "[", 
    RowBox[{
     RowBox[{"{", "m", "}"}], ",", "structure"}], "]"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6911766729461107`*^9, 3.69117678402108*^9}, {
  3.691176837655912*^9, 3.691177013143716*^9}, {3.691177062897078*^9, 
  3.691177077892078*^9}, {3.691177688280798*^9, 3.691177689549099*^9}, {
  3.691177784502631*^9, 
  3.691177787215087*^9}},ExpressionUUID->"db4efdad-defa-43f4-91f3-\
15eb7ecddecf"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuTake", "[", 
    RowBox[{"m_List", ",", 
     RowBox[{"structure_:", "Automatic"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{
    RowBox[{
     RowBox[{"FEMenuFind", "[", 
      RowBox[{"#", ",", "structure"}], "]"}], "&"}], "/@", "m"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuTake", "[", 
    RowBox[{"m_", ",", 
     RowBox[{"structure_:", "Automatic"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"First", "@", 
    RowBox[{"FEMenuTake", "[", 
     RowBox[{
      RowBox[{"{", "m", "}"}], ",", "structure"}], "]"}]}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.6911766729461107`*^9, 3.69117678402108*^9}, {
  3.691176837655912*^9, 3.691177013143716*^9}, {3.691177062897078*^9, 
  3.691177077892078*^9}, {3.691177688280798*^9, 
  3.691177705959138*^9}},ExpressionUUID->"deaaecf6-68f9-46c8-9296-\
ae1580b24e20"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuReplace", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"replacements", ":", 
      RowBox[{"(", "\n", "\t\t", 
       RowBox[{
        RowBox[{"Rule", "[", 
         RowBox[{
          RowBox[{"_Menu", "|", "_MenuItem", "|", "_String"}], ",", 
          RowBox[{"_Menu", "|", "_MenuItem"}]}], "]"}], "|", "\n", "\t\t", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Rule", "[", 
           RowBox[{
            RowBox[{"_Menu", "|", "_MenuItem", "|", "_String"}], ",", 
            RowBox[{"_Menu", "|", "_MenuItem"}]}], "]"}], ".."}], "}"}]}], 
       ")"}]}], ",", "\n", "\t", 
     RowBox[{"structure_:", "Automatic"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"struct", "=", 
       RowBox[{"Replace", "[", 
        RowBox[{"structure", ",", 
         RowBox[{"Automatic", "\[Rule]", "$FrontEndMenu"}]}], "]"}]}], "}"}], 
     ",", "\n", "\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"reps", "=", "\n", "\t\t\t", 
         RowBox[{"Replace", "[", 
          RowBox[{
           RowBox[{"{", "replacements", "}"}], ",", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"s_String", "\[Rule]", "m_"}], ")"}], "\[RuleDelayed]", 
            "\n", "\t\t\t\t\t", 
            RowBox[{"Replace", "[", 
             RowBox[{
              RowBox[{"FEMenuFind", "[", 
               RowBox[{"struct", ",", "s"}], "]"}], ",", 
              RowBox[{"{", "\n", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"None", "\[Rule]", "Nothing"}], ",", "\n", 
                "\t\t\t\t\t\t", 
                RowBox[{"e_", "\[RuleDelayed]", 
                 RowBox[{"(", 
                  RowBox[{"e", "\[Rule]", "m"}], ")"}]}]}], "\n", 
               "\t\t\t\t\t\t", "}"}]}], "]"}]}], ",", "\n", "\t\t\t\t\t", 
           "1"}], "]"}]}], "}"}], ",", "\n", "\t\t\t", 
       RowBox[{"ReplaceAll", "[", 
        RowBox[{"struct", ",", "reps"}], "]"}]}], "\n", "\t\t\t", "]"}]}], 
    "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.6911766729461107`*^9, 3.69117678402108*^9}, {
  3.691176837655912*^9, 3.691177013143716*^9}, {3.691177062897078*^9, 
  3.691177077892078*^9}, {3.691177688280798*^9, 3.691177695667848*^9}, {
  3.691177732031413*^9, 3.691177781846271*^9}, {3.691177890238652*^9, 
  3.691178051205838*^9}, {3.691200571709896*^9, 
  3.6912005825561438`*^9}},ExpressionUUID->"13b32c6d-5298-46d9-8dd2-\
2a63d37d686c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuInsert", "[", "\n", "\t", 
    RowBox[{"menu_", ",", "key_", ",", "\n", "\t", 
     RowBox[{"structure_:", "Automatic"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", "=", 
       RowBox[{"Replace", "[", 
        RowBox[{"structure", ",", 
         RowBox[{"Automatic", "\[Rule]", "$FrontEndMenu"}]}], "]"}]}], "}"}], 
     ",", "\n", "\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"k", "=", "\n", "\t\t\t", 
         RowBox[{"Replace", "[", 
          RowBox[{"key", ",", 
           RowBox[{"{", "\n", "\t\t\t\t", 
            RowBox[{
             RowBox[{"i_Integer", "\[RuleDelayed]", 
              RowBox[{"{", 
               RowBox[{"2", ",", "i"}], "}"}]}], ",", "\n", "\t\t\t\t", 
             RowBox[{
              RowBox[{"{", "i__", "}"}], "\[RuleDelayed]", 
              RowBox[{"{", 
               RowBox[{"2", ",", "i"}], "}"}]}], ",", "\n", "\t\t\t\t", 
             RowBox[{"_", "\[RuleDelayed]", 
              RowBox[{"Prepend", "[", 
               RowBox[{
                RowBox[{"First", "@", 
                 RowBox[{"Position", "[", 
                  RowBox[{"m", ",", 
                   RowBox[{"FEMenuFind", "[", 
                    RowBox[{"m", ",", "key"}], "]"}]}], "]"}]}], ",", "1"}], 
               "]"}]}]}], "\n", "\t\t\t\t", "}"}]}], "]"}]}], "}"}], ",", 
       "\n", "\t\t\t", 
       RowBox[{"Insert", "[", 
        RowBox[{"m", ",", "menu", ",", "k"}], "]"}]}], "\n", "\t\t\t", 
      "]"}]}], "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.691198657409096*^9, 3.691198658307438*^9}, {
   3.691198690238225*^9, 3.691198695285153*^9}, {3.6911991318718224`*^9, 
   3.691199172789864*^9}, {3.691199242054802*^9, 3.691199313715423*^9}, {
   3.6911993671012583`*^9, 3.691199399132279*^9}, {3.6911994331491833`*^9, 
   3.6911995156536207`*^9}, {3.691199602529833*^9, 3.691199644077889*^9}, {
   3.691199676505465*^9, 3.6911996804168177`*^9}, 
   3.691200258675153*^9},ExpressionUUID->"f17c7720-c4f4-4591-9299-\
bd29a0161e0e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Menu editing", "CodeSubsubsection",
 CellChangeTimes->{{3.6911766622409067`*^9, 3.691176666984857*^9}, 
   3.691177035546088*^9},ExpressionUUID->"e3e534c9-2902-4a8b-b3e1-\
478f28516431"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuAdd", "[", 
    RowBox[{
     RowBox[{"menu", ":", 
      RowBox[{"_String", "|", "_Menu", "|", "_MenuItem"}]}], ",", 
     "options_List"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"FrontEndExecute", "[", "\[IndentingNewLine]", 
    RowBox[{"FrontEnd`AddMenuCommands", "[", 
     RowBox[{"menu", ",", "\[IndentingNewLine]", "options"}], 
     "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuAdd", "[", 
    RowBox[{"menu_", ",", 
     RowBox[{"option", ":", 
      RowBox[{"_MenuItem", "|", "_Menu"}]}]}], "]"}], ":=", 
   RowBox[{"FEMenuAdd", "[", 
    RowBox[{"menu", ",", 
     RowBox[{"{", "option", "}"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuAdd", "[", 
    RowBox[{"menu_", ",", 
     RowBox[{"options", ":", 
      RowBox[{"(", 
       RowBox[{"_MenuItem", "|", 
        RowBox[{"_Menu", ".."}]}], ")"}]}]}], "]"}], ":=", 
   RowBox[{"FEMenuAdd", "[", 
    RowBox[{"menu", ",", 
     RowBox[{"{", "options", "}"}]}], "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.685212177666068*^9, 3.685212242012533*^9}, {
   3.6852136075457153`*^9, 3.685213616200076*^9}, {3.686657310339933*^9, 
   3.686657321012219*^9}, {3.6907324496222553`*^9, 3.690732452931162*^9}, {
   3.6911512054863663`*^9, 3.691151232725165*^9}, {3.691154919247011*^9, 
   3.69115492019182*^9}, {3.691154965952899*^9, 3.691154995723712*^9}, {
   3.6911559557748137`*^9, 3.6911560012020073`*^9}, {3.6911563041181498`*^9, 
   3.691156332499732*^9}, {3.691156384827495*^9, 3.691156473959626*^9}, {
   3.691156546830552*^9, 3.6911565641358557`*^9}, {3.691156601033854*^9, 
   3.691156674131151*^9}, {3.691156852754814*^9, 3.6911568534349422`*^9}, {
   3.691158172009005*^9, 3.691158236530064*^9}, {3.691160922523039*^9, 
   3.6911609328205214`*^9}, {3.691174428587373*^9, 3.69117447481101*^9}, {
   3.691174505713665*^9, 3.691174521990903*^9}, {3.691174586006608*^9, 
   3.69117458653474*^9}, {3.6911746211604357`*^9, 3.6911746600296383`*^9}, {
   3.69117473349151*^9, 3.6911747469443073`*^9}, 
   3.691198494828224*^9},ExpressionUUID->"a0c06f5b-1b84-4f60-ac56-\
c115cf367c1f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FEMenuRemove", "[", 
   RowBox[{"menu_", ",", "key_"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"FrontEndExecute", "@", "\n", "\t\t", 
   RowBox[{"FrontEnd`RemoveMenuCommands", "[", 
    RowBox[{
     RowBox[{"ToString", "@", "menu"}], ",", "key"}], "]"}]}]}]], "CodeInput",
 
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQnRdgyvSn5LXjmjQHLhDdUPZxC4hmS2fbBqJ3Pzi1
eG/5a0fJFIWlILrlpXFJc/1rR5Ezc8F0wIT1b/wbXjv2moh/ANEtz5/vCQTS
Kcpse0G0Wt2+QyB6mUb5MRDtdrrCLghI3yhTcwHRj44zZ4Hoc3/7c0H09Sqp
EhDttNWuHiw/OaoDRL+LaOkC0aGiiv0gOsXIZQaILlCfsQ5E87xeC6aPejYE
BwNpz28TokH0nj0Bq0OA9DbHWWtA9KHTk5yjgfTpz5GeIDrimpkviK7aau8P
opXMHMJB9HSZQDDtpbQ0GkSf+dSQAKKLd63PBNFHzOOyQfSFhlvM6UC6eqMp
K4gGAJg8quk=
  "],ExpressionUUID->"11a4011a-b27c-408d-af5e-91ee9d6527e7"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuGet", "[", "menu_", "]"}], ":=", "\n", "\t", 
   RowBox[{"FE`Evaluate", "[", 
    RowBox[{"FEPrivate`GetPopupList", "[", "menu", "]"}], "]"}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.6907325440110292`*^9, 3.690732554370481*^9}, 
   3.690732598193438*^9, {3.69115634642247*^9, 
   3.691156411443828*^9}},ExpressionUUID->"90b8bee6-45f1-4e7c-8ae7-\
efb9ec0ff83d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuReset", "[", "]"}], ":=", "\n", "\t", 
   RowBox[{"FrontEndExecute", "@", 
    RowBox[{"ResetMenusPacket", "[", 
     RowBox[{"{", "Automatic", "}"}], "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"FEMenuSet", "[", 
   RowBox[{"menu", ":", 
    RowBox[{"Menu", "[", 
     RowBox[{"\"\<Mathematica\>\"", ",", "_List", ",", "___"}], "]"}]}], 
   "]"}], ":=", "\n", "\t", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"FrontEndExecute", "@", 
     RowBox[{"ResetMenusPacket", "[", 
      RowBox[{"{", "menu", "}"}], "]"}]}], ";", "menu"}], ")"}]}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuSet", "[", 
    RowBox[{"menu", ":", 
     RowBox[{"Menu", "[", 
      RowBox[{
       RowBox[{"Except", "@", "\"\<Mathematica\>\""}], ",", "_List", ",", 
       "___"}], "]"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"FEMenuSet", "[", 
    RowBox[{"Menu", "[", 
     RowBox[{"\"\<Mathematica\>\"", ",", 
      RowBox[{"{", "menu", "}"}]}], "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuSet", "[", 
    RowBox[{"menus", ":", 
     RowBox[{"{", "___Menu", "}"}]}], "]"}], ":=", "\n", "\t\t", 
   RowBox[{"FEMenuSet", "[", 
    RowBox[{"Menu", "[", 
     RowBox[{"\"\<Mathematica\>\"", ",", "menus"}], "]"}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuSet", "[", "None", "]"}], ":=", "\n", "\t", 
   RowBox[{"FEMenuSet", "[", 
    RowBox[{"{", "}"}], "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.691162313549663*^9, 3.691162338782731*^9}, {
  3.691174665421475*^9, 3.69117472150891*^9}, {3.6911761058948812`*^9, 
  3.691176172652368*^9}, {3.691176272082766*^9, 3.69117632610609*^9}, {
  3.691177223705288*^9, 3.6911772259918423`*^9}, {3.6911781508276033`*^9, 
  3.6911781739742928`*^9}},ExpressionUUID->"ac98a9da-cafb-4956-bb91-\
687483a13ae7"]
}, Closed]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], 
  ";"}]], "InputSection",ExpressionUUID->"974fbb70-34bf-4213-98b8-\
937f63803852"]
}, Open  ]],

Cell["", "SectionSeparator",ExpressionUUID->"ea336b1f-1d66-4fe7-b343-\
5e8f173cca45"],

Cell[CellGroupData[{

Cell["Menus", "Subsubsection",
 CellChangeTimes->{{3.691150526820305*^9, 
  3.6911505282589273`*^9}},ExpressionUUID->"f33a5063-89e6-486d-928b-\
8d98f43ab317"],

Cell[BoxData[
 RowBox[{"FEMenuFind", "[", 
  RowBox[{"_String", "?", 
   RowBox[{"(", 
    RowBox[{"StringContainsQ", "[", "\"\<Bib\>\"", "]"}], ")"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.691157128948523*^9, 
  3.691157144139823*^9}},ExpressionUUID->"fd10ef3e-c155-48fa-a978-\
8c90cf32fb96"],

Cell[BoxData["MyTools`Private`$menuStructure"], "Input",
 CellChangeTimes->{{3.691157406825539*^9, 
  3.691157415213559*^9}},ExpressionUUID->"3fc52e3d-0823-4501-b12c-\
865afe3ef73d"],

Cell[BoxData[
 RowBox[{"FEMenuAdd", "[", "menuNew", "]"}]], "Input",
 CellChangeTimes->{{3.691162740712227*^9, 
  3.691162750451269*^9}},ExpressionUUID->"9c3bdda7-2fbe-43bb-92e6-\
32dc4cdceffe"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FEPackets", "[", "\"\<Men\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.6911627572459784`*^9, 
  3.691162774031694*^9}},ExpressionUUID->"ae788ac5-463f-4e53-8e4d-\
d386f484fe5f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\<\"AddMenuCommands\"\>", ",", "\<\"GetMenusPacket\"\>", 
   ",", "\<\"MenuPacket\"\>", ",", "\<\"RemoveMenuCommands\"\>", 
   ",", "\<\"ResetMenusPacket\"\>"}], "}"}]], "Output",
 CellChangeTimes->{{3.691162765153157*^9, 
  3.691162774493416*^9}},ExpressionUUID->"f34ccd31-eac5-41e8-863d-\
023789cccf04"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Resetting", "Subsubsection",
 CellChangeTimes->{{3.691163401624896*^9, 
  3.6911634026487007`*^9}},ExpressionUUID->"1dd49ddb-09eb-423c-afa1-\
41a080bbdd8c"],

Cell[BoxData[
 RowBox[{"<<", "MyTools`"}]], "Input",
 CellChangeTimes->{{3.691163397148011*^9, 
  3.691163399656994*^9}},ExpressionUUID->"06639098-946f-4b8c-a5ff-\
355077257fed"],

Cell[BoxData[
 RowBox[{"FrontEndExecute", "@", 
  RowBox[{"ResetMenusPacket", "[", 
   RowBox[{"{", "Automatic", "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.69116286939883*^9, 
  3.6911628847256603`*^9}},ExpressionUUID->"5b3170eb-7901-4ac4-8e8a-\
3aa4d1045c41"],

Cell[BoxData[
 RowBox[{"FEMenuAdd", "[", 
  RowBox[{"\"\<New\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"MenuItem", "[", 
    RowBox[{"\"\<f2\>\"", ",", "\"\<NewPackage\>\""}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.6911635402591133`*^9, 3.6911635650813513`*^9}, {
  3.691163596652776*^9, 
  3.691163598409554*^9}},ExpressionUUID->"f6c075cc-a091-49b2-87d1-\
809d6c898195"],

Cell[BoxData[
 RowBox[{
  RowBox[{"menuNew", "=", "\[IndentingNewLine]", 
   RowBox[{"MyTools`Private`$menuStructure", "/.", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"s_Symbol", "?", 
       RowBox[{"(", 
        RowBox[{"Function", "[", 
         RowBox[{"sym", ",", 
          RowBox[{
           RowBox[{"Context", "@", "sym"}], "!=", "\"\<System`\>\""}], ",", 
          "HoldFirst"}], "]"}], ")"}]}], "\[RuleDelayed]", 
      RowBox[{"With", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"n", "=", 
          RowBox[{"SymbolName", "@", 
           RowBox[{"Unevaluated", "@", "s"}]}]}], "}"}], ",", 
        RowBox[{"n", "/;", "True"}]}], "]"}]}], "\[IndentingNewLine]", 
     "}"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.691162673109397*^9, 
  3.6911627471049433`*^9}},ExpressionUUID->"06289abe-f1dd-4391-90c2-\
8f50eb951ace"],

Cell[BoxData[
 RowBox[{"FrontEndExecute", "@", 
  RowBox[{"ResetMenusPacket", "[", 
   RowBox[{"{", "menuNew", "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.69116286939883*^9, 3.6911628847256603`*^9}, {
   3.691163343654488*^9, 3.6911633604269733`*^9}, {3.6911634711077414`*^9, 
   3.691163484108461*^9}, 
   3.691163534700329*^9},ExpressionUUID->"8d647fed-d4cb-44ff-b37f-\
2ed41e4ba557"],

Cell[BoxData[
 RowBox[{
  RowBox[{"new2", "=", 
   RowBox[{"menuNew", "/.", 
    RowBox[{
     RowBox[{"MenuItem", "[", 
      RowBox[{"_", ",", "a__"}], "]"}], "\[RuleDelayed]", 
     RowBox[{"MenuItem", "[", 
      RowBox[{"\"\<test\>\"", ",", "a"}], "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.691163642868807*^9, 
  3.691163669365378*^9}},ExpressionUUID->"88a19426-537d-4126-a829-\
21ce660bd770"],

Cell[BoxData[
 RowBox[{"FrontEndExecute", "@", 
  RowBox[{"ResetMenusPacket", "[", 
   RowBox[{"{", "new2", "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.691163675288954*^9, 
  3.691163680073022*^9}},ExpressionUUID->"58112b1d-8b70-4d02-a42c-\
ef333ab230ef"],

Cell[BoxData[
 RowBox[{
  RowBox[{"new3", "=", 
   RowBox[{"Insert", "[", 
    RowBox[{"menuNew", ",", 
     RowBox[{"Menu", "[", 
      RowBox[{"\"\<Test\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"MenuItem", "[", 
         RowBox[{"\"\<Wow\>\"", ",", 
          RowBox[{"FrontEndExecute", "@", 
           RowBox[{"FrontEnd`BeepPacket", "[", "]"}]}]}], "]"}], "}"}]}], 
      "]"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "2"}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.691163917885674*^9, 
  3.691164000640992*^9}},ExpressionUUID->"cb705e0f-9338-4996-afc9-\
b5ed993cc17c"],

Cell[BoxData[
 RowBox[{"FrontEndExecute", "@", 
  RowBox[{"ResetMenusPacket", "[", 
   RowBox[{"{", "new3", "}"}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.6911639906410913`*^9},ExpressionUUID->"5a123367-13ab-47d8-a85b-\
cc31a67d9ef1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"new4", "=", "\[IndentingNewLine]", 
   RowBox[{"Menu", "[", 
    RowBox[{"\"\<Mathematica\>\"", ",", "\[IndentingNewLine]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"Menu", "[", 
       RowBox[{"\"\<Custom Menu\>\"", ",", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{"MenuItem", "[", 
          RowBox[{"\"\<...\>\"", ",", "\"\<Paste\>\""}], "]"}], 
         "\[IndentingNewLine]", "}"}]}], "]"}], "\[IndentingNewLine]", 
      "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6911640761756697`*^9, 
  3.691164145104971*^9}},ExpressionUUID->"aaf5824b-4e7e-4b4a-845b-\
3622245e7d71"],

Cell[BoxData[
 RowBox[{"FrontEndExecute", "@", 
  RowBox[{"ResetMenusPacket", "[", 
   RowBox[{"{", "Automatic", "}"}], "]"}]}]], "Input",
 CellChangeTimes->{
  3.691164136550436*^9, {3.6911643381784143`*^9, 
   3.6911643386636887`*^9}},ExpressionUUID->"63c2afd6-0f19-4971-abda-\
f99fb3315ddc"],

Cell[BoxData[
 RowBox[{"FEMenuAdd", "[", 
  RowBox[{"\"\<Custom Menu\>\"", ",", "\[IndentingNewLine]", 
   RowBox[{"MenuItem", "[", 
    RowBox[{"\"\<why\>\"", ",", "\"\<&New\>\""}], "]"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.6911641650546217`*^9, 3.691164188249296*^9}, 
   3.691174392735195*^9},ExpressionUUID->"43480d3f-8595-4781-932d-\
e6edafa618e9"]
}, Closed]],

Cell[CellGroupData[{

Cell["$FrontEndMenu", "Subsubsection",
 CellChangeTimes->{{3.6911948217692623`*^9, 
  3.691194826032085*^9}},ExpressionUUID->"d5e94579-361a-487d-8fb8-\
3744a334b9c4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$FrontEndMenu", "=", "Automatic"}], ";"}]], "Input",
 CellChangeTimes->{{3.69120098034219*^9, 
  3.691200981437707*^9}},ExpressionUUID->"a3d77d85-6e12-425a-b335-\
e254ac036217"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$FrontEndMenu", "=", 
   RowBox[{"FEMenuDrop", "[", "\"\<Format\>\"", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6911948279054337`*^9, 3.691194848697139*^9}, {
  3.6911980284282618`*^9, 3.6911980400246477`*^9}, {3.691198076232957*^9, 
  3.6911981285839*^9}, {3.691198161157775*^9, 3.6911981626349916`*^9}, {
  3.691199945753497*^9, 3.691199953821398*^9}, {3.691200320640623*^9, 
  3.691200321246303*^9}, {3.691200634733799*^9, 3.691200636002028*^9}, {
  3.69120200932659*^9, 3.691202018026836*^9}, {3.6912021888087807`*^9, 
  3.691202189630198*^9}},ExpressionUUID->"f4902869-85a0-4334-be03-\
09eb1ca97796"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$FrontEndMenu", "=", "\[IndentingNewLine]", 
   RowBox[{"FEMenuInsert", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Menu", "[", 
      RowBox[{"\"\<doopDoop\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"MenuItem", "[", 
         RowBox[{"\"\<eval\>\"", ",", "\"\<HandleShiftReturn\>\""}], "]"}], 
        "}"}]}], "]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"-", "2"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.691198187875372*^9, 3.69119829715565*^9}, {
   3.6912003134267387`*^9, 3.6912003192740726`*^9}, 3.691200351222486*^9, {
   3.691200392630629*^9, 3.691200395390765*^9}, {3.691200427045586*^9, 
   3.691200430123987*^9}, 
   3.691200695444928*^9},ExpressionUUID->"b8875a69-8ec9-4053-b915-\
6b12f49112f8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$FrontEndMenu", "=", 
   RowBox[{"FEMenuReplace", "[", 
    RowBox[{"\"\<doopDoop\>\"", "->", 
     RowBox[{"Menu", "[", 
      RowBox[{"\"\<doopDoop\>\"", ",", 
       RowBox[{"{", 
        RowBox[{"MenuItem", "[", 
         RowBox[{"\"\<eval\>\"", ",", "\"\<HandleShiftReturn\>\""}], "]"}], 
        "}"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6912004966426573`*^9, 3.6912005336423273`*^9}, 
   3.6912006137056923`*^9},ExpressionUUID->"bcf60a3d-d016-480b-9a06-\
5328d0b470f9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$FrontEndMenu", "=", 
   RowBox[{"FEMenuDrop", "[", "\"\<Example\>\"", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.691200721535219*^9, 3.6912007238400793`*^9}, {
  3.6912009421152983`*^9, 3.691200970277154*^9}, {3.6912011598701982`*^9, 
  3.6912011664491673`*^9}, {3.6912017540038633`*^9, 
  3.6912017551762333`*^9}},ExpressionUUID->"60b2afb5-cf54-416f-a177-\
ab0d4a8539b4"],

Cell[BoxData[
 RowBox[{"$FrontEndMenu", "=", 
  RowBox[{"FEMenuInsert", "[", 
   RowBox[{
    RowBox[{"Menu", "[", 
     RowBox[{"\"\<Example\>\"", ",", 
      RowBox[{"{", 
       RowBox[{"MenuItem", "[", 
        RowBox[{"\"\<blah\>\"", ",", "\"\<Close\>\""}], "]"}], "}"}]}], "]"}],
     ",", "1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.691201174512973*^9, 
  3.6912012281623907`*^9}},ExpressionUUID->"fd6f23c0-0163-4c45-b594-\
8062bffedd88"],

Cell[BoxData[
 RowBox[{"$FrontEndMenu", "=", 
  RowBox[{"FEMenuReplace", "[", 
   RowBox[{"\"\<Format\>\"", "->", 
    RowBox[{"Menu", "[", 
     RowBox[{"\"\<Example\>\"", ",", 
      RowBox[{"{", 
       RowBox[{"MenuItem", "[", 
        RowBox[{"\"\<blah\>\"", ",", "\"\<Close\>\""}], "]"}], "}"}]}], 
     "]"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.691201174512973*^9, 3.6912012281623907`*^9}, {
  3.6912017769936132`*^9, 
  3.691201808491996*^9}},ExpressionUUID->"8188525e-d8b6-4f47-b413-\
0342298a3995"]
}, Closed]]
},
WindowSize->{808, 755},
WindowMargins->{{314, Automatic}, {Automatic, 50}},
FrontEndVersion->"11.1 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 16, \
2017)",
StyleDefinitions->FrontEnd`FileName[{"BTools"}, "CodePackage.nb", 
  CharacterEncoding -> "UTF-8"]
]

