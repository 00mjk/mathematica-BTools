Notebook[{

Cell[CellGroupData[{
Cell["TextResourceTools", "CodeSection",
 CellChangeTimes->{{3.7037266163106747`*^9, 
  3.703726626350458*^9}},ExpressionUUID->"e8237860-dc56-4482-a39c-\
7905f3cc7be9"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]TRResources\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.703484851580736*^9, 3.7034848622987556`*^9}, {
  3.703539140239092*^9, 3.7035391441329327`*^9}, {3.703730971082633*^9, 
  3.703731003619199*^9}},ExpressionUUID->"9ffe94f9-0d79-4d72-8a3f-\
3e8483152233"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$FEResourceDirectory", "::", "usage"}], "=", "\n", "\t", 
   "\"\<The base directory for FE resources\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"$FEResourceFiles", "::", "usage"}], "=", "\n", "\t", 
   "\"\<The .tr files in the base directory\>\""}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.703540525570786*^9, 
  3.7035405465445213`*^9}},ExpressionUUID->"d0cade02-5c48-4ba4-ad3d-\
64d1553a38f8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FEAddResource", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Adds a FE resource\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FELoadResources", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Loads all FE resources\>\""}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.7034863755979557`*^9, 3.703486407580784*^9}, 
   3.703486448183601*^9, {3.703512843767322*^9, 3.703512857200162*^9}, 
   3.7035131167589073`*^9, {3.703540518817793*^9, 
   3.703540522898024*^9}},ExpressionUUID->"c6cc3916-5fc8-4690-ac80-\
55cc90aba2b8"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Keys\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7035115157173147`*^9, 3.703511516452403*^9}, {
  3.710173284590126*^9, 
  3.7101732848822517`*^9}},ExpressionUUID->"44fa3883-d6a4-470f-8be2-\
e2b43be1458d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$FEKeyEventsDirectory", "::", "usage"}], "=", "\n", "\t", 
   "\"\<The directory the KeyEventTranslations.tr file dumps to\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"$FEKeyEvents", "::", "usage"}], "=", "\n", "\t", 
   "\"\<The listing of keyboard events\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FEKeyEventAdd", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Adds key events\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FEKeyEventDrop", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Drops key events\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FEResetKeyEvents", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Resets the key events\>\""}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.703511517438867*^9, 3.7035115671634293`*^9}, {
  3.703512164302741*^9, 3.703512206800745*^9}, {3.703513172691753*^9, 
  3.703513189067403*^9}, {3.703513271473794*^9, 3.7035132733044662`*^9}, {
  3.703538034561192*^9, 
  3.7035380496125*^9}},ExpressionUUID->"81bd1fd3-2c7e-4ee5-8585-c9ca880dd965"]\

}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Menus\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.703523393443408*^9, 
  3.703523394012786*^9}},ExpressionUUID->"b1dad7b6-4a3f-4079-85a4-\
8cfb98ec007a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$FEMenuSetupDirectory", "::", "usage"}], "=", "\n", "\t", 
   "\"\<The directory the MenuSetup.tr file dumps to\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"$FEMenuSetup", "::", "usage"}], "=", "\n", "\t", 
   "\"\<The association of menu items\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuSetupAdd", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Adds to the MenuSetup.tr file\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuSetupDrop", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Drops from the MenuSetup.tr file\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuSetupGet", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Gets stuff from the MenuSetup.tr file\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FEResetMenuSetup", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Resets the MenuSetup.tr file\>\""}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.703523397282413*^9, 3.703523456242978*^9}, {
  3.703535602017714*^9, 3.703535613629051*^9}, {3.7035380179335823`*^9, 
  3.703538029333091*^9}},ExpressionUUID->"0868fb3f-0117-4ac1-8559-\
f37c5ce340b5"]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], 
  ";"}]], "InputSection",ExpressionUUID->"6a6e4747-3fae-4722-8413-\
6804190ec098"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Begin", "[", "\"\<System`\>\"", "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"ToExpression", "@", 
   RowBox[{"{", "\n", "\t", 
    RowBox[{
    "\"\<HelpMenu\>\"", ",", "\"\<AlternateItems\>\"", ",", 
     "\"\<LinkedItems\>\"", ",", "\n", "\t", "\"\<MenuKey\>\"", ",", 
     "\"\<Modifiers\>\"", ",", "\"\<MenuAnchor\>\"", ",", "\n", "\t", 
     "\"\<RemoveMask\>\"", ",", "\"\<Scope\>\""}], "\n", "\t", "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.705163102415923*^9, 3.705163152793508*^9}, {
  3.710173454630822*^9, 
  3.710173454985941*^9}},ExpressionUUID->"34c4b81c-56b4-46fa-981f-\
d9e8641938b2"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]FETextResource\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.7034849114147377`*^9, 
  3.703484917783852*^9}},ExpressionUUID->"f5f3afc8-570b-4844-867e-\
1327ce893746"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "$FETrBaseName", "=", "\n", "\t", "\"\<TokenTranslationDictionary\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
  "$FETrFileBaseName", "=", "\n", "\t", "\"\<ExtendedFEResources\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"ListQ", "@", "$FETrResources"}]}], ",", "\n", "\t", 
    RowBox[{"$FETrResources", "=", "\n", "\t\t", 
     RowBox[{"FrontEndResource", "[", "$FETrBaseName", "]"}]}]}], "\n", "\t", 
   "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$FETrBaseFile", "=", "\n", "\t", 
   RowBox[{"FileNameJoin", "@", 
    RowBox[{"{", "\n", "\t\t", 
     RowBox[{
     "$InstallationDirectory", ",", "\n", "\t\t", "\"\<SystemFiles\>\"", ",", 
      "\n", "\t\t", "\"\<FrontEnd\>\"", ",", "\n", "\t\t", 
      "\"\<TextResources\>\"", ",", "\n", "\t\t", 
      "\"\<TokenTranslationDictionary.tr\>\""}], "\n", "\t\t", "}"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"$FETrListing", "=", "\n", "\t", 
   RowBox[{"AssociationMap", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Null", "&"}], ",", "\n", "\t\t", "$FEResourceCompleteListing"}],
     "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$FEResourceDirectory", "=", "\n", "\t", 
   RowBox[{"$FETemporaryResources", "=", "\n", "\t\t", 
    RowBox[{"FrontEnd`FileName", "@", 
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
      "$TemporaryDirectory", ",", "\n", "\t", "\t\t", "\"\<SystemFiles\>\"", 
       ",", "\n", "\t", "\t\t", "\"\<FrontEnd\>\"", ",", "\n", "\t", "\t\t", 
       "\"\<TextResources\>\""}], "\n", "\t", "\t\t", "}"}]}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"$FEPersistentResources", "=", "\n", "\t", 
   RowBox[{"FrontEnd`FileName", "@", 
    RowBox[{"{", "\n", "\t\t", 
     RowBox[{
     "$UserBaseDirectory", ",", "\n", "\t\t", "\"\<SystemFiles\>\"", ",", 
      "\n", "\t\t", "\"\<FrontEnd\>\"", ",", "\n", "\t\t", 
      "\"\<TextResources\>\""}], "\n", "\t\t", "}"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$FEResourceFiles", ":=", "\n", "\t", 
   RowBox[{"FileNames", "[", 
    RowBox[{"\"\<*.tr\>\"", ",", 
     RowBox[{"ToFileName", "@@", "$FEResourceDirectory"}], ",", 
     "\[Infinity]"}], "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.703485704222197*^9, 3.703485715150344*^9}, {
   3.7034858817670097`*^9, 3.703485915699216*^9}, {3.7034860304722433`*^9, 
   3.703486036624741*^9}, {3.703487691155353*^9, 3.703487727642075*^9}, {
   3.70348804063406*^9, 3.7034880783608027`*^9}, {3.703488594616103*^9, 
   3.703488603831194*^9}, 3.703489329621107*^9, {3.7034895761936607`*^9, 
   3.703489621594943*^9}, {3.703489662406464*^9, 3.703489671752452*^9}, {
   3.703513524197592*^9, 3.703513539687867*^9}, {3.7035153767628613`*^9, 
   3.703515377494103*^9}, {3.703515536464839*^9, 3.703515537367495*^9}, {
   3.7035405783397923`*^9, 3.703540580017387*^9}, 3.706643555351091*^9, {
   3.7066479917340927`*^9, 
   3.706648007592566*^9}},ExpressionUUID->"5dfe95fe-ae75-4210-935d-\
230db0913414"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"FELoadResources", "[", "]"}], ":=", 
   RowBox[{"(", "\n", "\t", 
    RowBox[{
     RowBox[{
      RowBox[{"CurrentValue", "[", 
       RowBox[{"$FrontEndSession", ",", "\n", "\t\t", 
        RowBox[{"{", 
         RowBox[{"PrivatePaths", ",", "\"\<TextResources\>\""}], "}"}]}], 
       "\n", "\t\t", "]"}], "=", "\n", "\t\t", 
      RowBox[{"DeleteDuplicates", "@", "\n", "\t\t\t", 
       RowBox[{"Prepend", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"CurrentValue", "[", 
          RowBox[{"$FrontEndSession", ",", "\n", "\t", "\t", "\t", "\t", "\t", 
           RowBox[{"{", 
            RowBox[{"PrivatePaths", ",", "\"\<TextResources\>\""}], "}"}]}], 
          "\n", "\t", "\t", "\t", "\t\t", "]"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"FrontEnd`FileName", "[", "\n", "\t\t\t\t\t", 
          RowBox[{"Evaluate", "@", 
           RowBox[{"{", 
            RowBox[{"ToFileName", "@@", "$FEResourceDirectory"}], "}"}]}], 
          "\n", "\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "]"}]}]}], ";", "\n",
      "\t", 
     RowBox[{"FrontEndExecute", "@", 
      RowBox[{"FrontEnd`FlushTextResourceCaches", "[", "]"}]}]}], "\n", "\t", 
    ")"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.703484933758309*^9, 3.7034850831652308`*^9}, {
   3.703485241456777*^9, 3.7034855251056128`*^9}, {3.7034856624748363`*^9, 
   3.703485695389743*^9}, {3.7034857366847353`*^9, 3.7034857934728937`*^9}, {
   3.7034859590594254`*^9, 3.703485966947454*^9}, {3.7034875837679243`*^9, 
   3.703487588021303*^9}, {3.7034890662744226`*^9, 3.703489085902816*^9}, {
   3.7034891383209343`*^9, 3.7034891390974703`*^9}, 3.703489294613093*^9, 
   3.703489480527081*^9},ExpressionUUID->"cfca4ebe-2109-419d-a166-\
6b4520574dfb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
  "$FETrTemplate", "=", "\n", 
   "\"\<@|\n@|\n@@resource `name`\n`value`\n@|\n\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "FETrExport", "]"}], "=", 
   RowBox[{"{", "\n", "\t", 
    RowBox[{
     RowBox[{"InputForm", "\[Rule]", "True"}], ",", "\n", "\t", 
     RowBox[{"TemplateApply", "\[Rule]", "True"}]}], "\n", "\t", "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FETrExport", "[", 
    RowBox[{"name_", ",", "value_", ",", "\n", "\t", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "\n", "\t", "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"file", "=", "\n", "\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{"$FEResourceDirectory", ",", "_FrontEnd`FileName"}], "]"}], 
         ",", "\n", "\t\t\t", 
         RowBox[{"ToFileName", "@@", "\n", "\t\t\t\t", 
          RowBox[{"Append", "[", 
           RowBox[{"$FEResourceDirectory", ",", "\n", "\t", "\t\t\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"StringQ", "@", "name"}], ",", "\n", "\t", 
              "\t\t\t\t\t\t", 
              RowBox[{"name", "<>", "\"\<.tr\>\""}], ",", "\n", "\t", 
              "\t\t\t\t\t", 
              RowBox[{"Switch", "[", 
               RowBox[{
                RowBox[{"Last", "@", "name"}], ",", "\n", "\t", 
                "\t\t\t\t\t\t", "_String", ",", "\n", "\t", "\t\t\t\t\t\t\t", 
                
                RowBox[{
                 RowBox[{"Last", "@", "name"}], "<>", "\"\<.tr\>\""}], ",", 
                "\n", "\t", "\t\t\t\t\t\t", "_List", ",", "\n", "\t", 
                "\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"FileNameJoin", "[", 
                  RowBox[{"Last", "@", "name"}], "]"}], "<>", 
                 "\"\<.tr\>\""}]}], "\n", "\t", "\t\t\t\t\t\t", "]"}]}], "\n",
              "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t", "]"}]}], ",", "\n",
          "\t\t\t", 
         RowBox[{"FileNameJoin", "@", 
          RowBox[{"{", "\n", "\t\t\t\t", 
           RowBox[{"$FEResourceDirectory", ",", "\n", "\t\t\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"StringQ", "@", "name"}], ",", "\n", "\t", 
              "\t\t\t\t\t\t", 
              RowBox[{"name", "<>", "\"\<.tr\>\""}], ",", "\n", "\t", 
              "\t\t\t\t\t", 
              RowBox[{"Switch", "[", 
               RowBox[{
                RowBox[{"Last", "@", "name"}], ",", "\n", "\t", 
                "\t\t\t\t\t\t", "_String", ",", "\n", "\t", "\t\t\t\t\t\t\t", 
                
                RowBox[{
                 RowBox[{"Last", "@", "name"}], "<>", "\"\<.tr\>\""}], ",", 
                "\n", "\t", "\t\t\t\t\t\t", "_List", ",", "\n", "\t", 
                "\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"FileNameJoin", "[", 
                  RowBox[{"Last", "@", "name"}], "]"}], "<>", 
                 "\"\<.tr\>\""}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}], "\n", 
             "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t", "}"}]}]}], "\n", 
        "\t\t\t", "]"}]}], "\n", "\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"value", "===", "Inherited"}], ",", "\n", "\t", "\t\t", 
       RowBox[{"Quiet", "@", 
        RowBox[{"DeleteFile", "[", "file", "]"}]}], ",", "\n", "\t", "\t\t", 
       RowBox[{
        RowBox[{"Quiet", "@", "\n", "\t\t\t\t", 
         RowBox[{"CreateDirectory", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"DirectoryName", "@", "file"}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{"CreateIntermediateDirectories", "\[Rule]", "True"}]}], 
          "\n", "\t\t\t\t\t", "]"}]}], ";", "\n", "\t\t\t", 
        RowBox[{"Export", "[", "\n", "\t\t\t\t", 
         RowBox[{"file", ",", "\n", "\t\t\t\t", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"OptionValue", "[", "TemplateApply", "]"}], "//", 
             "TrueQ"}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{"TemplateApply", "[", "\n", "\t\t\t\t\t\t", 
             RowBox[{"$FETrTemplate", ",", 
              RowBox[{"<|", "\n", "\t", "\t", "\t", "\t\t\t\t", 
               RowBox[{
                RowBox[{
                "\"\<name\>\"", "\[Rule]", "\n", "\t", "\t", "\t\t\t\t\t\t", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"StringQ", "@", "name"}], ",", "\n", "\t", "\t", 
                   "\t\t\t\t\t\t\t", "name", ",", "\n", "\t", "\t", 
                   "\t\t\t\t\t\t\t", 
                   RowBox[{"First", "@", "name"}]}], "\n", "\t", "\t", 
                  "\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t", "\t", 
                "\t\t\t\t\t", 
                RowBox[{
                "\"\<value\>\"", "\[Rule]", "\n", "\t\t\t\t\t\t\t\t", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"OptionValue", "[", "InputForm", "]"}], "//", 
                    "TrueQ"}], ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"ToString", "[", 
                    RowBox[{"value", ",", "InputForm"}], "]"}], ",", "\n", 
                   "\t", "\t", "\t", "\t\t\t\t\t\t", "value"}], "\n", "\t", 
                  "\t", "\t", "\t\t\t\t\t\t", "]"}]}]}], "\n", "\t", "\t", 
               "\t", "\t\t\t\t", "|>"}]}], "]"}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"OptionValue", "[", "InputForm", "]"}], "//", 
               "TrueQ"}], ",", "\n", "\t\t\t\t\t\t", 
              RowBox[{"ToString", "[", 
               RowBox[{"value", ",", "InputForm"}], "]"}], ",", "\n", 
              "\t\t\t\t\t\t", 
              RowBox[{"ToString", "@", "value"}]}], "\n", "\t\t\t\t\t\t", 
             "]"}]}], "\n", "\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t", 
          "\"\<Text\>\""}], "\n", "\t\t\t\t", "]"}]}]}], "\n", "\t\t\t", 
      "]"}]}], "\n", "\t\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.703484933758309*^9, 3.7034850831652308`*^9}, {
   3.703485241456777*^9, 3.7034855251056128`*^9}, {3.7034856624748363`*^9, 
   3.703485695389743*^9}, {3.7034857366847353`*^9, 3.7034857934728937`*^9}, {
   3.7034859590594254`*^9, 3.7034861675875273`*^9}, 3.70348741295072*^9, {
   3.703487486142074*^9, 3.703487496330846*^9}, {3.703487529608449*^9, 
   3.70348753125506*^9}, {3.7034876119347153`*^9, 3.7034876215481377`*^9}, {
   3.703487994448338*^9, 3.703488015205964*^9}, {3.7034881035141087`*^9, 
   3.703488107740417*^9}, {3.703488187701075*^9, 3.7034882058449593`*^9}, {
   3.7034883100735483`*^9, 3.7034883137631083`*^9}, {3.703488497170967*^9, 
   3.703488536538855*^9}, {3.703488956939309*^9, 3.70348895953568*^9}, {
   3.7034889926065207`*^9, 3.703489011902155*^9}, 3.7034891968580523`*^9, {
   3.7034892349682007`*^9, 3.703489261983096*^9}, {3.7034893257336187`*^9, 
   3.703489327683758*^9}, 3.703489448134458*^9, {3.703513969829071*^9, 
   3.703513973506459*^9}, {3.703515101929304*^9, 3.70351517695999*^9}, {
   3.703515728890883*^9, 3.703515809077783*^9}, {3.703529854629161*^9, 
   3.703529922565838*^9}, {3.703530191496443*^9, 3.703530214119192*^9}, {
   3.703540609763439*^9, 3.70354064935918*^9}, {3.703540714456272*^9, 
   3.703540730764917*^9}},ExpressionUUID->"93648671-c57d-468b-8108-\
3905fae984fb"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "FEAddResource", "]"}], "=", "\n", "\t", 
   RowBox[{"Options", "[", "FETrExport", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FEAddResource", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"name_String", "|", "\n", "\t\t", 
      RowBox[{"(", 
       RowBox[{"name_String", "\[Rule]", "path_"}], ")"}]}], ",", "\n", "\t", 
     "value_", ",", "\n", "\t", 
     RowBox[{"ops", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "\n", "\t", "]"}], ":=", 
   RowBox[{"(", "\n", "\t", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"KeyMemberQ", "[", 
        RowBox[{"$FETrListing", ",", "name"}], "]"}], ",", "\n", "\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"{", "path", "}"}], ",", 
           RowBox[{"Except", "[", 
            RowBox[{
             RowBox[{"{", "_String", "}"}], "|", 
             RowBox[{"{", "_List", "}"}]}], "]"}]}], "]"}], ",", "\n", 
         "\t\t\t", 
         RowBox[{"FETrExport", "[", 
          RowBox[{
          "name", ",", "value", ",", "\n", "\t\t\t\t", "ops", ",", "\n", 
           "\t\t\t\t", 
           RowBox[{"InputForm", "\[Rule]", "False"}]}], "\n", "\t\t\t\t", 
          "]"}], ",", "\n", "\t\t\t", 
         RowBox[{"FETrExport", "[", 
          RowBox[{
           RowBox[{"name", "\[Rule]", "path"}], ",", "value", ",", "\n", 
           "\t\t\t\t", "ops", ",", "\n", "\t\t\t\t", 
           RowBox[{"InputForm", "\[Rule]", "False"}]}], "\n", "\t\t\t\t", 
          "]"}]}], "\n", "\t\t\t", "]"}], ",", "\n", "\t\t", 
       RowBox[{
        RowBox[{"$FETrResources", "=", "\n", "\t\t\t", 
         RowBox[{"Normal", "@", 
          RowBox[{
           RowBox[{"DeleteCases", "[", "Inherited", "]"}], "@", "\n", 
           "\t\t\t\t", 
           RowBox[{"Merge", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"$FETrResources", ",", 
               RowBox[{"name", "\[Rule]", "value"}]}], "}"}], ",", "Last"}], 
            "]"}]}]}]}], ";", "\n", "\t\t", 
        RowBox[{"Quiet", "@", "\n", "\t\t\t", 
         RowBox[{"CopyFile", "[", 
          RowBox[{"$FETrBaseFile", ",", "\n", "\t\t\t\t", 
           RowBox[{"ToFileName", "@@", "\n", "\t\t\t\t\t", 
            RowBox[{"Append", "[", 
             RowBox[{"$FEResourceDirectory", ",", "\n", "\t\t\t\t\t\t", 
              RowBox[{"FileNameTake", "@", "$FETrFileBaseName"}]}], "\n", 
             "\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t", "]"}]}], ";", "\n", 
        "\t\t", 
        RowBox[{"FETrExport", "[", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{"$FETrBaseName", "\[Rule]", "$FETrFileBaseName"}], ",", 
          "\n", "\t\t\t", "$FETrResources"}], "\n", "\t\t\t", "]"}]}]}], "\n",
       "\t\t", "]"}], ";", "\n", "\t", 
     RowBox[{"FELoadResources", "[", "]"}]}], "\n", "\t", ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FEAddResource", "[", 
    RowBox[{"r", ":", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"_String", "->", "_"}], ")"}], ".."}], "}"}]}], "]"}], ":=", 
   RowBox[{"(", "\n", "\t", 
    RowBox[{
     RowBox[{"$FETrResources", "=", "\n", "\t\t", 
      RowBox[{"Normal", "@", 
       RowBox[{
        RowBox[{"DeleteCases", "[", "Inherited", "]"}], "@", "\n", "\t\t\t", 
        RowBox[{"Merge", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"$FETrResources", ",", "r"}], "}"}], ",", "Last"}], 
         "]"}]}]}]}], ";", "\n", "\t", 
     RowBox[{"Quiet", "@", "\n", "\t\t\t", 
      RowBox[{"CopyFile", "[", 
       RowBox[{"$FETrBaseFile", ",", "\n", "\t\t\t\t", 
        RowBox[{"ToFileName", "@@", "\n", "\t\t\t\t\t", 
         RowBox[{"Append", "[", 
          RowBox[{"$FEResourceDirectory", ",", "\n", "\t\t\t\t\t\t", 
           RowBox[{"$FETrFileBaseName", "<>", "\"\<.tr\>\""}]}], "\n", 
          "\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t", "]"}]}], ";", "\n", 
     "\t\t", 
     RowBox[{"FETrExport", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"$FETrBaseName", "\[Rule]", "$FETrFileBaseName"}], ",", "\n", 
       "\t\t\t", "$FETrResources"}], "\n", "\t\t\t", "]"}]}], "\n", "\t", 
    ")"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.703484933758309*^9, 3.7034850831652308`*^9}, {
   3.703485241456777*^9, 3.7034855251056128`*^9}, {3.7034856624748363`*^9, 
   3.703485695389743*^9}, {3.7034857366847353`*^9, 3.7034857934728937`*^9}, {
   3.7034859590594254`*^9, 3.703486251433385*^9}, {3.703486297228179*^9, 
   3.7034863686714354`*^9}, {3.70348641652299*^9, 3.703486425280499*^9}, 
   3.70348768848109*^9, {3.703487735876742*^9, 3.703487738109096*^9}, {
   3.703487985465761*^9, 3.703487990567545*^9}, {3.703488563226418*^9, 
   3.703488589632596*^9}, {3.703488851978787*^9, 3.703488864784028*^9}, 
   3.7034892232427*^9, {3.703515618771706*^9, 3.703515692311277*^9}, {
   3.703529935872023*^9, 3.7035299615616302`*^9}, {3.703530003612434*^9, 
   3.703530039664319*^9}, {3.703540756923761*^9, 3.703540762521003*^9}, {
   3.703540795300215*^9, 
   3.703540881638014*^9}},ExpressionUUID->"ee5ec768-c04b-4fca-ba1b-\
c5bf5c6d9587"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$FEExtraResources", "=", "True"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Unprotect", "/@", 
   RowBox[{"{", 
    RowBox[{"FrontEndResource", ",", "FrontEndResourceString"}], "}"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FrontEndResource", "[", "\n", "\t", 
     RowBox[{"k_String", "?", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"!", 
         RowBox[{"KeyMemberQ", "[", 
          RowBox[{"$FETrListing", ",", "#"}], "]"}]}], "&"}], ")"}]}], "\n", 
     "\t", "]"}], "/;", 
    RowBox[{"TrueQ", "@", "$FEExtraResources"}]}], ":=", "\n", "\t", 
   RowBox[{"FrontEndResource", "[", 
    RowBox[{"$FETrBaseName", ",", "k"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"FrontEndResource", "/:", "\n", "\t", 
   RowBox[{
    RowBox[{"Set", "[", "\n", "\t\t", 
     RowBox[{
      RowBox[{"FrontEndResource", "[", "k_String", "]"}], ",", "\n", "\t\t", 
      "v_"}], "\n", "\t\t", "]"}], "/;", 
    RowBox[{"TrueQ", "@", "$FEExtraResources"}]}], ":=", "\n", "\t", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"FEAddResource", "[", 
      RowBox[{"k", ",", "v"}], "]"}], ";", "v"}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"FrontEndResourceString", "/:", "\n", "\t", 
   RowBox[{
    RowBox[{"Set", "[", "\n", "\t\t", 
     RowBox[{
      RowBox[{"FrontEndResourceString", "[", 
       RowBox[{"k_String", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"KeyMemberQ", "[", 
           RowBox[{"$FETrListing", ",", "#"}], "]"}], "&"}], ")"}]}], "]"}], 
      ",", "\n", "\t\t", "v_"}], "\n", "\t\t", "]"}], "/;", 
    RowBox[{"TrueQ", "@", "$FEExtraResources"}]}], ":=", "\n", "\t", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"FEAddResource", "[", 
      RowBox[{"k", ",", 
       RowBox[{"ToString", "@", "v"}]}], "]"}], ";", 
     RowBox[{"FrontEndResourceString", "[", "k", "]"}]}], ")"}]}], 
  ";"}], "\n", 
 RowBox[{"FrontEndResource", "/:", "\n", "\t", 
  RowBox[{"Unset", "[", 
   RowBox[{"FrontEndResource", "[", "k_String", "]"}], "]"}], ":=", "\n", 
  "\t\t", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"FrontEndResource", "[", "k", "]"}], "=", "Inherited"}], ";"}], 
   ")"}]}], "\n", 
 RowBox[{"FrontEndResourceString", "/:", "\n", "\t", 
  RowBox[{"Unset", "[", "\n", "\t\t", 
   RowBox[{"FrontEndResourceString", "[", "\n", "\t\t\t", 
    RowBox[{"k_String", "?", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"KeyMemberQ", "[", 
        RowBox[{"$FETrListing", ",", "#"}], "]"}], "&"}], ")"}]}], "]"}], 
   "\n", "\t\t", "]"}], ":=", "\n", "\t\t", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"FrontEndResourceString", "[", "k", "]"}], "=", "Inherited"}], 
    ";"}], ")"}]}], "\n", 
 RowBox[{
  RowBox[{"Protect", "/@", 
   RowBox[{"{", 
    RowBox[{"FrontEndResource", ",", "FrontEndResourceString"}], "}"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.7034877438116837`*^9, 3.703487892040945*^9}, 
   3.7034884049009542`*^9, {3.7034898251632853`*^9, 3.7034899181192217`*^9}, 
   3.703490653075286*^9, {3.703490803578802*^9, 3.70349085378551*^9}, 
   3.703490887113009*^9, {3.70351342226814*^9, 
   3.70351349269657*^9}},ExpressionUUID->"bd6ad262-d496-4dc3-8855-\
b4742600faaa"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Keys\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.703511084584683*^9, 
  3.703511085211192*^9}},ExpressionUUID->"0af4b640-31fa-453d-b207-\
7d9018ab8f27"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$FEKeyEventsDirectory", "=", "\n", "\t", "$FETemporaryResources"}],
   ";"}]], "CodeInput",
 CellChangeTimes->{{3.703537575948268*^9, 3.703537590713458*^9}, 
   3.7035416637517853`*^9, 
   3.7066436155786247`*^9},ExpressionUUID->"fbd387ad-768d-4338-bbb4-\
8d9316c2dcd0"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$FEKeyEvents", ":=", "\n", "\t", 
   RowBox[{"Replace", "[", 
    RowBox[{"$feKeyEvents", ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"Except", "[", "_Association", "]"}], ":>", "\n", "\t\t\t", 
      RowBox[{"Set", "[", 
       RowBox[{"$feKeyEvents", ",", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"Begin", "[", "\"\<System`\>\"", "]"}], ";", "\n", "\t", 
         "\t", "\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"End", "[", "]"}], ";", "#"}], ")"}], "&"}], "[", "\n", 
          "\t\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"Replace", "[", "\n", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"ToExpression", "[", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{
                "FrontEndResourceString", "[", "\"\<KeyEventTranslations\>\"",
                  "]"}], ",", "\n", "\t\t\t\t\t\t\t", "StandardForm", ",", 
                "\n", "\t\t\t\t\t\t\t", "HoldComplete"}], "\n", 
               "\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"Item", "[", 
                RowBox[{"k_", ",", "a_"}], "]"}], "\[RuleDelayed]", "\n", 
               "\t\t\t\t\t\t\t", 
               RowBox[{"(", 
                RowBox[{"k", "\[RuleDelayed]", 
                 RowBox[{"HoldComplete", "[", "a", "]"}]}], ")"}]}], ",", 
              "\n", "\t\t\t\t\t\t", "3"}], "]"}], "//", "ReleaseHold"}], "//", 
           RowBox[{"Apply", "[", "Association", "]"}]}], "\n", "\t\t\t\t\t", 
          "]"}]}]}], "\n", "\t\t\t\t", "]"}]}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"$FEKeyEvents", "/:", "\n", "\t", 
   RowBox[{"Unset", "[", "$FEKeyEvents", "]"}], ":=", "\n", "\t\t", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Clear", "@", "$feKeyEvents"}], ";", 
     RowBox[{"FEResetKeyEvents", "[", "]"}]}], ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$FEKeyEvents", "/:", "\n", "\t", 
   RowBox[{"Set", "[", 
    RowBox[{"$FEKeyEvents", ",", "a_Association"}], "]"}], ":=", "\n", "\t\t", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"$feKeyEvents", "=", "a"}], ";", 
     RowBox[{"feKeyEventExport", "[", "]"}], ";", "a"}], ")"}]}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.7035110918417873`*^9, 3.703511139303102*^9}, {
   3.7035114697650127`*^9, 3.703511505241014*^9}, {3.7035115971806*^9, 
   3.703511680780806*^9}, 3.703512203735585*^9, {3.703512528671166*^9, 
   3.703512534878459*^9}, {3.703513302272471*^9, 3.703513344428587*^9}, {
   3.703513618141377*^9, 3.703513735867543*^9}, {3.7035137950617313`*^9, 
   3.703513831436063*^9}, {3.706648568676333*^9, 3.706648667958845*^9}, {
   3.7066487025631733`*^9, 3.7066487366526814`*^9}, 
   3.706659765038014*^9},ExpressionUUID->"cc5dd65f-50ea-412c-b008-\
f8616e33d03b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"feKeyEventExport", "[", "]"}], ":=", "\n", "\t", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t", 
     RowBox[{
      RowBox[{
      "$FEResourceDirectory", "=", "\n", "\t\t\t", "$FEKeyEventsDirectory"}], 
      ",", "\n", "\t\t", 
      RowBox[{"$ContextPath", "=", "\n", "\t\t\t", 
       RowBox[{"Prepend", "[", 
        RowBox[{"$ContextPath", ",", "\"\<FrontEnd`\>\""}], "]"}]}]}], "\n", 
     "\t\t", "}"}], ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Begin", "[", "\"\<System`\>\"", "]"}], ";", "\n", "\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"End", "[", "]"}], ";", "#"}], ")"}], "&"}], "@", "\n", 
      "\t\t\t", 
      RowBox[{"FEAddResource", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"\"\<KeyEventTranslations\>\"", "->", "\n", "\t\t\t\t\t", 
         RowBox[{"{", "\n", "\t\t\t\t\t\t", 
          RowBox[{
           RowBox[{"Switch", "[", 
            RowBox[{
            "$OperatingSystem", ",", "\n", "\t", "\t\t\t\t\t\t ", 
             "\"\<MacOSX\>\"", ",", "\n", "\t", "\t\t\t\t\t\t \t", 
             "\"\<Macintosh\>\"", ",", "\n", "\t", "\t\t\t\t\t\t ", 
             "\"\<Windows\>\"", ",", "\n", "\t", "\t\t\t\t\t\t \t", 
             "\"\<Windows\>\"", ",", "\n", "\t", "\t\t\t\t\t\t ", 
             "\"\<Unix\>\"", ",", "\n", "\t", "\t\t\t\t\t\t \t", 
             "\"\<X\>\""}], "]"}], ",", "\n", "\t\t\t\t\t\t", 
           "\"\<KeyEventTranslations\>\""}], "\n", "\t\t\t\t\t\t", "}"}]}], 
        ",", "\n", "\t\t\t\t", 
        RowBox[{
        "\"\<EventTranslations[{\\n\\t``\\n\\t}]\>\"", "~", "TemplateApply", 
         "~", "\n", "\t\t\t\t\t", 
         RowBox[{"StringRiffle", "[", "\n", "\t\t\t\t\t\t", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{"ToString", ",", "\n", "\t", "\t\t\t\t\t\t", 
             RowBox[{"ReleaseHold", "@", "\n", "\t", "\t\t\t\t\t\t\t", 
              RowBox[{"Replace", "[", "\n", "\t", "\t", "\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"Hold", "@", 
                 RowBox[{"Evaluate", "@", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                  RowBox[{"Normal", "@", "$FEKeyEvents"}]}]}], ",", 
                RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"Rule", "|", "RuleDelayed"}], ")"}], "[", 
                   RowBox[{"k_", ",", 
                    RowBox[{
                    RowBox[{"HoldComplete", "[", "v_", "]"}], "|", "v_"}]}], 
                   "]"}], ":>", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                  RowBox[{
                  "RuleCondition", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"ToString", "[", 
                    RowBox[{
                    RowBox[{"Unevaluated", "@", 
                    RowBox[{"Item", "[", 
                    RowBox[{"k", ",", "v"}], "]"}]}], ",", "InputForm"}], 
                    "]"}], ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", "True"}], 
                   "\n", "\t\t\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
                 "\t\t\t\t\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t\t\t\t\t",
                 "2"}], "]"}]}]}], "\n", "\t", "\t\t\t\t\t\t", "]"}], ",", 
           "\n", "\t\t\t\t\t\t", "\"\<,\\n\\t\>\""}], "\n", "\t\t\t\t\t\t", 
          "]"}]}]}], "\n", "\t\t\t\t", "]"}]}]}]}], "\n", "\t\t", 
   "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.703511171873562*^9, 3.703511247032218*^9}, {
   3.703511372141358*^9, 3.703511400491008*^9}, {3.703511851318725*^9, 
   3.7035118663447857`*^9}, {3.703511988226617*^9, 3.7035120343751097`*^9}, {
   3.703513067106926*^9, 3.703513080727693*^9}, {3.703513860372069*^9, 
   3.703513861579158*^9}, {3.7035140654656143`*^9, 3.703514104610333*^9}, {
   3.70351424903966*^9, 3.7035142952408247`*^9}, {3.7035143907695303`*^9, 
   3.7035144191696463`*^9}, {3.70351450881523*^9, 3.703514581242981*^9}, {
   3.703514636658206*^9, 3.703514639233082*^9}, {3.703514669885437*^9, 
   3.703514759578648*^9}, {3.703514813674474*^9, 3.703514815960148*^9}, {
   3.7035152174077682`*^9, 3.703515296048409*^9}, {3.703515386041173*^9, 
   3.703515399838442*^9}, 3.703541663763151*^9, {3.706643599162068*^9, 
   3.7066436007199297`*^9}, 3.7066483738332167`*^9, {3.706648779978918*^9, 
   3.706648815643952*^9}, 
   3.7066597681116257`*^9},ExpressionUUID->"a9a8279b-661d-4826-be00-\
82b96623ed45"],

Cell[BoxData[
 RowBox[{
  RowBox[{"keyEventListing", "[", "k_", "]"}], ":=", "\n", "\t", 
  RowBox[{
   RowBox[{"KeyMap", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"ReplaceAll", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"s_Symbol", "?", 
        RowBox[{"(", "\n", "\t\t\t\t", 
         RowBox[{"Function", "[", 
          RowBox[{"Null", ",", "\n", "\t", "\t\t\t\t", 
           RowBox[{
            RowBox[{"Context", "[", "#", "]"}], "===", "$Context"}], ",", 
           "\n", "\t", "\t\t\t\t", "HoldFirst"}], "\n", "\t", "\t\t\t\t", 
          "]"}], "\n", "\t", "\t\t\t", ")"}]}], ":>", "\n", "\t", "\t\t\t", 
       RowBox[{"RuleCondition", "[", "\n", "\t", "\t\t\t\t", 
        RowBox[{
         RowBox[{"Symbol", "[", 
          RowBox[{"\"\<FrontEnd`\>\"", "<>", 
           RowBox[{"SymbolName", "@", 
            RowBox[{"Unevaluated", "[", "s", "]"}]}]}], "]"}], ",", "\n", 
         "\t", "\t\t\t\t", "True"}], "\n", "\t", "\t\t\t\t", "]"}]}], "\n", 
      "\t", "\t\t\t", "]"}], "@*", "\n", "\t\t\t", 
     RowBox[{"Replace", "[", 
      RowBox[{"{", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"key_String", ":>", "\n", "\t\t\t\t\t", 
         RowBox[{"FrontEnd`KeyEvent", "[", "key", "]"}]}], ",", "\n", 
        "\t\t\t\t", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"key_", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"Modifiers", "->", "modifiers_"}], ")"}], "|", 
            "modifiers_"}]}], "}"}], ":>", "\n", "\t\t\t\t\t", 
         RowBox[{"FrontEnd`KeyEvent", "[", 
          RowBox[{"key", ",", "\n", "\t\t\t\t\t\t", 
           RowBox[{"Modifiers", "->", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Begin", "[", "\"\<System`\>\"", "]"}], ";", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"End", "[", "]"}], ";", "#"}], ")"}], "&"}], "@", 
               "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{"ToExpression", "@", 
                RowBox[{"Flatten", "@", 
                 RowBox[{"{", "modifiers", "}"}]}]}]}]}], ")"}]}]}], "\n", 
          "\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t", "}"}], "]"}]}], "\n", 
    "\t\t", "]"}], "@", "\n", "\t\t", 
   RowBox[{"Association", "[", "k", "]"}]}]}]], "CodeInput",
 CellChangeTimes->{{3.703512390461815*^9, 3.703512400301613*^9}, {
   3.703512572852806*^9, 3.703512630088846*^9}, {3.703512679178214*^9, 
   3.7035127727621*^9}, {3.7035149311030684`*^9, 3.70351493415795*^9}, 
   3.706659774924087*^9},ExpressionUUID->"aced90f9-85d6-43a9-b2f2-\
978906bfac4b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FEKeyEventAdd", "[", "\n", "\t", 
    RowBox[{"k", ":", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"_RuleDelayed", "|", "_Rule"}], ")"}], "|", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"_RuleDelayed", "|", "_Rule"}], ")"}], ".."}], "}"}]}]}], 
    "\n", "\t", "]"}], ":=", "\n", "\t", 
   RowBox[{"(", "\n", "\t\t", 
    RowBox[{
     RowBox[{"$FEKeyEvents", "=", "\n", "\t\t\t", 
      RowBox[{"Join", "[", "\n", "\t", "\t\t\t", 
       RowBox[{"$FEKeyEvents", ",", "\n", "\t", "\t", "\t\t", 
        RowBox[{"keyEventListing", "[", "k", "]"}]}], "\n", "\t\t\t\t", 
       "]"}]}], ";"}], "\n", "\t\t", ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FEKeyEventDrop", "[", "k_", "]"}], ":=", "\n", "\t", 
   RowBox[{"(", "\n", "\t\t", 
    RowBox[{
     RowBox[{"KeyDropFrom", "[", 
      RowBox[{"$FEKeyEvents", ",", "\n", "\t\t\t", 
       RowBox[{"Keys", "@", 
        RowBox[{"keyEventListing", "@", 
         RowBox[{"AssociationMap", "[", 
          RowBox[{
           RowBox[{"Null", "&"}], ",", 
           RowBox[{"Flatten", "@", 
            RowBox[{"{", "k", "}"}]}]}], "]"}]}]}]}], "\n", "\t\t\t", "]"}], 
     ";"}], 
    RowBox[{"(*", "\n", "\t\t", 
     RowBox[{"feKeyEventExport", "[", "]"}], "*)"}], "\n", "\t\t", ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"FEResetKeyEvents", "[", "]"}], ":=", "\n", "\t", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t", 
     RowBox[{
     "$FEResourceDirectory", "=", "\n", "\t\t\t", "$FETemporaryResources"}], 
     "\n", "\t\t", "}"}], ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Begin", "[", "\"\<System`\>\"", "]"}], ";", "\n", "\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"End", "[", "]"}], ";", "#"}], ")"}], "&"}], "@", "\n", 
      "\t\t\t", 
      RowBox[{"FEAddResource", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"\"\<KeyEventTranslations\>\"", "->", "\n", "\t\t\t\t\t", 
         RowBox[{"{", "\n", "\t\t\t\t\t\t", 
          RowBox[{
           RowBox[{"Switch", "[", 
            RowBox[{
            "$OperatingSystem", ",", "\n", "\t", "\t\t\t\t\t\t ", 
             "\"\<MacOSX\>\"", ",", "\n", "\t", "\t\t\t\t\t\t \t", 
             "\"\<Macintosh\>\"", ",", "\n", "\t", "\t\t\t\t\t\t ", 
             "\"\<Windows\>\"", ",", "\n", "\t", "\t\t\t\t\t\t \t", 
             "\"\<Windows\>\"", ",", "\n", "\t", "\t\t\t\t\t\t ", 
             "\"\<Unix\>\"", ",", "\n", "\t", "\t\t\t\t\t\t \t", 
             "\"\<X\>\""}], "]"}], ",", "\n", "\t\t\t\t\t\t", 
           "\"\<KeyEventTranslations\>\""}], "\n", "\t\t\t\t\t\t", "}"}]}], 
        ",", "\n", "\t\t\t\t", "Inherited"}], "\n", "\t\t\t\t", "]"}]}], ";", 
     "\n", "\t\t", 
     RowBox[{"$feKeyEvents", "//", "Clear"}], ";"}]}], "\n", "\t\t", 
   "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.703511147351796*^9, 3.7035111523422537`*^9}, {
   3.703511429617696*^9, 3.703511431271617*^9}, {3.7035118770886583`*^9, 
   3.703511904965639*^9}, {3.70351195308148*^9, 3.703511985911928*^9}, 
   3.703512062834298*^9, {3.703512123710348*^9, 3.7035121586857233`*^9}, {
   3.7035122127029467`*^9, 3.703512225804631*^9}, {3.703512260720354*^9, 
   3.7035125039748783`*^9}, {3.703513230274702*^9, 3.7035132863690863`*^9}, {
   3.703513360126791*^9, 3.7035133774054747`*^9}, {3.70351389248923*^9, 
   3.703513902528631*^9}, {3.703515327233699*^9, 3.703515353890915*^9}, 
   3.703515406129621*^9, 3.703541663771782*^9, 
   3.7066597783410187`*^9},ExpressionUUID->"f649bb59-8ca6-4563-bb67-\
5ca07c182abb"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]MenuTR\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.703511084584683*^9, 3.703511085211192*^9}, {
  3.7035184445398483`*^9, 
  3.7035184467933187`*^9}},ExpressionUUID->"640a82a2-ff3b-4321-9499-\
87595caeb006"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$FEMenuSetupDirectory", "=", "\n", "\t", "$FETemporaryResources"}],
   ";"}]], "CodeInput",
 CellChangeTimes->{{3.7035375975529757`*^9, 3.703537600542901*^9}, 
   3.70354166377631*^9},ExpressionUUID->"eca13e04-e746-4859-a6dc-\
45ecdf6e1e1d"],

Cell[CellGroupData[{

Cell["Spooling", "CodeSubsubsubsection",
 CellChangeTimes->{{3.7035359754808817`*^9, 
  3.7035359770307083`*^9}},ExpressionUUID->"a0c374dd-2f52-4605-b0ff-\
91d090e07c90"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$feMSDelimiterKey", ":=", "\n", "\t", 
   RowBox[{"CreateUUID", "[", "\"\<Delimiter-\>\"", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$feMSItemsKey", ":=", "\n", "\t", 
   RowBox[{"CreateUUID", "[", "\"\<Items-\>\"", "]"}]}], ";"}]}], "CodeInput",
 
 CellChangeTimes->{{3.703525160455318*^9, 3.7035252064254303`*^9}, {
  3.703526546348275*^9, 3.703526560669389*^9}, {3.703526818083548*^9, 
  3.703526824358308*^9}},ExpressionUUID->"ff446bee-05b7-4181-a38d-\
fa0d0cdb8b40"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"feUnspoolMenuExpr", "[", "e_", "]"}], ":=", "\n", "\t", 
   RowBox[{"Replace", "[", 
    RowBox[{"e", ",", "\n", "\t\t", 
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"MenuItem", "[", 
         RowBox[{"l_", ",", "arg_", ",", "ops___"}], "]"}], ":>", "\n", 
        "\t\t\t\t", 
        RowBox[{"(", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"{", "ops", "}"}], ",", "_System`MenuKey"}], "]"}], ",",
             "\n", "\t\t\t\t\t\t", 
            RowBox[{"{", 
             RowBox[{"l", ",", 
              RowBox[{"FirstCase", "[", 
               RowBox[{
                RowBox[{"{", "ops", "}"}], ",", "_System`MenuKey"}], "]"}]}], 
             "}"}], ",", "\n", "\t\t\t\t\t\t", "l"}], "\n", "\t\t\t\t\t\t", 
           "]"}], "\[Rule]", 
          RowBox[{"<|", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"\"\<Command\>\"", ":>", "arg"}], ",", "\n", "\t\t\t\t\t", 
            RowBox[{"\"\<Options\>\"", "\[Rule]", 
             RowBox[{"{", "ops", "}"}]}]}], "\n", "\t\t\t\t\t", "|>"}]}], 
         ")"}]}], ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"t", ":", 
           RowBox[{"AlternateItems", "|", "LinkedItems"}]}], ")"}], "[", 
         RowBox[{"items_", ",", "ops___"}], "]"}], ":>", "\n", "\t\t\t\t", 
        RowBox[{"(", "\n", "\t\t\t\t\t", 
         RowBox[{"RuleCondition", "[", "\n", "\t\t\t\t\t\t", 
          RowBox[{
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"rules", "=", 
               RowBox[{"feUnspoolMenuExpr", "/@", "items"}]}], "}"}], ",", 
             "\n", "\t", "\t\t\t\t\t\t", 
             RowBox[{"With", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"a", "=", 
                 RowBox[{"Alternatives", "@@", 
                  RowBox[{"Map", "[", 
                   RowBox[{"Association", ",", "rules"}], "]"}]}]}], "}"}], 
               ",", "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{"$feMSItemsKey", "\[Rule]", 
                RowBox[{"<|", "\n", "\t\t\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"\"\<Type\>\"", "\[Rule]", "t"}], ",", "\n", 
                  "\t\t\t\t\t\t\t\t\t", 
                  RowBox[{"\"\<Items\>\"", "\[Rule]", "a"}], ",", "\n", 
                  "\t\t\t\t\t\t\t\t\t", 
                  RowBox[{"\"\<Options\>\"", "\[Rule]", 
                   RowBox[{"{", "ops", "}"}]}]}], "\n", "\t", 
                 "\t\t\t\t\t\t\t\t", "|>"}]}]}], "\n", "\t", "\t\t\t\t\t\t\t",
               "]"}]}], "\n", "\t", "\t\t\t\t\t\t", "]"}], ",", "\n", 
           "\t\t\t\t\t\t", "True"}], "\n", "\t\t\t\t\t\t", "]"}], ")"}]}], 
       ",", "\n", "\t\t\t", 
       RowBox[{"Delimiter", "\[RuleDelayed]", 
        RowBox[{"(", "\n", "\t\t\t\t", 
         RowBox[{
         "$feMSDelimiterKey", "\[Rule]", "\n", "\t\t\t\t\t", "Delimiter"}], 
         "\n", "\t\t\t\t\t", ")"}]}], ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"t", ":", 
           RowBox[{"Menu", "|", "HelpMenu"}]}], ")"}], "[", 
         RowBox[{"l_", ",", "items_", ",", "ops___"}], "]"}], ":>", "\n", 
        "\t\t\t\t", 
        RowBox[{"RuleCondition", "[", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"rules", "=", 
              RowBox[{"feUnspoolMenuExpr", "/@", "items"}]}], "}"}], ",", 
            "\n", "\t\t\t\t\t\t", 
            RowBox[{"With", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"a", "=", 
                RowBox[{"Association", "[", "rules", "]"}]}], "}"}], ",", 
              "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"l", "\[Rule]", 
               RowBox[{"<|", "\n", "\t\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"\"\<Type\>\"", "\[Rule]", "t"}], ",", "\n", "\t", 
                 "\t", "\t", "\t\t\t\t\t", 
                 RowBox[{"\"\<Items\>\"", "\[Rule]", "a"}], ",", "\n", 
                 "\t\t\t\t\t\t\t\t", 
                 RowBox[{"\"\<Options\>\"", "\[Rule]", 
                  RowBox[{"{", "ops", "}"}]}]}], "\n", "\t\t\t\t\t\t\t\t", 
                "|>"}]}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}], "\n", 
           "\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t", "True"}], "\n", 
         "\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t", "}"}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"feRespoolMenuExpr", "[", "a_Alternatives", "]"}], ":=", "\n", 
   "\t", 
   RowBox[{"Flatten", "[", 
    RowBox[{"feRespoolMenuExpr", "/@", 
     RowBox[{"Apply", "[", 
      RowBox[{"List", ",", "a"}], "]"}]}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"feRespoolMenuExpr", "[", "a_Association", "]"}], ":=", "\n", "\t", 
   RowBox[{"KeyValueMap", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{
      RowBox[{"Replace", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"#", ",", "#2"}], "}"}], ",", 
        RowBox[{"{", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"_", ",", "Delimiter"}], "}"}], ":>", "\n", "\t\t\t\t", 
           "Delimiter"}], ",", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"l_", ",", 
             RowBox[{"m_Association", "?", 
              RowBox[{"(", 
               RowBox[{"KeyMemberQ", "[", "\"\<Items\>\"", "]"}], ")"}]}]}], 
            "}"}], ":>", "\n", "\t\t\t\t", 
           RowBox[{"Switch", "[", 
            RowBox[{
             RowBox[{"m", "[", "\"\<Type\>\"", "]"}], ",", "\n", "\t\t\t\t\t", 
             RowBox[{"AlternateItems", "|", "LinkedItems"}], ",", "\n", 
             "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"m", "[", "\"\<Type\>\"", "]"}], "[", "\n", 
              "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"feRespoolMenuExpr", "@", "\n", "\t\t\t\t\t\t\t\t", 
                RowBox[{"m", "[", "\"\<Items\>\"", "]"}]}], ",", "\n", 
               "\t\t\t\t\t\t\t", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"Lookup", "[", 
                 RowBox[{"m", ",", "\"\<Options\>\"", ",", 
                  RowBox[{"{", "}"}]}], "]"}]}]}], "\n", "\t\t\t\t\t\t\t", 
              "]"}], ",", "\n", "\t\t\t\t\t", "_", ",", "\n", "\t\t\t\t\t\t", 
             
             RowBox[{
              RowBox[{"Lookup", "[", 
               RowBox[{"m", ",", "\"\<Type\>\"", ",", "Menu"}], "]"}], "[", 
              "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"l", ",", "\n", "\t\t\t\t\t\t\t\t", 
               RowBox[{
               "feRespoolMenuExpr", "@", "\n", "\t", "\t", "\t", 
                "\t\t\t\t\t\t", 
                RowBox[{"m", "[", "\"\<Items\>\"", "]"}]}], ",", "\n", "\t", 
               "\t\t\t\t\t\t\t", 
               RowBox[{"Sequence", "@@", 
                RowBox[{"Lookup", "[", 
                 RowBox[{"m", ",", "\"\<Options\>\"", ",", 
                  RowBox[{"{", "}"}]}], "]"}]}]}], "\n", "\t\t\t\t\t\t\t", 
              "]"}]}], "\n", "\t\t\t\t", "]"}]}], ",", "\n", "\t\t\t", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"l_", ",", 
             RowBox[{"m_Association", "?", 
              RowBox[{"(", 
               RowBox[{"KeyMemberQ", "[", "\"\<Command\>\"", "]"}], ")"}]}]}],
             "}"}], ":>", "\n", "\t\t\t\t", 
           RowBox[{"With", "[", 
            RowBox[{
             RowBox[{"{", "\n", "\t\t\t\t\t", 
              RowBox[{
               RowBox[{"c", "=", 
                RowBox[{"Extract", "[", 
                 RowBox[{"m", ",", "\"\<Command\>\"", ",", "Hold"}], "]"}]}], 
               ",", "\n", "\t\t\t\t\t", 
               RowBox[{"o", "=", 
                RowBox[{"Sequence", "@@", 
                 RowBox[{"m", "[", "\"\<Options\>\"", "]"}]}]}]}], "\n", 
              "\t\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t\t", 
             RowBox[{"Replace", "[", 
              RowBox[{"c", ",", "\n", "\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"Hold", "[", "cmd_", "]"}], ":>", "\n", 
                "\t\t\t\t\t\t\t", 
                RowBox[{"MenuItem", "[", "\n", "\t\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"ListQ", "@", "l"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"First", "@", "l"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t", "l"}], "\n", "\t\t\t\t\t\t\t\t\t", 
                   "]"}], ",", "\n", "\t\t\t\t\t\t\t\t", "cmd", ",", "\n", 
                  "\t\t\t\t\t\t\t\t", "o"}], "\n", "\t\t\t\t\t\t\t\t", 
                 "]"}]}]}], "\n", "\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t",
             "]"}]}]}], "\n", "\t\t\t", "}"}]}], "]"}], "&"}], ",", "\n", 
     "\t", "a"}], "\n", "\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.703516779020422*^9, 3.703516987350499*^9}, {
   3.703517319770322*^9, 3.703517381002256*^9}, 3.703522797970549*^9, {
   3.703523501932373*^9, 3.7035235085696993`*^9}, {3.703523602546959*^9, 
   3.70352375898484*^9}, {3.7035238258495483`*^9, 3.703523863853085*^9}, {
   3.703523911439506*^9, 3.703523939734872*^9}, {3.703523979194001*^9, 
   3.7035239983183727`*^9}, {3.703524029616332*^9, 3.703524084787548*^9}, {
   3.703524238829831*^9, 3.703524269604905*^9}, {3.703525050117272*^9, 
   3.703525125229444*^9}, 3.7035251592377367`*^9, 3.7035252090193768`*^9, {
   3.703526321981797*^9, 3.703526455012721*^9}, {3.7035265276955442`*^9, 
   3.703526539795569*^9}, 3.7035265727396727`*^9, {3.703526614602787*^9, 
   3.70352673463654*^9}, {3.703526808449411*^9, 3.703526841215432*^9}, {
   3.70352725416999*^9, 3.703527259441956*^9}, {3.7035273017898293`*^9, 
   3.703527320807181*^9}, {3.703528773816959*^9, 3.7035288379485617`*^9}, {
   3.7035290011204023`*^9, 3.703529019693379*^9}, {3.703529268632923*^9, 
   3.70352927130276*^9}, {3.703529315761248*^9, 3.703529350900815*^9}, {
   3.7035294024036427`*^9, 3.703529409137713*^9}, {3.703529548765683*^9, 
   3.703529556814189*^9}, {3.703530352695364*^9, 3.7035303614558992`*^9}, {
   3.7035320296230392`*^9, 3.7035320357332163`*^9}, 3.703532084676708*^9, {
   3.703532153014686*^9, 3.703532189040134*^9}, {3.703532253778573*^9, 
   3.703532257552937*^9}, {3.703534478350996*^9, 3.703534507701147*^9}, {
   3.7035345536608257`*^9, 3.703534602353178*^9}, {3.70353591471432*^9, 
   3.703535953274948*^9}, {3.70353743583815*^9, 3.703537495915416*^9}, {
   3.712024919682122*^9, 
   3.712024923314348*^9}},ExpressionUUID->"55b1a193-3a00-4baf-a3a4-\
6530fb4e527a"]
}, Closed]],

Cell[CellGroupData[{

Cell["$FEMenuSetup", "CodeSubsubsubsection",
 CellChangeTimes->{
  3.703535986177709*^9},ExpressionUUID->"089ec315-011d-4519-b57a-\
a8bfa9f69224"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"BooleanQ", "@", "$FEMenuExportOnEdit"}]}], ",", "\n", "\t", 
    RowBox[{"$FEMenuExportOnEdit", "=", "True"}]}], "\n", "\t", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"$FEMenuSetup", ":=", "\n", "\t", 
   RowBox[{"Replace", "[", 
    RowBox[{"$feMenuSetup", ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"Except", "[", "_Association", "]"}], ":>", "\n", "\t\t\t", 
      RowBox[{"Set", "[", 
       RowBox[{"$feMenuSetup", ",", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"Begin", "[", "\"\<System`\>\"", "]"}], ";", "\n", "\t", 
         "\t", "\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"End", "[", "]"}], ";", "#"}], ")"}], "&"}], "[", "\n", 
          "\t\t\t\t\t", 
          RowBox[{"Association", "@", "\n", "\t\t\t\t\t\t", 
           RowBox[{"feUnspoolMenuExpr", "@", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{"FrontEndResource", "[", "\"\<MenuSetup\>\"", "]"}]}]}], 
          "\n", "\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t", "]"}]}]}], "\n", 
    "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$FEMenuSetup", "/:", "\n", "\t", 
   RowBox[{"Unset", "[", "$FEMenuSetup", "]"}], ":=", "\n", "\t\t", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Clear", "@", "$feMenuSetup"}], ";", "\n", "\t\t\t", 
     RowBox[{"FEResetMenuSetup", "[", "]"}], ";"}], "\n", "\t\t\t", ")"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"$FEMenuSetup", "/:", "\n", "\t", 
   RowBox[{"Set", "[", 
    RowBox[{"$FEMenuSetup", ",", "a_Association"}], "]"}], ":=", "\n", "\t\t", 
   RowBox[{"(", "\n", "\t\t\t", 
    RowBox[{
     RowBox[{"$feMenuSetup", "=", "a"}], ";", "\n", "\t\t\t", 
     RowBox[{"If", "[", 
      RowBox[{"$FEMenuExportOnEdit", ",", 
       RowBox[{"feMenuSetupExport", "[", "]"}]}], "]"}], ";", "\n", "\t\t\t", 
     "a"}], "\n", "\t\t\t", ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$FEMenuSetup", "/:", "\n", "\t", 
   RowBox[{"Set", "[", 
    RowBox[{
     RowBox[{"$FEMenuSetup", "[", 
      RowBox[{"part___", ",", "key_"}], "]"}], ",", "val_"}], "]"}], ":=", 
   "\n", "\t\t", 
   RowBox[{"(", "\n", "\t\t\t", 
    RowBox[{"$FEMenuSetup", ";", "\n", "\t\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Length", "@", 
         RowBox[{"{", "part", "}"}]}], ">", "0"}], ",", "\n", "\t\t\t\t", 
       RowBox[{"Do", "[", "\n", "\t\t\t\t\t", 
        RowBox[{
         RowBox[{"With", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"p", "=", 
             RowBox[{"Sequence", "@@", 
              RowBox[{"Take", "[", 
               RowBox[{
                RowBox[{"{", "part", "}"}], ",", "n"}], "]"}]}]}], "}"}], ",",
            "\n", "\t\t\t\t\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"Not", "@", 
              RowBox[{"AssociationQ", "@", 
               RowBox[{"$feMenuSetup", "[", "p", "]"}]}]}], ",", "\n", 
             "\t\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"$feMenuSetup", "[", "p", "]"}], "=", "\n", 
              "\t\t\t\t\t\t\t\t", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Last", "@", 
                  RowBox[{"{", "p", "}"}]}], "===", "\"\<Items\>\""}], ",", 
                "\n", "\t\t\t\t\t\t\t\t\t", 
                RowBox[{"<|", "|>"}], ",", "\n", "\t\t\t\t\t\t\t\t\t", 
                RowBox[{"<|", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"\"\<Type\>\"", "\[Rule]", "Menu"}], ",", "\n", 
                  "\t\t\t\t\t\t\t\t\t\t", 
                  RowBox[{"\"\<Items\>\"", "\[Rule]", 
                   RowBox[{"<|", "|>"}]}]}], "\n", "\t\t\t\t\t\t\t\t\t\t", 
                 "|>"}]}], "\n", "\t\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", 
            "\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t", "]"}], ",", "\n",
          "\t\t\t\t\t", 
         RowBox[{"{", 
          RowBox[{"n", ",", 
           RowBox[{"Length", "@", 
            RowBox[{"{", "part", "}"}]}]}], "}"}]}], "\n", "\t\t\t\t\t", 
        "]"}]}], "\n", "\t\t\t\t", "]"}], ";", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"$feMenuSetup", "[", 
       RowBox[{"part", ",", "key"}], "]"}], "=", "val"}], ";", "\n", "\t\t\t", 
     RowBox[{"If", "[", 
      RowBox[{"$FEMenuExportOnEdit", ",", 
       RowBox[{"feMenuSetupExport", "[", "]"}]}], "]"}], ";", "\n", "\t\t\t", 
     "val"}], "\n", "\t\t\t", ")"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$FEMenuSetup", "/:", "\n", "\t", 
   RowBox[{"Unset", "[", 
    RowBox[{"$FEMenuSetup", "[", 
     RowBox[{"part___", ",", "key_"}], "]"}], "]"}], ":=", "\n", "\t\t", 
   RowBox[{"(", "\n", "\t\t\t", 
    RowBox[{"$FEMenuSetup", ";", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"$feMenuSetup", "[", 
       RowBox[{"part", ",", "key"}], "]"}], "=."}], ";", "\n", "\t\t\t", 
     RowBox[{"If", "[", 
      RowBox[{"$FEMenuExportOnEdit", ",", 
       RowBox[{"feMenuSetupExport", "[", "]"}]}], "]"}], ";"}], "\n", 
    "\t\t\t", ")"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.7035110918417873`*^9, 3.703511139303102*^9}, {
   3.7035114697650127`*^9, 3.703511505241014*^9}, {3.7035115971806*^9, 
   3.703511680780806*^9}, 3.703512203735585*^9, {3.703512528671166*^9, 
   3.703512534878459*^9}, {3.703513302272471*^9, 3.703513344428587*^9}, {
   3.703513618141377*^9, 3.703513735867543*^9}, {3.7035137950617313`*^9, 
   3.703513831436063*^9}, {3.703516173139309*^9, 3.703516211883451*^9}, {
   3.703516520887208*^9, 3.703516638295326*^9}, 3.703516669976313*^9, {
   3.703516707570207*^9, 3.703516759189321*^9}, {3.7035169619705133`*^9, 
   3.7035169719978867`*^9}, 3.703521935971305*^9, {3.703522188704368*^9, 
   3.7035222178626957`*^9}, 3.703522679235382*^9, {3.7035251344538097`*^9, 
   3.703525140114637*^9}, {3.703525594741026*^9, 3.703525742991959*^9}, {
   3.703526944707387*^9, 3.703526986156288*^9}, {3.703528682272088*^9, 
   3.7035286832040567`*^9}, {3.703529037041473*^9, 3.703529044253564*^9}, {
   3.703529115775961*^9, 3.703529128267386*^9}, 3.703529178859041*^9, 
   3.703530091088306*^9, {3.703531359580739*^9, 3.703531364368976*^9}, {
   3.703534780741287*^9, 3.703534899356683*^9}, {3.703536062419538*^9, 
   3.70353626892935*^9}, {3.703536302176405*^9, 3.703536305778942*^9}, {
   3.703536457273944*^9, 3.7035365208330107`*^9}, {3.703536661339356*^9, 
   3.7035366721875677`*^9}, {3.703536799859602*^9, 3.7035368088475857`*^9}, {
   3.703536859862052*^9, 3.703536863129015*^9}, {3.703536934652179*^9, 
   3.703536958728243*^9}, 3.703537155656375*^9, 3.703537221086977*^9, {
   3.703537377782485*^9, 3.703537408650793*^9}, {3.703537611752923*^9, 
   3.703537617182815*^9}, {3.703537824065977*^9, 3.7035378503124638`*^9}, 
   3.706659780983384*^9},ExpressionUUID->"1938a8dd-b625-4d0f-a7bb-\
d2f5a51213b0"]
}, Closed]],

Cell[CellGroupData[{

Cell["Export", "CodeSubsubsubsection",
 CellChangeTimes->{{3.703535994288149*^9, 
  3.703535996350026*^9}},ExpressionUUID->"b0515c34-be89-4c2f-972f-\
9dca8bd9d847"],

Cell[BoxData[
 RowBox[{
  RowBox[{"feMenuSetupExport", "[", "]"}], ":=", "\n", "\t", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t", 
     RowBox[{
     "$FEResourceDirectory", "=", "\n", "\t\t\t", "$FEMenuSetupDirectory"}], 
     "\n", "\t\t", "}"}], ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Begin", "[", "\"\<System`\>\"", "]"}], ";", "\n", "\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"End", "[", "]"}], ";", "#"}], ")"}], "&"}], "@", "\n", 
      "\t\t\t", 
      RowBox[{"FEAddResource", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"\"\<MenuSetup\>\"", "->", "\n", "\t\t\t\t\t", 
         RowBox[{"{", "\n", "\t\t\t\t\t\t", 
          RowBox[{
           RowBox[{"Switch", "[", 
            RowBox[{
            "$OperatingSystem", ",", "\n", "\t", "\t\t\t\t\t\t ", 
             "\"\<MacOSX\>\"", ",", "\n", "\t", "\t\t\t\t\t\t \t", 
             "\"\<Macintosh\>\"", ",", "\n", "\t", "\t\t\t\t\t\t ", 
             "\"\<Windows\>\"", ",", "\n", "\t", "\t\t\t\t\t\t \t", 
             "\"\<Windows\>\"", ",", "\n", "\t", "\t\t\t\t\t\t ", 
             "\"\<Unix\>\"", ",", "\n", "\t", "\t\t\t\t\t\t \t", 
             "\"\<X\>\""}], "]"}], ",", "\n", "\t\t\t\t\t\t", 
           "\"\<MenuSetup\>\""}], "\n", "\t\t\t\t\t\t", "}"}]}], ",", "\n", 
        "\t\t\t\t", 
        RowBox[{"First", "@", 
         RowBox[{"FrontEndExecute", "@", "\n", "\t\t\t\t\t", 
          RowBox[{"ExportPacket", "[", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"Cell", "[", 
             RowBox[{
              RowBox[{"BoxData", "@", "\n", "\t", "\t\t\t\t\t\t", 
               RowBox[{"First", "@", "\n", "\t", "\t", "\t\t\t\t\t\t", 
                RowBox[{
                "NewlineateCodeRecursive", "[", "\n", "\t", "\t", "\t", 
                 "\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"First", "@", 
                   RowBox[{"feRespoolMenuExpr", "@", "$FEMenuSetup"}]}], ",", 
                  "\n", "\t", "\t", "\t", "\t", "\t\t\t\t\t", 
                  RowBox[{"_Menu", "|", "_List"}]}], "\n", 
                 "\t\t\t\t\t\t\t\t\t", "]"}]}]}], ",", "\n", "\t\t\t\t\t\t\t", 
              RowBox[{"ExportAutoReplacements", "\[Rule]", 
               RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
                RowBox[{"ParentList", ",", "\n", "\t\t\t\t\t\t\t\t", 
                 RowBox[{
                 "\"\<\[Infinity]\>\"", "\[Rule]", "\"\<Infinity\>\""}], ",", 
                 "\n", "\t\t\t\t\t\t\t\t", 
                 RowBox[{"\"\<\.14\>\"", "\[Rule]", "\"\< \>\""}]}], "\n", 
                "\t\t\t\t\t\t\t\t", "}"}]}]}], "\n", "\t\t\t\t\t\t\t", "]"}], 
            ",", "\n", "\t\t\t\t\t\t", "\"\<InputText\>\""}], "\n", 
           "\t\t\t\t\t\t", "]"}]}]}], ",", "\n", "\t\t\t\t", 
        RowBox[{"TemplateApply", "\[Rule]", "False"}], ",", "\n", "\t\t\t\t", 
        
        RowBox[{"InputForm", "\[Rule]", "False"}]}], "\n", "\t\t\t\t", 
       "]"}]}], ";", "\n", "\t\t", 
     RowBox[{"FrontEndExecute", "@", "\n", "\t\t\t", 
      RowBox[{"FrontEnd`ResetMenusPacket", "[", 
       RowBox[{"{", 
        RowBox[{"Automatic", ",", "Automatic"}], "}"}], "]"}]}]}]}], "\n", 
   "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.703511171873562*^9, 3.703511247032218*^9}, {
   3.703511372141358*^9, 3.703511400491008*^9}, {3.703511851318725*^9, 
   3.7035118663447857`*^9}, {3.703511988226617*^9, 3.7035120343751097`*^9}, {
   3.703513067106926*^9, 3.703513080727693*^9}, {3.703513860372069*^9, 
   3.703513861579158*^9}, {3.7035140654656143`*^9, 3.703514104610333*^9}, {
   3.70351424903966*^9, 3.7035142952408247`*^9}, {3.7035143907695303`*^9, 
   3.7035144191696463`*^9}, {3.70351450881523*^9, 3.703514581242981*^9}, {
   3.703514636658206*^9, 3.703514639233082*^9}, {3.703514669885437*^9, 
   3.703514759578648*^9}, {3.703514813674474*^9, 3.703514815960148*^9}, {
   3.7035152174077682`*^9, 3.703515296048409*^9}, {3.703515386041173*^9, 
   3.703515399838442*^9}, {3.703516224660112*^9, 3.703516236820175*^9}, {
   3.703518823921835*^9, 3.7035189191680593`*^9}, {3.703519057553033*^9, 
   3.703519068625751*^9}, {3.703521078008623*^9, 3.703521081596862*^9}, {
   3.70352111493921*^9, 3.70352113870665*^9}, {3.703521173234584*^9, 
   3.703521195847582*^9}, {3.70352701206468*^9, 3.703527021858694*^9}, {
   3.7035273631640987`*^9, 3.703527363712945*^9}, {3.703527600853015*^9, 
   3.703527637534637*^9}, 3.703529235032428*^9, {3.7035300963376093`*^9, 
   3.703530107278232*^9}, {3.703530457122024*^9, 3.70353045882448*^9}, {
   3.703532718544775*^9, 3.703532735614414*^9}, {3.703533784720731*^9, 
   3.703533787268012*^9}, {3.703535362859373*^9, 3.703535368680669*^9}, 
   3.703539561481967*^9, 
   3.7066597831752863`*^9},ExpressionUUID->"38a2b22d-4ee3-48b5-aade-\
f6790611b4f5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"feMenuSetupObject", "[", 
    RowBox[{"cmd_", ",", "ops___"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Switch", "[", 
    RowBox[{
     RowBox[{"Unevaluated", "[", "cmd", "]"}], ",", "\n", "\t\t", "Delimiter",
      ",", "\n", "\t\t\t", "Delimiter", ",", "\n", "\t\t", 
     RowBox[{"_MenuItem", "|", "_Menu", "|", "_Association"}], ",", "\n", 
     "\t\t\t", "cmd", ",", "\n", "\t\t", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"_Menu", "|", "_MenuItem", "|", "Delimiter"}], ")"}], "..."}],
       "}"}], ",", "\n", "\t\t\t", 
     RowBox[{"<|", "\n", "\t\t\t\t", 
      RowBox[{
       RowBox[{"\"\<Items\>\"", "\[Rule]", "cmd"}], ",", "\n", "\t\t\t\t", 
       RowBox[{"\"\<Options\>\"", "\[Rule]", 
        RowBox[{"{", "ops", "}"}]}]}], "\n", "\t\t\t\t", "|>"}], ",", "\n", 
     "\t\t", "_", ",", "\n", "\t\t\t", 
     RowBox[{"<|", "\n", "\t\t\t\t", 
      RowBox[{
       RowBox[{"\"\<Command\>\"", "\[RuleDelayed]", "cmd"}], ",", "\n", 
       "\t\t\t\t", 
       RowBox[{"\"\<Options\>\"", "\[Rule]", 
        RowBox[{"{", "ops", "}"}]}]}], "\n", "\t\t\t\t", "|>"}]}], "\n", 
    "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"feMenuSetupObject", "~", "SetAttributes", "~", "HoldFirst"}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.703522481644554*^9, 3.703522503219708*^9}, {
   3.703522597360818*^9, 3.703522656630975*^9}, {3.7035226897427063`*^9, 
   3.703522701723048*^9}, 3.703522745624881*^9, {3.7035261130783463`*^9, 
   3.703526117116746*^9}},ExpressionUUID->"58f9a387-2bf9-4ac0-8517-\
e07aea35a7b5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"feMenuPath", "[", "path__", "]"}], ":=", "\n", "\t", 
  RowBox[{
   RowBox[{"Append", "[", "\"\<Items\>\"", "]"}], "@", "\n", "\t\t", 
   RowBox[{"Riffle", "[", "\n", "\t\t\t", 
    RowBox[{
     RowBox[{"Switch", "[", 
      RowBox[{
       RowBox[{"{", "path", "}"}], ",", "\n", "\t", "\t", "\t\t", 
       RowBox[{"{", 
        RowBox[{"\"\<Mathematica\>\"", ",", "___"}], "}"}], ",", "\n", "\t", 
       "\t\t\t\t", 
       RowBox[{"{", "path", "}"}], ",", "\n", "\t", "\t\t\t", "_", ",", "\n", 
       "\t", "\t\t\t\t", 
       RowBox[{"{", 
        RowBox[{"\"\<Mathematica\>\"", ",", "path"}], "}"}]}], "\n", "\t", 
      "\t\t\t", "]"}], ",", "\n", "\t", "\t\t", "\"\<Items\>\""}], 
    "]"}]}]}]], "CodeInput",
 CellChangeTimes->{{3.703525480042367*^9, 3.703525491314528*^9}, {
  3.70352578263414*^9, 
  3.7035258186434727`*^9}},ExpressionUUID->"4226cf14-fff7-4a84-b17b-\
01d174b708f7"]
}, Closed]],

Cell[CellGroupData[{

Cell["Get / Add / Drop", "CodeSubsubsubsection",
 CellChangeTimes->{{3.703536006567788*^9, 
  3.703536013437598*^9}},ExpressionUUID->"5cdd5259-63c7-40da-8b6b-\
a0dea1b4e4d3"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuSetupGet", "[", 
    RowBox[{"{", 
     RowBox[{"path___String", ",", 
      RowBox[{"key", ":", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"_String", ",", "___"}], "}"}], "|", "_String", "|", 
        "_Integer"}]}]}], "}"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", "=", 
       RowBox[{"Sequence", "@@", 
        RowBox[{"feMenuPath", "[", "path", "]"}]}]}], "}"}], ",", "\n", 
     "\t\t", 
     RowBox[{"Replace", "[", 
      RowBox[{
       RowBox[{"$FEMenuSetup", "[", "p", "]"}], ",", "\n", "\t\t\t", 
       RowBox[{"a_Association", ":>", "\n", "\t\t\t\t", 
        RowBox[{"Which", "[", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"IntegerQ", "@", "key"}], ",", "\n", "\t\t\t\t\t\t", 
          RowBox[{
           RowBox[{"Normal", "[", "a", "]"}], "[", 
           RowBox[{"[", "key", "]"}], "]"}], ",", "\n", "\t\t\t\t\t", 
          RowBox[{"StringQ", "@", "key"}], ",", "\n", "\t\t\t\t\t\t", 
          RowBox[{"Lookup", "[", 
           RowBox[{"a", ",", "key", ",", "\n", "\t\t\t\t\t\t\t ", 
            RowBox[{
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"Length", "[", "#", "]"}], ">", "0"}], ",", "\n", 
                "\t\t\t\t\t\t\t \t", 
                RowBox[{"First", "@", "#"}], ",", "\n", "\t\t\t\t\t\t\t \t", 
                RowBox[{"Missing", "[", 
                 RowBox[{"\"\<KeyAbsent\>\"", ",", "key"}], "]"}]}], "\n", 
               "\t\t\t\t\t\t\t \t", "]"}], "&"}], "@", "\n", 
             "\t\t\t\t\t\t\t \t", 
             RowBox[{"KeySelect", "[", 
              RowBox[{"a", ",", "\n", "\t\t\t\t\t\t\t \t\t", 
               RowBox[{"MatchQ", "[", 
                RowBox[{"{", 
                 RowBox[{"key", ",", "___"}], "}"}], "]"}]}], "\n", "\t", 
              "\t\t\t\t\t \t\t\t", "]"}]}]}], "\n", "\t\t\t\t\t \t\t", "]"}], 
          ",", "\n", "\t\t\t\t\t", "True", ",", "\n", "\t\t\t\t\t\t", 
          RowBox[{"Lookup", "[", 
           RowBox[{
            RowBox[{"$FEMenuSetup", "[", "p", "]"}], ",", " ", 
            RowBox[{"Key", "[", "key", "]"}]}], "]"}]}], "\n", "\t\t\t\t\t ", 
         "]"}]}]}], "\n", "\t\t\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuSetupGet", "[", "path_String", "]"}], ":=", "\n", "\t", 
   RowBox[{"FEMenuSetupGet", "@", 
    RowBox[{"{", "path", "}"}]}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.703535569474514*^9, 3.703535591431506*^9}, {
  3.70353570665661*^9, 3.703535726803637*^9}, {3.703535765470693*^9, 
  3.703535769402334*^9}, {3.706658535762209*^9, 3.7066585903254757`*^9}, {
  3.7066603251858187`*^9, 3.706660386827149*^9}, {3.716839559702669*^9, 
  3.7168397647846518`*^9}},ExpressionUUID->"4a73a741-0409-44de-a139-\
8564c2280691"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuSetupAdd", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"path__String", ",", 
       RowBox[{"pos", ":", 
        RowBox[{"_Integer", "|", "None"}], ":", "None"}]}], "}"}], ",", "\n", 
     "\t", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Rule", "|", "RuleDelayed"}], ")"}], "[", 
      RowBox[{"lab_", ",", "cmd_"}], "]"}], ",", "\n", "\t", "ops___"}], "\n",
     "\t", "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"p", "=", "\n", "\t\t\t", 
        RowBox[{"Sequence", "@@", 
         RowBox[{"feMenuPath", "[", "path", "]"}]}]}], ",", "\n", "\t\t", 
       RowBox[{"lab2", "=", "\n", "\t\t\t", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"MemberQ", "[", 
           RowBox[{
            RowBox[{"{", "ops", "}"}], ",", "_System`MenuKey"}], "]"}], ",", 
          "\n", "\t\t\t\t", 
          RowBox[{"{", 
           RowBox[{"lab", ",", 
            RowBox[{"FirstCase", "[", 
             RowBox[{
              RowBox[{"{", "ops", "}"}], ",", "_System`MenuKey"}], "]"}]}], 
           "}"}], ",", "\n", "\t\t\t\t", "lab"}], "\n", "\t\t\t\t", "]"}]}]}],
       "\n", "\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"pos", "===", "None"}], ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"$FEMenuSetup", "[", 
          RowBox[{"p", ",", "lab2"}], "]"}], "=", "\n", "\t\t\t\t", 
         RowBox[{"feMenuSetupObject", "[", 
          RowBox[{"cmd", ",", "ops"}], "]"}]}], ";"}], ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{
         RowBox[{"$FEMenuSetup", "[", "p", "]"}], "=", "\n", "\t\t\t\t", 
         RowBox[{"Insert", "[", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"$FEMenuSetup", "[", "p", "]"}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{"lab2", "->", 
            RowBox[{"feMenuSetupObject", "[", 
             RowBox[{"cmd", ",", "ops"}], "]"}]}], ",", "\n", "\t\t\t\t\t", 
           "pos"}], "\n", "\t\t\t\t\t", "]"}]}], ";"}]}], "\n", "\t\t\t", 
      "]"}]}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuSetupAdd", "[", "\n", "\t", 
    RowBox[{"p_String", ",", "\n", "\t", 
     RowBox[{"r", ":", 
      RowBox[{"(", 
       RowBox[{"_Rule", "|", "_RuleDelayed"}], ")"}]}], ",", "\n", "\t", 
     "ops___"}], "\n", "\t", "]"}], ":=", "\n", "\t", 
   RowBox[{"FEMenuSetupAdd", "[", 
    RowBox[{
     RowBox[{"{", "p", "}"}], ",", "r", ",", "ops"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuSetupAdd", "[", "\n", "\t", 
    RowBox[{"p_", ",", "\n", "\t", "Delimiter"}], "\n", "\t", "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"FEMenuSetupAdd", "[", 
    RowBox[{"p", ",", "\n", "\t\t", 
     RowBox[{"$feMSDelimiterKey", "\[Rule]", "Delimiter"}]}], "\n", "\t\t", 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"FEMenuSetupAdd", "~", "SetAttributes", "~", "HoldRest"}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.703511147351796*^9, 3.7035111523422537`*^9}, {
   3.703511429617696*^9, 3.703511431271617*^9}, {3.7035118770886583`*^9, 
   3.703511904965639*^9}, {3.70351195308148*^9, 3.703511985911928*^9}, 
   3.703512062834298*^9, {3.703512123710348*^9, 3.7035121586857233`*^9}, {
   3.7035122127029467`*^9, 3.703512225804631*^9}, {3.703512260720354*^9, 
   3.7035125039748783`*^9}, {3.703513230274702*^9, 3.7035132863690863`*^9}, {
   3.703513360126791*^9, 3.7035133774054747`*^9}, {3.70351389248923*^9, 
   3.703513902528631*^9}, {3.703515327233699*^9, 3.703515353890915*^9}, 
   3.703515406129621*^9, {3.7035217776185913`*^9, 3.703521779056432*^9}, {
   3.703521899575783*^9, 3.703522158305958*^9}, {3.703522226899953*^9, 
   3.7035224792103786`*^9}, {3.703522524852922*^9, 3.70352253363202*^9}, {
   3.703522571787858*^9, 3.7035226084579573`*^9}, {3.703522726467909*^9, 
   3.703522917484206*^9}, {3.703523089014872*^9, 3.703523106760807*^9}, 
   3.70352318191066*^9, {3.703523224049488*^9, 3.7035232981429663`*^9}, 
   3.7035252238129063`*^9, {3.703525384105204*^9, 3.7035255043643703`*^9}, {
   3.703526135230764*^9, 3.703526136998845*^9}, {3.70352616833348*^9, 
   3.703526170111108*^9}, {3.703527668974551*^9, 3.703527670604267*^9}, {
   3.703535051464121*^9, 3.7035350519424677`*^9}, {3.703535799201117*^9, 
   3.703535806082275*^9}, {3.7066604409948397`*^9, 
   3.706660556542306*^9}},ExpressionUUID->"ea7e62b7-224a-4bfd-88a1-\
52d30369f6b2"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"FEMenuSetupDrop", "[", "\n", "\t", 
    RowBox[{"{", 
     RowBox[{"path___String", ",", 
      RowBox[{"pos", ":", 
       RowBox[{"(", 
        RowBox[{"_String", "|", 
         RowBox[{"{", 
          RowBox[{"_String", ",", "___"}], "}"}], "|", "_Integer", "|", 
         "None"}], ")"}], ":", "None"}]}], "}"}], "\n", "\t", "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", "=", 
       RowBox[{"Sequence", "@@", 
        RowBox[{"Most", "@", 
         RowBox[{"feMenuPath", "[", "path", "]"}]}]}]}], "}"}], ",", "\n", 
     "\t\t", 
     RowBox[{"Switch", "[", 
      RowBox[{"pos", ",", "\n", "\t\t\t", "None", ",", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"$FEMenuSetup", "[", "p", "]"}], "=."}], ",", "\n", "\t\t\t", 
       
       RowBox[{"_String", "|", "_List"}], ",", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"$FEMenuSetup", "[", 
         RowBox[{"p", ",", "pos"}], "]"}], "=."}], ",", "\n", "\t\t\t", 
       "_Integer", ",", "\n", "\t\t\t\t", 
       RowBox[{"With", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"base", "=", 
           RowBox[{"$FEMenuSetup", "[", "p", "]"}]}], "}"}], ",", "\n", 
         "\t\t\t\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"AssociationQ", "@", "#"}], ",", "\n", "\t", "\t", 
             "\t\t\t\t", 
             RowBox[{
              RowBox[{"$FEMenuSetup", "[", "p", "]"}], "=", "#"}], ",", "\n", 
             "\t", "\t", "\t\t\t\t", "#"}], "\n", "\t", "\t", "\t\t\t\t", 
            "]"}], "&"}], "@", "\n", "\t\t\t\t\t\t", 
          RowBox[{"With", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"k", "=", 
              RowBox[{
               RowBox[{"Keys", "[", 
                RowBox[{"base", "[", "\"\<Items\>\"", "]"}], "]"}], "[", 
               RowBox[{"[", "pos", "]"}], "]"}]}], "}"}], ",", "\n", 
            "\t\t\t\t\t\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"KeyMemberQ", "[", 
               RowBox[{
                RowBox[{"base", "[", "\"\<Items\>\"", "]"}], ",", "k"}], 
               "]"}], ",", "\n", "\t\t\t\t\t\t\t\t", 
              RowBox[{"ReplacePart", "[", 
               RowBox[{"base", ",", "\n", "\t", "\t", "\t\t\t\t\t\t\t", 
                RowBox[{
                "\"\<Items\>\"", "->", "\n", "\t", "\t", "\t\t\t\t\t\t\t\t", 
                 RowBox[{"KeyDrop", "[", 
                  RowBox[{
                   RowBox[{"base", "[", "\"\<Items\>\"", "]"}], ",", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"ListQ", "@", "k"}], ",", 
                    RowBox[{"{", "k", "}"}], ",", "k"}], "]"}]}], "]"}]}]}], 
               "\n", "\t\t\t\t\t\t\t\t\t", "]"}], ",", "\n", 
              "\t\t\t\t\t\t\t\t", "$Failed"}], "\n", "\t\t\t\t\t\t\t\t", 
             "]"}]}], "\n", "\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t\t", 
        "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"FEMenuSetupDrop", "[", "path_String", "]"}], ":=", "\n", "\t", 
  RowBox[{"FEMenuSetupDrop", "[", 
   RowBox[{"{", "path", "}"}], "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.7035231431546164`*^9, 3.703523150567831*^9}, {
  3.7035231888224382`*^9, 3.70352321330604*^9}, {3.703523324027478*^9, 
  3.703523374294681*^9}, {3.703525510623065*^9, 3.7035255154589653`*^9}, {
  3.7035377722269707`*^9, 3.703537781978229*^9}, {3.703537979072019*^9, 
  3.7035379827196093`*^9}, {3.706658665856194*^9, 3.706658878843719*^9}, {
  3.7066598806496563`*^9, 3.706659881030674*^9}, {3.706659919910756*^9, 
  3.706660058132635*^9}, {3.706660137028183*^9, 
  3.706660156326909*^9}},ExpressionUUID->"ffd2fd5c-ee0a-441f-a1bc-\
71482aeec4c9"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Reset", "CodeSubsubsubsection",
 CellChangeTimes->{{3.703537787011888*^9, 
  3.70353778787376*^9}},ExpressionUUID->"2c95735d-48cf-4d81-9f0e-\
c34f588c70e6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FEResetMenuSetup", "[", "]"}], ":=", "\n", "\t", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "\n", "\t\t", 
     RowBox[{
     "$FEResourceDirectory", "=", "\n", "\t\t\t", "$FETemporaryResources"}], 
     "\n", "\t\t", "}"}], ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Begin", "[", "\"\<System`\>\"", "]"}], ";", "\n", "\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"End", "[", "]"}], ";", "#"}], ")"}], "&"}], "@", "\n", 
      "\t\t\t", 
      RowBox[{"FEAddResource", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"\"\<MenuSetup\>\"", "->", "\n", "\t\t\t\t\t", 
         RowBox[{"{", "\n", "\t\t\t\t\t\t", 
          RowBox[{
           RowBox[{"Switch", "[", 
            RowBox[{
            "$OperatingSystem", ",", "\n", "\t", "\t\t\t\t\t\t ", 
             "\"\<MacOSX\>\"", ",", "\n", "\t", "\t\t\t\t\t\t \t", 
             "\"\<Macintosh\>\"", ",", "\n", "\t", "\t\t\t\t\t\t ", 
             "\"\<Windows\>\"", ",", "\n", "\t", "\t\t\t\t\t\t \t", 
             "\"\<Windows\>\"", ",", "\n", "\t", "\t\t\t\t\t\t ", 
             "\"\<Unix\>\"", ",", "\n", "\t", "\t\t\t\t\t\t \t", 
             "\"\<X\>\""}], "]"}], ",", "\n", "\t\t\t\t\t\t", 
           "\"\<MenuSetup\>\""}], "\n", "\t\t\t\t\t\t", "}"}]}], ",", "\n", 
        "\t\t\t\t", "Inherited"}], "\n", "\t\t\t\t", "]"}]}], ";", "\n", 
     "\t\t", 
     RowBox[{"$feMenuSetup", "//", "Clear"}], ";", "\n", "\t\t", 
     RowBox[{"FrontEndExecute", "@", 
      RowBox[{"ResetMenusPacket", "[", 
       RowBox[{"{", 
        RowBox[{"Automatic", ",", "Automatic"}], "}"}], "]"}]}]}]}], "\n", 
   "\t\t", "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.703511147351796*^9, 3.7035111523422537`*^9}, {
   3.703511429617696*^9, 3.703511431271617*^9}, {3.7035118770886583`*^9, 
   3.703511904965639*^9}, {3.70351195308148*^9, 3.703511985911928*^9}, 
   3.703512062834298*^9, {3.703512123710348*^9, 3.7035121586857233`*^9}, {
   3.7035122127029467`*^9, 3.703512225804631*^9}, {3.703512260720354*^9, 
   3.7035125039748783`*^9}, {3.703513230274702*^9, 3.7035132863690863`*^9}, {
   3.703513360126791*^9, 3.7035133774054747`*^9}, {3.70351389248923*^9, 
   3.703513902528631*^9}, {3.703515327233699*^9, 3.703515353890915*^9}, 
   3.703515406129621*^9, {3.7035217776185913`*^9, 3.703521779056432*^9}, {
   3.703521899575783*^9, 3.703522158305958*^9}, {3.703522226899953*^9, 
   3.7035224792103786`*^9}, {3.703522524852922*^9, 3.70352253363202*^9}, {
   3.703522571787858*^9, 3.7035226084579573`*^9}, {3.703522726467909*^9, 
   3.703522917484206*^9}, {3.703523089014872*^9, 3.703523106760807*^9}, {
   3.70352964160152*^9, 3.7035296416511593`*^9}, 3.7035416637864103`*^9, {
   3.7066597558403597`*^9, 
   3.706659759330203*^9}},ExpressionUUID->"3a0d78d6-9fdc-4628-ba45-\
14fdf177b829"]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], 
  ";"}]], "InputSection",ExpressionUUID->"0084645b-cda3-4f99-a811-\
a3c442fbcc22"]
}, Open  ]],

Cell["", "SectionSeparator",ExpressionUUID->"5ab29383-dfad-4008-a0fa-\
90bcad911327"]
},
WindowSize->{747, 755},
WindowMargins->{{203, Automatic}, {43, Automatic}},
TaggingRules->{
 "DocuToolsSettingsInternal" -> {"$CondensedBlogMenus" -> "True"}, 
  "LinkTrails" -> "", "SearchTextTranslated" -> ""},
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->Notebook[{
   Cell[
    StyleData[
    StyleDefinitions -> 
     FrontEnd`FileName[{"BTools"}, "CodePackage.nb", CharacterEncoding -> 
       "UTF-8"]]]}, Visible -> False, FrontEndVersion -> 
  "11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, 2018)", 
  StyleDefinitions -> "PrivateStylesheetFormatting.nb"]
]

