Notebook[{

Cell[CellGroupData[{
Cell["Google APIs", "CodeSection",
 CellChangeTimes->{{3.704148043325519*^9, 3.7041480459627943`*^9}, {
  3.704148264721705*^9, 
  3.704148294043994*^9}},ExpressionUUID->"a1b613ec-67ea-410c-ba14-\
992bdc5920da"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$GoogleAPIUsername", "::", "usage"}], "=", "\n", "\t", 
   "\"\<The username for current Google API access\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"$GAClientID", "::", "usage"}], "=", "\n", "\t", 
   "\"\<The client ID for current Google API access\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"$GAClientSecret", "::", "usage"}], "=", "\n", "\t", 
   "\"\<The client ID for current Google API access\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GoogleAPIClearAuth", "::", "usage"}], "=", "\n", "\t", 
   "\"\<Clears authentication data for the current user\>\""}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.704638266956401*^9, 3.704638285972198*^9}, {
  3.704652519166007*^9, 3.7046525613626013`*^9}, {3.704658529287072*^9, 
  3.70465855334135*^9}, {3.733853942627339*^9, 3.73385394312897*^9}, {
  3.7348356501808653`*^9, 3.734835676420382*^9}, {3.7348395581135197`*^9, 
  3.734839575838336*^9}, {3.734839627603506*^9, 
  3.734839638073118*^9}},ExpressionUUID->"38412446-373e-49a9-b53c-\
7039a3dbdcee"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"GASetUseKeychain", "::", "usage"}], "=", "\"\<\>\""}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GASetUsername", "::", "usage"}], "=", "\"\<\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GASetClientID", "::", "usage"}], "=", "\"\<\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GASetClientSecret", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GAResetUsername", "::", "usage"}], "=", "\"\<\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GAResetClientID", "::", "usage"}], "=", "\"\<\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GAResetClientSecret", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GASetUseKeychain", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}]}], "CodeInput",ExpressionUUID->"0ddf1bd0-8aa5-4776-9710-c78c613f5b36"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$GAVersion", "::", "usage"}], "=", "\"\<\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"$GAParameters", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.734837971304584*^9, 3.7348379821577797`*^9}, {
  3.734838466064691*^9, 3.7348384686065273`*^9}, {3.734842958599639*^9, 
  3.734842975796277*^9}},ExpressionUUID->"cf254611-5691-48fd-ae22-\
a3c38cfd951d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GAOAuthenticate", "::", "usage"}], "=", "\"\<\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GAOAuthTokenData", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"$GAOAuthToken", "::", "usage"}], "=", "\"\<\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GAOAuthCodeURL", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GAOAuthRefreshRequest", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.734834376360695*^9, 3.734834408013446*^9}, {
  3.734834501940177*^9, 3.734834520292181*^9}, {3.734840344920082*^9, 
  3.734840387135412*^9}, {3.734840609149057*^9, 
  3.734840611923552*^9}},ExpressionUUID->"fb391bb3-8a1a-4c65-8a97-\
b8ed48893a14"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$GAParamMap", "::", "usage"}], "=", "\"\<\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GAPrepParams", "::", "usage"}], "=", "\"\<\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GARequest", "::", "usage"}], "=", "\"\<\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GACall", "::", "usage"}], "=", "\"\<\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"$GAApplyRequests", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.734834376360695*^9, 3.734834408013446*^9}, {
  3.734834501940177*^9, 3.734834520292181*^9}, {3.734840344920082*^9, 
  3.734840352333815*^9}, {3.7348429790862722`*^9, 
  3.73484297973913*^9}},ExpressionUUID->"55949fcf-56c8-4d12-b85f-\
4ba18492015a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"$GAActiveHead", "::", "usage"}], "=", "\"\<\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GAParse", "::", "usage"}], "=", "\"\<\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GAErrorString", "::", "usage"}], "=", "\"\<\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"$GALastError", "::", "usage"}], "=", "\"\<\>\""}], 
  ";"}]}], "CodeInput",
 CellChangeTimes->{{3.734834376360695*^9, 3.734834408013446*^9}, {
  3.734834501940177*^9, 3.734834520292181*^9}, {3.734840344920082*^9, 
  3.734840346450817*^9}, {3.7348416685443573`*^9, 3.734841676090475*^9}, {
  3.734841865373603*^9, 
  3.734841870159006*^9}},ExpressionUUID->"a4261445-6a38-4d97-a5d1-\
feea9c80adb5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Begin", "[", "\"\<`Private`\>\"", "]"}], 
  ";"}]], "InputSection",ExpressionUUID->"7f191f15-9dd9-4039-b06f-\
c4923eabfa12"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Settings\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.734835202174489*^9, 
  3.734835203173402*^9}},ExpressionUUID->"437e5bf0-6880-4dc8-a200-\
ef6d7824c50d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$GASettings", "=", "\n", "\t", 
   RowBox[{"Replace", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Do", "[", "\n", "\t\t\t\t", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"FileExistsQ", "@", "f"}], ",", "\n", "\t", "\t\t\t\t", 
         RowBox[{
          RowBox[{"Return", "[", "\n", "\t", "\t\t\t\t\t", 
           RowBox[{"Replace", "[", 
            RowBox[{
             RowBox[{"Quiet", "@", 
              RowBox[{"Import", "@", "f"}]}], ",", "\n", "\t", "\t\t\t\t\t\t", 
             RowBox[{"{", " ", "\n", "\t", "\t\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{
                RowBox[{"o_", "?", "OptionQ"}], "\[RuleDelayed]", 
                RowBox[{"Association", "@", "o"}]}], ",", "\n", "\t", 
               "\t\t\t\t\t\t\t", 
               RowBox[{"_", "\[Rule]", 
                RowBox[{"<|", "|>"}]}]}], "\n", "\t", "\t\t\t\t\t\t\t", 
              "}"}]}], "\n", "\t", "\t\t\t\t\t\t", "]"}], "\n", "\t", 
           "\t\t\t\t\t", "]"}], ";", "\n", "\t", "\t\t\t\t", 
          RowBox[{"Break", "[", "]"}]}]}], "\n", "\t\t\t\t\t", "]"}], ",", 
       "\n", "\t\t\t", 
       RowBox[{"{", 
        RowBox[{"f", ",", "\n", "\t\t\t\t", 
         RowBox[{"{", "\n", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"PackageFilePath", "[", 
            RowBox[{
            "\"\<Private\>\"", ",", " ", "\"\<Config\>\"", ",", " ", 
             "\"\<GoogleConfig.m\>\""}], "]"}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{"PackageFilePath", "[", 
            RowBox[{
            "\"\<Private\>\"", ",", " ", "\"\<Config\>\"", ",", " ", 
             "\"\<GoogleConfig.wl\>\""}], "]"}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{"PackageFilePath", "[", 
            RowBox[{
            "\"\<Config\>\"", ",", " ", "\"\<Misc\>\"", ",", " ", 
             "\"\<GoogleConfig.m\>\""}], "]"}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{"PackageFilePath", "[", 
            RowBox[{
            "\"\<Config\>\"", ",", " ", "\"\<Misc\>\"", ",", " ", 
             "\"\<GoogleConfig.wl\>\""}], "]"}]}], "\n", "\t\t\t\t\t", 
          "}"}]}], "\n", "\t\t\t\t", "}"}]}], "\n", "\t\t\t", "]"}], ",", 
     "\n", "\t", "\t", 
     RowBox[{"Null", "\[Rule]", 
      RowBox[{"<|", "|>"}]}]}], "\n", "\t\t", "]"}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"98aa46ac-b701-4309-856e-283f62118162"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Parameters\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.704148832839199*^9, 3.704148835463719*^9}, {
  3.704630907646948*^9, 3.704630909507753*^9}, {3.704657797962008*^9, 
  3.704657804598514*^9}, {3.734839219145287*^9, 
  3.734839220367969*^9}},ExpressionUUID->"31e01d31-2633-4783-8605-\
54c6c5f5fda8"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Keys\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.704404697264196*^9, 
  3.704404697926406*^9}},ExpressionUUID->"a56bffad-a6db-458b-b35a-\
035989e0b993"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"$GoogleAPIUsernameName", "=", "\"\<Username\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$GAClientIDName", "=", "\"\<ClientID\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"$GAClientSecretName", "=", "\"\<ClientSecret\>\""}], 
  ";"}]}], "CodeInput",ExpressionUUID->"242cf951-404d-4f7f-8d9a-20d3fc3ed39d"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]SetUseKeychain\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"c5fe1ebb-1b83-4ed1-bc3c-20c24c49fdf6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GASetUseKeychain", "[", 
    RowBox[{"b", ":", 
     RowBox[{"True", "|", "False"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"$GAUseKeychain", "=", "b"}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"ae1bc3a9-9f02-449c-ad2d-1e9cfa7e5bd6"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]GACache\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,ExpressionUUID->"035bc8eb-311b-4467-8050-ec90605250ab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"getPasswordVal", "[", "key_", "]"}], ":=", "\n", "\t", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "$auth", "}"}], ",", "\n", "\t\t", 
    RowBox[{"PasswordDialog", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"Dynamic", "@", "$auth"}], ",", "\n", "\t\t\t", "key", ",", 
      "\n", "\t", "\t\t", "key", ",", "\n", "\t", "\t\t", 
      RowBox[{
      "\"\<PromptString\>\"", "->", "\n", "\t", "\t\t\t", 
       "\"\<Enter ``:\>\""}], ",", "\n", "\t", "\t\t", 
      RowBox[{"WindowTitle", "\[Rule]", "key"}], ",", "\n", "\t", "\t\t", 
      RowBox[{"FieldMasked", "\[Rule]", "False"}]}], "\n", "\t\t\t", "]"}]}], 
   "\n", "\t\t", 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"3365a45f-f114-42b8-998a-164cac261e24"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"FreeQ", "[", 
     RowBox[{
      RowBox[{"Attributes", "[", "$GACache", "]"}], ",", " ", 
      "ReadProtected"}], "]"}], ",", "\n", "\t", 
    RowBox[{"SetAttributes", "[", 
     RowBox[{"$GACache", ",", " ", "ReadProtected"}], "]"}]}], "\n", "\t", 
   "]"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"FreeQ", "[", 
     RowBox[{
      RowBox[{"Attributes", "[", "$GACache", "]"}], ",", " ", "Locked"}], 
     "]"}], ",", "\n", "\t", 
    RowBox[{"SetAttributes", "[", 
     RowBox[{"$GACache", ",", " ", "Locked"}], "]"}]}], "\n", "\t", "]"}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GACacheGet", "[", 
    RowBox[{"{", 
     RowBox[{"\"\<AccountData\>\"", ",", " ", "k___"}], "}"}], "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"$GACache", "[", 
    RowBox[{"StringJoin", "[", "k", "]"}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"GACacheGet", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\"\<AccountData\>\"", ",", " ", "k___"}], "}"}], ",", " ", 
    "True"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"Replace", "[", "\n", "\t\t", 
   RowBox[{
    RowBox[{"$GACache", "[", 
     RowBox[{"StringJoin", "[", "k", "]"}], "]"}], ",", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Except", "[", 
      RowBox[{"_String", "?", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"StringLength", "[", "#", "]"}], ">", "0"}], "&"}], ")"}]}],
       "]"}], ":>", "\n", "\t\t\t", 
     RowBox[{"Replace", "[", 
      RowBox[{
       RowBox[{"getPasswordVal", "[", 
        RowBox[{"StringRiffle", "[", 
         RowBox[{
          RowBox[{"{", "k", "}"}], ",", " ", "\"\</\>\""}], "]"}], "]"}], ",",
        "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"v_String", "?", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"StringLength", "[", "#", "]"}], ">", "0"}], "&"}], 
          ")"}]}], ":>", "\n", "\t\t\t\t\t", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"$GACache", "[", "k", "]"}], "=", "v"}], ")"}]}]}], "\n", 
      "\t\t\t\t", "]"}]}]}], "\n", "\t\t", 
   "]"}]}]}], \
"CodeInput",ExpressionUUID->"59dc1b39-56cf-439e-b498-d4b387f71eee"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]LoadParameter\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.734835493980485*^9, {3.734835918399094*^9, 3.734835919254702*^9}, {
   3.734837419767899*^9, 
   3.7348374271663933`*^9}},ExpressionUUID->"c3787765-daa0-4ca8-8382-\
1503ad4e6905"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"ValueQ", "@", "$GAUseKeychain"}]}], ",", "\n", "\t", 
    RowBox[{"$GAUseKeychain", "=", "\n", "\t\t", 
     RowBox[{"TrueQ", "@", 
      RowBox[{"$GASettings", "[", "\"\<UseKeychain\>\"", "]"}]}]}]}], "\n", 
   "\t", "]"}], 
  ";"}]], "CodeInput",ExpressionUUID->"6141625a-8651-4685-abc6-11d0108ead79"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$GACacheGetter", ":=", "\n", "\t", 
   RowBox[{"If", "[", 
    RowBox[{
    "$GAUseKeychain", ",", " ", "KeychainGet", ",", " ", "GACacheGet"}], 
    "]"}]}], ";"}]], \
"CodeInput",ExpressionUUID->"d696ebd4-edc5-43c8-a887-2d65de34a71d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GALoadParameter", "[", "key_", "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s", "=", "$GACacheGetter"}], "}"}], ",", "\n", "\t\t", 
     RowBox[{"Replace", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"s", "[", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
          "\"\<AccountData\>\"", ",", " ", "\"\<GoogleAPIs\>\"", ",", " ", 
           "key"}], "}"}], ",", " ", "True"}], "]"}], ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"Except", "[", 
         RowBox[{"_String", "?", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"StringLength", "@", "#"}], ">", "0"}], "&"}], ")"}]}], 
         "]"}], ":>", "\n", "\t\t\t\t", "None"}]}], "\n", "\t\t\t", "]"}]}], 
    "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GALoadParameter", "[", 
    RowBox[{"key1_", ",", " ", "key2_"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"Replace", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"$GACacheGetter", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "\"\<AccountData\>\"", ",", " ", "\"\<GoogleAPIs\>\"", ",", " ", 
         "key1", ",", " ", "key2"}], "}"}], ",", " ", "True"}], "]"}], ",", 
     "\n", "\t\t", 
     RowBox[{
      RowBox[{"Except", "[", 
       RowBox[{"_String", "?", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"StringLength", "@", "#"}], ">", "0"}], "&"}], ")"}]}], 
       "]"}], ":>", "\n", "\t\t\t", 
      RowBox[{"Replace", "[", 
       RowBox[{
        RowBox[{"KeychainGet", "[", "key1", "]"}], ",", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"Except", "[", 
          RowBox[{"_String", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"StringLength", "@", "#"}], ">", "0"}], "&"}], ")"}]}], 
          "]"}], "\[Rule]", "None"}]}], "\n", "\t\t\t\t", "]"}]}]}], "\n", 
    "\t\t", "]"}]}], 
  ";"}]}], "CodeInput",ExpressionUUID->"4428ec8c-34d6-4efb-957c-6504ca16f9a9"]\

}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Username\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.734835501265725*^9, 
  3.734835503120412*^9}},ExpressionUUID->"b8d26f27-f193-46a7-94e8-\
1b2113f4028e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GASetUsername", "[", "name_", "]"}], ":=", "\n", "\t", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"StringQ", "@", "name"}], "&&", "\n", "\t\t\t", 
      RowBox[{"StringMatchQ", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"StringTrim", "[", 
         RowBox[{"name", ",", " ", "\"\<@gmail.com\>\""}], "]"}], ",", " ", 
        "\n", "\t", "\t\t\t", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
          "WordCharacter", "|", "\"\<_\>\"", "|", "\"\<.\>\"", "|", 
           "\"\<-\>\""}], ")"}], ".."}]}], "\n", "\t", "\t\t\t", "]"}]}], ",",
      "\n", "\t\t", 
     RowBox[{"$GoogleAPIUsername", "=", "name"}], ",", "\n", "\t\t", 
     "$Failed"}], "\n", "\t\t", "]"}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"5e17fd28-1192-4121-9ff1-6e5aa883a620"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"MatchQ", "[", 
      RowBox[{
       RowBox[{"OwnValues", "[", "$GoogleAPIUsername", "]"}], ",", " ", 
       RowBox[{"{", 
        RowBox[{"_", "\[RuleDelayed]", 
         RowBox[{"(", 
          RowBox[{"_String", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"StringLength", "@", "#"}], ">", "0"}], "&"}], ")"}]}], 
          ")"}]}], "}"}]}], "]"}]}], ",", "\n", "\t", 
    RowBox[{"$GoogleAPIUsername", ":=", "\n", "\t\t", 
     RowBox[{"GALoadParameter", "[", "$GoogleAPIUsernameName", "]"}]}]}], 
   "\n", "\t", "]"}], 
  ";"}]], "CodeInput",ExpressionUUID->"42dc172d-1634-417d-bbe3-cf1c9add81c7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GAResetUsername", "[", "]"}], ":=", "\n", "\t", 
  RowBox[{"$GoogleAPIUsername", ":=", 
   RowBox[{
   "GALoadParameter", "[", "$GoogleAPIUsernameName", 
    "]"}]}]}]], \
"CodeInput",ExpressionUUID->"1a4efda6-fc58-4991-86fc-6fa20e91e658"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ClientID\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.734835501265725*^9, 
  3.734835510168262*^9}},ExpressionUUID->"7eb72df7-a250-41dd-9e34-\
113e440b7470"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GAGetClientID", "[", "username_", "]"}], ":=", "\n", "\t", 
  RowBox[{"GALoadParameter", "[", 
   RowBox[{"$GAClientIDName", ",", " ", "username"}], 
   "]"}]}]], \
"CodeInput",ExpressionUUID->"4914c160-b3e4-433e-a1b1-b06643d9c7ce"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GASetClientID", "[", "id_", "]"}], ":=", "\n", "\t", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"StringQ", "@", "id"}], ",", "\n", "\t\t", 
     RowBox[{"$GAClientID", "=", "id"}], ",", "\n", "\t\t", "$Failed"}], "\n",
     "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GAResetClientID", "[", "]"}], ":=", "\n", "\t", 
   RowBox[{"(", 
    RowBox[{"$GAClientID", ":=", 
     RowBox[{"GAGetClientID", "[", "$GoogleAPIUsername", "]"}]}], ")"}]}], 
  ";"}]}], "CodeInput",ExpressionUUID->"a4955190-5154-4f3e-af8a-f88e86543b0b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"MatchQ", "[", 
      RowBox[{
       RowBox[{"OwnValues", "[", "$GAClientID", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"_", "\[RuleDelayed]", 
         RowBox[{"(", 
          RowBox[{"_String", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"StringLength", "@", "#"}], ">", "0"}], "&"}], ")"}]}], 
          ")"}]}], "}"}]}], "]"}]}], ",", "\n", "\t", 
    RowBox[{"GAResetClientID", "[", "]"}]}], "\n", "\t", "]"}], 
  ";"}]], "CodeInput",ExpressionUUID->"6f84526d-684d-4965-b5ee-a790906c2383"]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]ClientSecret\[RightFloor]", "CodeSubsubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.734835501265725*^9, 
  3.7348355171901703`*^9}},ExpressionUUID->"158b7b52-11ec-422c-867d-\
aeab51a721f1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GAGetClientSecret", "[", "clientID_", "]"}], ":=", "\n", "\t", 
  RowBox[{"GALoadParameter", "[", 
   RowBox[{"$GAClientSecretName", ",", " ", "clientID"}], 
   "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.734837075618574*^9, 3.734837146946262*^9}, {
  3.7348373985243807`*^9, 
  3.73483740595826*^9}},ExpressionUUID->"badb26c1-4bcd-4f9f-b0f2-\
a5346676d551"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GASetClientSecret", "[", "id_", "]"}], ":=", "\n", "\t", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"StringQ", "@", "id"}], ",", "\n", "\t\t", 
     RowBox[{"$GAClientSecret", "=", "id"}], ",", "\n", "\t\t", "$Failed"}], 
    "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GAResetClientSecret", "[", "]"}], ":=", "\n", "\t", 
   RowBox[{"(", 
    RowBox[{"$GAClientSecret", ":=", 
     RowBox[{"GAGetClientSecret", "[", "$GAClientID", "]"}]}], ")"}]}], 
  ";"}]}], "CodeInput",ExpressionUUID->"829b5b5a-c583-4232-b7eb-3cb8aa420691"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"MatchQ", "[", 
      RowBox[{
       RowBox[{"OwnValues", "[", "$GAClientSecret", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"_", "\[RuleDelayed]", 
         RowBox[{"(", 
          RowBox[{"_String", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"StringLength", "@", "#"}], ">", "0"}], "&"}], ")"}]}], 
          ")"}]}], "}"}]}], "]"}]}], ",", "\n", "\t", 
    RowBox[{"GAResetClientSecret", "[", "]"}]}], "\n", "\t", "]"}], 
  ";"}]], "CodeInput",ExpressionUUID->"46059263-9366-46e9-904c-226b691dc23a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Token\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.704404697264196*^9, 3.704404704142397*^9}, {
  3.705181923656315*^9, 
  3.705181924741144*^9}},ExpressionUUID->"e516abe3-459d-4404-9c92-\
fbf1682ff854"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"MatchQ", "[", 
      RowBox[{
       RowBox[{"OwnValues", "[", "$GAOAuthToken", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"_", "\[RuleDelayed]", 
         RowBox[{"(", 
          RowBox[{"_String", "?", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"StringLength", "@", "#"}], ">", "0"}], "&"}], ")"}]}], 
          ")"}]}], "}"}]}], "]"}]}], ",", "\n", "\t", 
    RowBox[{"$GAOAuthToken", ":=", "\n", "\t\t", 
     RowBox[{"GAOAuthenticate", "[", "$GoogleAPIUsername", "]"}]}]}], "\n", 
   "\t", "]"}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.704151058924774*^9, 3.70415109485506*^9}, {
   3.704151662772089*^9, 3.704151844111802*^9}, {3.704151901048633*^9, 
   3.704151947383257*^9}, {3.70415199082944*^9, 3.7041520029949417`*^9}, {
   3.7041520696356907`*^9, 3.704152111952409*^9}, {3.704152142738153*^9, 
   3.704152156147875*^9}, {3.704152199981153*^9, 3.704152243540367*^9}, {
   3.7041528957985086`*^9, 3.704152959142159*^9}, {3.70415319004461*^9, 
   3.7041532488912*^9}, 3.704217635826029*^9, 3.704402682958042*^9, {
   3.7044046597849073`*^9, 3.7044046898112507`*^9}, 3.704408078558474*^9, {
   3.7052345239076157`*^9, 3.705234556546432*^9}, {3.734835038811063*^9, 
   3.73483507539981*^9}},ExpressionUUID->"1ae267be-7b0d-4637-8cb6-\
41d40019aa74"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Parameters\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.704404697264196*^9, 
  3.704404708374259*^9}},ExpressionUUID->"b6de1663-c4ca-4933-b544-\
e116aa4c470e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$GAVersion", "=", "3"}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.704409143645809*^9, 
  3.704409174492715*^9}},ExpressionUUID->"fcd97aab-13d5-4c69-97fa-\
8068a0d2b70a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$GAParameters", "=", "\n", "\t", 
   RowBox[{"<|", "\n", "\t\t", 
    RowBox[{
     RowBox[{"\"\<Root\>\"", "->", "\n", "\t\t\t", 
      RowBox[{"<|", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"\"\<Scheme\>\"", "\[Rule]", "\"\<https\>\""}], ",", "\n", 
        "\t\t\t\t", 
        RowBox[{"\"\<Domain\>\"", "->", "\"\<www.googleapis.com\>\""}], ",", 
        "\n", "\t\t\t\t", 
        RowBox[{"\"\<Path\>\"", "\[Rule]", 
         RowBox[{"{", "}"}]}]}], "\n", "\t\t\t\t", "|>"}]}], ",", "\n", 
     "\t\t", 
     RowBox[{"\"\<OAuthCode\>\"", "->", "\n", "\t\t\t", 
      RowBox[{"<|", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"\"\<Domain\>\"", "\[Rule]", "\"\<accounts.google.com\>\""}], 
        ",", "\n", "\t\t\t\t", 
        RowBox[{"\"\<Path\>\"", "->", "\n", "\t\t\t\t\t", 
         RowBox[{"{", 
          RowBox[{
          "\"\<o\>\"", ",", "\"\<oauth2\>\"", ",", "\"\<v2\>\"", ",", 
           "\"\<auth\>\""}], "}"}]}], ",", "\n", "\t\t\t\t", 
        RowBox[{"\"\<Query\>\"", "->", "\n", "\t\t\t\t\t", 
         RowBox[{"{", "\n", "\t\t\t\t\t\t", 
          RowBox[{
           RowBox[{"\"\<response_type\>\"", "\[Rule]", "\"\<code\>\""}], ",", 
           "\n", "\t\t\t\t\t\t", 
           RowBox[{
           "\"\<redirect_uri\>\"", "->", 
            "\"\<http://localhost/oauth2callback\>\""}]}], "\n", 
          "\t\t\t\t\t\t", "}"}]}]}], "\n", "\t\t\t\t", "|>"}]}], ",", "\n", 
     "\t\t", 
     RowBox[{"\"\<OAuthToken\>\"", "->", "\n", "\t\t\t", 
      RowBox[{"<|", "\n", "\t\t\t\t", 
       RowBox[{"\"\<Path\>\"", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<oauth2\>\"", ",", "\"\<v4\>\"", ",", "\"\<token\>\""}], 
         "}"}]}], "\n", "\t\t\t\t", "|>"}]}], ",", "\n", "\t\t", 
     RowBox[{"\"\<Drive\>\"", "->", "\n", "\t\t\t", 
      RowBox[{"<|", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"\"\<Path\>\"", ":>", "\n", "\t\t\t\t\t", 
         RowBox[{"{", 
          RowBox[{"\"\<drive\>\"", ",", 
           RowBox[{"\"\<v\>\"", "<>", 
            RowBox[{"StringTrim", "[", 
             RowBox[{
              RowBox[{"ToString", "@", "$GAVersion"}], ",", " ", 
              "\"\<v\>\""}], "]"}]}]}], "}"}]}], ",", "\n", "\t\t\t\t", 
        RowBox[{"\"\<Query\>\"", "\[Rule]", 
         RowBox[{"{", "}"}]}]}], "\n", "\t\t\t\t", "|>"}]}], ",", "\n", 
     "\t\t", 
     RowBox[{"\"\<AnalyticsReporting\>\"", "->", "\n", "\t\t\t", 
      RowBox[{"<|", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{
        "\"\<Domain\>\"", "->", "\n", "\t\t\t\t\t", 
         "\"\<analyticsreporting.googleapis.com\>\""}], ",", "\n", "\t\t\t\t", 
        RowBox[{"\"\<Path\>\"", ":>", "\n", "\t\t\t\t\t", 
         RowBox[{"{", 
          RowBox[{"\"\<v\>\"", "<>", 
           RowBox[{"StringTrim", "[", 
            RowBox[{
             RowBox[{"ToString", "@", "$GAVersion"}], ",", "\"\<v\>\""}], 
            "]"}]}], "}"}]}], ",", "\n", "\t\t\t\t", 
        RowBox[{"\"\<Query\>\"", "\[Rule]", 
         RowBox[{"{", "}"}]}]}], "\n", "\t\t\t\t", "|>"}]}], ",", "\n", 
     "\t\t", 
     RowBox[{"\"\<UploadFile\>\"", "->", "\n", "\t\t\t", 
      RowBox[{"<|", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"\"\<Path\>\"", ":>", "\n", "\t\t\t\t\t", 
         RowBox[{"{", 
          RowBox[{
          "\"\<upload\>\"", ",", "\"\<drive\>\"", ",", "\n", "\t\t\t\t\t\t", 
           RowBox[{"\"\<v\>\"", "<>", 
            RowBox[{"StringTrim", "[", 
             RowBox[{
              RowBox[{"ToString", "@", "$GAVersion"}], ",", "\"\<v\>\""}], 
             "]"}]}], ",", "\n", "\t\t\t\t\t\t", "\"\<files\>\""}], "}"}]}], 
        ",", "\n", "\t\t\t\t", 
        RowBox[{"\"\<Query\>\"", "\[Rule]", 
         RowBox[{"{", "}"}]}]}], "\n", "\t\t\t\t", "|>"}]}], ",", "\n", 
     "\t\t", 
     RowBox[{"\"\<RequestData\>\"", "\[Rule]", "\n", "\t\t\t", 
      RowBox[{"<|", "\n", "\t\t\t\t", 
       RowBox[{"\"\<Headers\>\"", "\[Rule]", 
        RowBox[{"{", "\n", "\t", "\t\t\t\t", 
         RowBox[{
         "\"\<Authorization\>\"", ":>", "\n", "\t", "\t", "\t\t\t\t", 
          RowBox[{"\"\<Bearer \>\"", "<>", "$GAOAuthToken"}]}], "\n", "\t", 
         "\t\t\t\t", "}"}]}], "\n", "\t", "\t\t\t", "|>"}]}]}], "\n", "\t\t", 
    "|>"}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"445dedc0-492f-4046-bfc4-611dafbe2c71"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]URLAssoc\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.70440472403024*^9, 
  3.704404727277998*^9}},ExpressionUUID->"e20e6b1a-29fc-4478-ba0c-\
8c1dc10cfa28"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GAURLAssoc", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"Optional", "[", 
      RowBox[{"None", ",", "None"}], "]"}], ",", "\n", "\t", 
     RowBox[{"params___", "?", "OptionQ"}]}], "\n", "\t", "]"}], ":=", "\n", 
   "\t", 
   RowBox[{
    RowBox[{
     RowBox[{"ReplacePart", "[", 
      RowBox[{"#", ",", "\n", "\t\t", 
       RowBox[{"{", 
        RowBox[{"(*", "\n", "\t\t\t", 
         RowBox[{
          RowBox[{"\"\<Path\>\"", "\[Rule]", 
           RowBox[{"#", "[", "\"\<Path\>\"", "]"}]}], ","}], "*)"}], "\n", 
        "\t", "\t\t", 
        RowBox[{"\"\<Domain\>\"", "\[Rule]", 
         RowBox[{"Replace", "[", 
          RowBox[{
           RowBox[{"#", "[", "\"\<Domain\>\"", "]"}], ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"___", ",", "d_"}], "}"}], "\[RuleDelayed]", "d"}]}], 
          "]"}]}], "\n", "\t\t\t", "}"}]}], "\n", "\t\t", "]"}], "&"}], "@", 
    "\n", "\t", 
    RowBox[{"Merge", "[", "\n", "\t\t", 
     RowBox[{
      RowBox[{"Flatten", "@", 
       RowBox[{"{", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{"$GAParameters", "[", "\"\<Root\>\"", "]"}], ",", "\n", 
         "\t\t\t", 
         RowBox[{"Cases", "[", 
          RowBox[{
           RowBox[{"Flatten", "@", 
            RowBox[{
             RowBox[{"Map", "[", "Normal", "]"}], "@", 
             RowBox[{"{", "params", "}"}]}]}], ",", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{"r", ":", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"Rule", "|", "RuleDelayed"}], ")"}], "[", 
              RowBox[{"k_", ",", "_"}], "]"}]}], ":>", "\n", "\t\t\t\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"MatchQ", "[", 
               RowBox[{"k", ",", "\n", "\t\t\t\t\t\t\t", 
                RowBox[{
                "\"\<Scheme\>\"", "|", "\"\<Domain\>\"", "|", "\"\<Query\>\"",
                  "|", "\"\<Path\>\"", "|", "\"\<Username\>\"", "|", 
                 "\"\<Password\>\"", "|", "\"\<Port\>\""}]}], "\n", 
               "\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t\t", "r", ",", 
              "\n", "\t\t\t\t\t\t", 
              RowBox[{"\"\<Query\>\"", "\[Rule]", "r"}]}], "\n", 
             "\t\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t\t", "]"}]}], "\n", 
        "\t\t\t", "}"}]}], ",", "\n", "\t\t", 
      RowBox[{
       RowBox[{"Replace", "[", 
        RowBox[{
         RowBox[{"{", "l_", "}"}], "\[RuleDelayed]", "l"}], "]"}], "@*", 
       "Flatten"}]}], "\n", "\t\t", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GAURLAssoc", "[", 
    RowBox[{
     RowBox[{"s", ":", 
      RowBox[{"_String", "|", 
       RowBox[{"{", "__String", "}"}]}]}], ",", 
     RowBox[{"o___", "?", "OptionQ"}]}], "]"}], ":=", "\n", "\t", 
   RowBox[{"GAURLAssoc", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"Lookup", "[", 
      RowBox[{"$GAParameters", ",", 
       RowBox[{"Flatten", "@", 
        RowBox[{"{", "s", "}"}]}]}], "]"}], ",", "\n", "\t\t", "o"}], "\n", 
    "\t\t", "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.704218114811324*^9, 3.704218151242564*^9}, {
   3.7042181942610397`*^9, 3.7042182114005623`*^9}, {3.704399343282345*^9, 
   3.704399383442442*^9}, {3.704399418565605*^9, 3.70439945714741*^9}, {
   3.704399491758809*^9, 3.7043995146387997`*^9}, {3.704399581318717*^9, 
   3.7043995863089943`*^9}, {3.7043996191306553`*^9, 3.704399759327882*^9}, {
   3.704399994741457*^9, 3.704400041935944*^9}, {3.704400111711938*^9, 
   3.704400141036087*^9}, 3.704400173031762*^9, {3.704400216337387*^9, 
   3.704400263854871*^9}, {3.704400320554307*^9, 3.704400338072507*^9}, {
   3.704400373424814*^9, 3.704400416302569*^9}, {3.704400451811727*^9, 
   3.704400529975411*^9}, {3.704403604934334*^9, 3.704403614587954*^9}, {
   3.704592512957818*^9, 3.7045925220555573`*^9}, {3.7046465623128767`*^9, 
   3.704646581270486*^9}, {3.734841215820279*^9, 3.734841253525783*^9}, {
   3.734841322854546*^9, 3.734841324262158*^9}, {3.734841356419663*^9, 
   3.734841412050798*^9}},ExpressionUUID->"aeeb0115-02ba-4a46-a7b2-\
5f89cd1337a2"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Auth\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.704152126390584*^9, 
  3.704152126742949*^9}},ExpressionUUID->"82a21c86-b709-4fd4-a99b-\
8c5c1a0c1c79"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Clear\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.734840118515174*^9, 
  3.7348401196996326`*^9}},ExpressionUUID->"5e78b6df-4f13-4360-b906-\
4b3d9a1e289d"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GoogleAPIClearAuth", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"user", ":", 
      RowBox[{"(", 
       RowBox[{"_String", "|", "Automatic"}], ")"}], ":", "Automatic"}], ",", 
     "\n", "\t", 
     RowBox[{"clientID", ":", 
      RowBox[{"_String", "|", "Automatic"}], ":", "Automatic"}], ",", "\n", 
     "\t", 
     RowBox[{"scope", ":", 
      RowBox[{"_String", "?", "GAOAuthScopeQ"}], ":", "\"\<drive\>\""}]}], 
    "\n", "\t", "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"u", "=", "\n", "\t\t\t", 
        RowBox[{"StringTrim", "[", "\n", "\t", "\t\t\t", 
         RowBox[{
          RowBox[{"Replace", "[", 
           RowBox[{"user", ",", " ", "\n", "\t\t\t\t\t", 
            RowBox[{
            "Automatic", "\[RuleDelayed]", "\n", "\t\t\t\t\t\t", 
             "$GoogleAPIUsername"}]}], "\n", "\t\t\t\t\t", "]"}], ",", "\n", 
          "\t\t\t\t", "\"\<@gmail.com\>\""}], "\n", "\t", "\t\t\t", "]"}]}], 
       ",", "\n", "\t\t", 
       RowBox[{"cid", "=", "\n", "\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{"clientID", ",", " ", 
          RowBox[{"Automatic", "\[RuleDelayed]", "$GAClientID"}]}], "]"}]}], 
       ",", "\n", "\t\t", 
       RowBox[{"kc", "=", "$GACacheSym"}]}], "\n", "\t\t\t", "}"}], ",", "\n",
      "\t\t", 
     RowBox[{"Quiet", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"kc", "[", 
         RowBox[{"{", 
          RowBox[{
          "u", ",", " ", "cid", ",", " ", "scope", ",", "\"\<token\>\""}], 
          "}"}], "]"}], "=."}], ";", "\n", "\t", "\t\t", 
       RowBox[{
        RowBox[{"kc", "[", 
         RowBox[{"{", 
          RowBox[{
          "u", ",", " ", "cid", ",", " ", "scope", ",", "\"\<code\>\""}], 
          "}"}], "]"}], "=."}], ";"}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
    "]"}]}], ";"}]], \
"CodeInput",ExpressionUUID->"d150ad9b-aecb-427e-ad15-acdcfcfdbbb8"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Scopes\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.704407343619795*^9, 
  3.704407347185019*^9}},ExpressionUUID->"d0080a31-ce2c-41dd-84fb-\
dc836972458e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$GAOAuthScopes", "=", "\n", "\t", 
   RowBox[{"<|", "\n", "\t\t", 
    RowBox[{"\"\<drive\>\"", "->", "\n", "\t\t\t", 
     RowBox[{"{", "\n", "\t\t\t\t", 
      RowBox[{
      "\"\<file\>\"", ",", "\n", "\t\t\t\t", "\"\<appdata\>\"", ",", "\n", 
       "\t\t\t\t", "\"\<metadata\>\"", ",", "\n", "\t\t\t\t", 
       "\"\<metadata.readonly\>\"", ",", "\n", "\t\t\t\t", 
       "\"\<photos.readonly\>\"", ",", "\n", "\t\t\t\t", "\"\<readonly\>\"", 
       ",", "\n", "\t\t\t\t", "\"\<scripts\>\""}], "\n", "\t\t\t\t", "}"}]}], 
    "\n", "\t\t", "|>"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.7041535471330557`*^9, 
  3.7041536233575077`*^9}},ExpressionUUID->"2a54de43-de77-4710-a733-\
a88d6a8330d6"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GAOAuthScopeQ", "[", "s_", "]"}], ":=", "\n", "\t", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"KeyMemberQ", "[", 
      RowBox[{"$GAOAuthScopes", ",", 
       RowBox[{"ToLowerCase", "@", "s"}]}], "]"}], "||", "\n", "\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"sp", "=", 
         RowBox[{"StringSplit", "[", 
          RowBox[{
           RowBox[{"ToLowerCase", "@", "s"}], ",", "\"\<.\>\"", ",", "2"}], 
          "]"}]}], "}"}], ",", "\n", "\t\t\t", 
       RowBox[{"MemberQ", "[", "\n", "\t\t\t\t", 
        RowBox[{
         RowBox[{"$GAOAuthScopes", "[", 
          RowBox[{"First", "@", "sp"}], "]"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"Last", "@", "sp"}]}], "\n", "\t\t\t\t", "]"}]}], "\n", 
      "\t\t\t", "]"}]}], "\n", "\t\t", ")"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.7041536390021963`*^9, 
  3.704153722202602*^9}},ExpressionUUID->"b0754195-3317-4975-b9b7-\
15e98a726c15"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Requests\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.704407343619795*^9, 
  3.704407365620213*^9}},ExpressionUUID->"963a20a6-b2e0-4675-9152-\
2a80e704e573"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GAOAuthCodeURL", "[", "\n", "\t", 
    RowBox[{"clientID_", ",", "\n", "\t", "scope_"}], "\n", "\t", "]"}], ":=",
    "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"cid", "=", "\n", "\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{"clientID", ",", "\n", "\t\t\t\t", 
          RowBox[{
          "Automatic", "\[RuleDelayed]", "\n", "\t\t\t\t\t", 
           "$GAClientID"}]}], "\n", "\t\t\t\t", "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"s", "=", 
        RowBox[{"URLBuild", "@", 
         RowBox[{"{", 
          RowBox[{"\"\<https://www.googleapis.com/auth\>\"", ",", "scope"}], 
          "}"}]}]}]}], "\n", "\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{"URLBuild", "@", "\n", "\t\t\t", 
      RowBox[{"GAURLAssoc", "[", 
       RowBox[{"\"\<OAuthCode\>\"", ",", "\n", "\t\t\t\t", 
        RowBox[{"\"\<client_id\>\"", "\[Rule]", "cid"}], ",", "\n", "\t", 
        "\t", "\t\t", 
        RowBox[{"\"\<scope\>\"", "\[Rule]", "s"}]}], "\n", "\t\t\t\t", 
       "]"}]}]}], "\n", "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.704217289140033*^9, 3.704217380970406*^9}, {
   3.704217451002118*^9, 3.704217482577188*^9}, {3.704218082258048*^9, 
   3.704218089713018*^9}, {3.7042182204308443`*^9, 3.704218243879983*^9}, {
   3.704399307725911*^9, 3.70439932311629*^9}, {3.704399526393512*^9, 
   3.704399542038047*^9}, {3.704404468644308*^9, 3.704404491412129*^9}, 
   3.704404794022266*^9, 
   3.704412407771387*^9},ExpressionUUID->"23ada2ce-8972-41d1-b517-\
9821cdb20cc9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GAOAuthTokenRequest", "[", "code_", "]"}], ":=", "\n", "\t", 
   RowBox[{"HTTPRequest", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"URLBuild", "@", 
      RowBox[{"GAURLAssoc", "[", "\"\<OAuthToken\>\"", "]"}]}], ",", "\n", 
     "\t\t", 
     RowBox[{"<|", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"\"\<Method\>\"", "\[Rule]", "\"\<Post\>\""}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"\"\<Body\>\"", "\[Rule]", 
        RowBox[{"{", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"\"\<code\>\"", "\[Rule]", "code"}], ",", "\n", "\t", 
          "\t\t\t", 
          RowBox[{"\"\<client_id\>\"", "\[Rule]", "$GAClientID"}], ",", "\n", 
          "\t", "\t\t\t", 
          RowBox[{"\"\<client_secret\>\"", "\[Rule]", "$GAClientSecret"}], 
          ",", "\n", "\t", "\t\t\t", 
          RowBox[{
          "\"\<grant_type\>\"", "\[Rule]", "\"\<authorization_code\>\""}], 
          ",", "\n", "\t\t\t\t", 
          RowBox[{
          "\"\<redirect_uri\>\"", "->", 
           "\"\<http://localhost/oauth2callback\>\""}]}], "\n", "\t\t\t\t", 
         "}"}]}]}], "\n", "\t\t\t", "|>"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GAOAuthRefreshRequest", "[", "token_", "]"}], ":=", "\n", "\t", 
   RowBox[{"HTTPRequest", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"URLBuild", "@", 
      RowBox[{"GAURLAssoc", "[", "\"\<OAuthToken\>\"", "]"}]}], ",", "\n", 
     "\t\t", 
     RowBox[{"<|", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"\"\<Method\>\"", "\[Rule]", "\"\<Post\>\""}], ",", "\n", 
       "\t\t\t", 
       RowBox[{"\"\<Body\>\"", "\[Rule]", 
        RowBox[{"{", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"\"\<refresh_token\>\"", "\[Rule]", "token"}], ",", "\n", 
          "\t\t\t\t", 
          RowBox[{"\"\<client_id\>\"", "\[Rule]", "$GAClientID"}], ",", "\n", 
          "\t", "\t\t\t", 
          RowBox[{"\"\<client_secret\>\"", "\[Rule]", "$GAClientSecret"}], 
          ",", "\n", "\t", "\t\t\t", 
          RowBox[{
          "\"\<grant_type\>\"", "\[Rule]", "\"\<refresh_token\>\""}]}], "\n", 
         "\t\t\t\t", "}"}]}]}], "\n", "\t\t\t", "|>"}]}], "\n", "\t\t", 
    "]"}]}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.7044044753408957`*^9, 3.704404546323728*^9}, {
  3.704405223276102*^9, 3.7044053059492617`*^9}, {3.704405720012932*^9, 
  3.704405726550679*^9}, {3.704405867160124*^9, 3.7044058947319813`*^9}, {
  3.70440594055486*^9, 3.704405969061781*^9}, {3.704406322657716*^9, 
  3.704406323090069*^9}, {3.7044063964618607`*^9, 3.704406396913866*^9}, {
  3.7044072856746473`*^9, 3.704407329571311*^9}, {3.7044078533520527`*^9, 
  3.7044078574622507`*^9}},ExpressionUUID->"d3e57241-6e52-488d-92a3-\
4239c4997ba1"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Auth\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.704407343619795*^9, 3.704407347185019*^9}, {
  3.7044073781548557`*^9, 
  3.7044073786013937`*^9}},ExpressionUUID->"2bcbda4f-5706-411f-b378-\
ee53f95df022"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GAOAuthenticate", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"user", ":", 
      RowBox[{"(", 
       RowBox[{"_String", "|", "Automatic"}], ")"}], ":", "Automatic"}], ",", 
     "\n", "\t", 
     RowBox[{"clientID", ":", 
      RowBox[{"_String", "|", "Automatic"}], ":", "Automatic"}], ",", "\n", 
     "\t", 
     RowBox[{"scope", ":", 
      RowBox[{"_String", "?", "GAOAuthScopeQ"}], ":", "\"\<drive\>\""}]}], 
    "\n", "\t", "]"}], ":=", "\n", "\t", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", "\n", "\t\t", 
      RowBox[{
       RowBox[{"u", "=", "\n", "\t\t\t", 
        RowBox[{"StringTrim", "[", "\n", "\t", "\t\t\t", 
         RowBox[{
          RowBox[{"Replace", "[", 
           RowBox[{"user", ",", " ", 
            RowBox[{"Automatic", "\[RuleDelayed]", "$GoogleAPIUsername"}]}], 
           "]"}], ",", "\n", "\t\t\t\t", "\"\<@gmail.com\>\""}], "\n", "\t", 
         "\t\t\t", "]"}]}], ",", "\n", "\t\t", 
       RowBox[{"cid", "=", "\n", "\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{"clientID", ",", " ", 
          RowBox[{"Automatic", "\[RuleDelayed]", "$GAClientID"}]}], "]"}]}]}],
       "\n", "\t\t\t", "}"}], ",", "\n", "\t\t", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"a", "=", 
         RowBox[{"GAOAuthTokenData", "[", 
          RowBox[{"u", ",", " ", "cid", ",", " ", "scope"}], "]"}]}], "}"}], 
       ",", "\n", "\t\t\t", 
       RowBox[{"Block", "[", 
        RowBox[{
         RowBox[{"{", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"$GAOAuthTokenDataTmp", "=", "a"}], ",", "\n", "\t\t\t\t", 
           
           RowBox[{"$GAOAuthTokenCalls", "=", "\n", "\t\t\t\t\t", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"!", 
               RowBox[{"IntegerQ", "@", "$GAOAuthTokenCalls"}]}], ",", " ", 
              "0", ",", " ", "$GAOAuthTokenCalls"}], "]"}]}]}], "\n", 
          "\t\t\t\t", "}"}], ",", "\n", "\t\t\t\t", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"$GAOAuthTokenCalls", "<", "4"}], "&&", 
            RowBox[{"AssociationQ", "@", "a"}]}], ",", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"$GAOAuthTokenCalls", "++"}], ";", "\n", "\t\t\t\t\t", 
            RowBox[{"If", "[", "\n", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"Quantity", "[", 
                  RowBox[{
                   RowBox[{"ToExpression", "@", "#"}], ",", 
                   "\"\<Seconds\>\""}], "]"}], ">", 
                 RowBox[{"(", 
                  RowBox[{"Now", "-", "#2"}], ")"}]}], "&"}], "@@", "\n", 
               "\t", "\t", "\t\t\t\t\t", 
               RowBox[{"Lookup", "[", 
                RowBox[{"a", ",", 
                 RowBox[{"{", 
                  RowBox[{"\"\<expires_in\>\"", ",", "\"\<LastUpdated\>\""}], 
                  "}"}], ",", " ", "3600"}], "]"}]}], ",", "\n", 
              "\t\t\t\t\t\t", 
              RowBox[{"Lookup", "[", 
               RowBox[{"a", ",", "\"\<access_token\>\""}], "]"}], ",", "\n", 
              "\t", "\t", "\t\t\t\t", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"KeyMemberQ", "[", 
                 RowBox[{"a", ",", "\"\<refresh_token\>\""}], "]"}], ",", 
                "\n", "\t", "\t", "\t\t\t\t\t", 
                RowBox[{"Replace", "[", 
                 RowBox[{
                  RowBox[{"Import", "[", 
                   RowBox[{
                    RowBox[{"GAOAuthRefreshRequest", "@", 
                    RowBox[{"a", "[", "\"\<refresh_token\>\"", "]"}]}], ",", 
                    "\"\<RawJSON\>\""}], "]"}], ",", 
                  RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"r_Association", ":>", "\n", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"With", "[", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"kc", "=", "$GACacheSym"}], "}"}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"kc", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "u", ",", "cid", ",", "scope", ",", "\"\<token\>\""}], 
                    "}"}], "]"}], "=", "\n", "\t", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"Append", "[", 
                    RowBox[{"r", ",", 
                    RowBox[{"\"\<LastUpdated\>\"", "\[Rule]", "Now"}]}], 
                    "]"}]}], ";", "\n", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"GAOAuthenticate", "[", 
                    RowBox[{"u", ",", "cid", ",", "scope"}], "]"}]}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", 
                    "\t\t\t\t\t\t\t\t", 
                    RowBox[{"_", "->", "$Failed"}]}], "\n", "\t", "\t", "\t", 
                   "\t\t\t\t\t", "}"}]}], "]"}], ",", "\n", "\t\t\t\t\t\t\t", 
                
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"$GAOAuthTokenCalls", ">", "1"}], "&&", 
                   RowBox[{"KeyMemberQ", "[", 
                    RowBox[{"a", ",", "\"\<access_token\>\""}], "]"}]}], ",", 
                  "\n", "\t\t\t\t\t\t\t\t", 
                  RowBox[{"a", "[", "\"\<access_token\>\"", "]"}], ",", "\n", 
                  "\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"GoogleAPIClearAuth", "[", 
                    RowBox[{"u", ",", " ", "cid", ",", " ", "scope"}], "]"}], 
                   ";", "\n", "\t\t\t\t\t\t\t\t", 
                   RowBox[{"GAOAuthenticate", "[", 
                    RowBox[{"u", ",", "    ", "cid", ",", " ", "scope"}], 
                    "]"}]}]}], "\n", "\t\t\t\t\t\t\t\t", "]"}]}], "\n", 
               "\t\t\t\t\t\t\t", "]"}], ",", "\n", "\t\t\t\t\t\t", 
              "$Failed"}], "\n", "\t\t\t\t\t\t", "]"}]}], ",", "\n", 
           "\t\t\t\t\t", "$Failed"}], "\n", "\t\t\t\t\t", "]"}]}], "\n", 
        "\t\t\t\t", "]"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", "]"}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"fd66fd2e-14b8-4559-9ed6-726e1e369bbd"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]OAuthTokenData\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{3.734840130898121*^9, 
  3.7348401982591763`*^9},ExpressionUUID->"1eaea866-8724-4ac4-8bf9-\
d65b73e0424b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"$GAKeyExample", "=", "\n", "\t", 
   RowBox[{"Import", "@", "\n", "\t\t", 
    RowBox[{"PackageFilePath", "[", 
     RowBox[{
     "\"\<Resources\>\"", ",", " ", "\"\<Images\>\"", ",", " ", 
      "\"\<GoogleOAuthExample.png\>\""}], "]"}]}]}], 
  ";"}]], "CodeInput",ExpressionUUID->"d244a8e5-cf80-4b0e-83bc-5df3de921bf0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GAOAuthTokenData", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"user", ":", 
      RowBox[{"_String", "|", "Automatic"}], ":", "Automatic"}], ",", "\n", 
     "\t", 
     RowBox[{"clientID", ":", 
      RowBox[{"_String", "|", "Automatic"}], ":", "Automatic"}], ",", "\n", 
     "\t", 
     RowBox[{"scope", ":", 
      RowBox[{"_String", "?", "GAOAuthScopeQ"}], ":", "\"\<drive\>\""}]}], 
    "\n", "\t", "]"}], ":=", "\n", "\t", 
   RowBox[{"Replace", "[", 
    RowBox[{"$GAOAuthTokenDataTmp", ",", "\n", "\t\t", 
     RowBox[{
      RowBox[{"Except", "[", "_String", "]"}], ":>", "\n", "\t\t\t", 
      RowBox[{"With", "[", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"{", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"u", "=", "\n", "\t\t\t\t\t\t", 
           RowBox[{
           "StringTrim", "[", "\n", "\t", "\t", "\t", "\t", "\t\t\t", 
            RowBox[{
             RowBox[{"Replace", "[", 
              RowBox[{"user", ",", 
               RowBox[{
               "Automatic", "\[RuleDelayed]", "$GoogleAPIUsername"}]}], "]"}],
              ",", "\n", "\t", "\t", "\t", "\t\t\t\t", "\"\<@gmail.com\>\""}],
             "\n", "\t", "\t", "\t", "\t\t\t\t", "]"}]}], ",", "\n", "\t", 
          "\t", "\t", "\t\t", 
          RowBox[{"cid", "=", "\n", "\t", "\t", "\t", "\t\t\t", 
           RowBox[{"Replace", "[", 
            RowBox[{"clientID", ",", 
             RowBox[{"Automatic", "\[RuleDelayed]", "$GAClientID"}]}], 
            "]"}]}], ",", "\n", "\t", "\t\t\t\t", 
          RowBox[{"kc", "=", "$GACacheSym"}]}], "\n", "\t", "\t\t\t\t", "}"}],
         ",", "\n", "\t\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"kc", "[", 
           RowBox[{"{", 
            RowBox[{"u", ",", "cid", ",", "scope", ",", "\"\<token\>\""}], 
            "}"}], "]"}], ",", "\n", "\t", "\t", "\t", "\t\t", 
          RowBox[{
           RowBox[{"Except", "[", 
            RowBox[{"_Association", "?", 
             RowBox[{"(", 
              RowBox[{"KeyMemberQ", "[", "\"\<access_token\>\"", "]"}], 
              ")"}]}], "]"}], ":>", "\n", "\t", "\t", "\t\t\t\t", 
           RowBox[{"Replace", "[", "\n", "\t\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"Replace", "[", 
              RowBox[{
               RowBox[{"kc", "[", 
                RowBox[{"{", 
                 RowBox[{
                 "u", ",", "clientID", ",", "scope", ",", "\"\<code\>\""}], 
                 "}"}], "]"}], ",", "\n", "\t", "\t", "\t", "\t", "\t", 
               "\t\t\t", 
               RowBox[{
                RowBox[{"Except", "[", 
                 RowBox[{"_String", "?", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"StringLength", "@", "#"}], ">", "0"}], "&"}], 
                   ")"}]}], "]"}], ":>", "\n", "\t", "\t", "\t", "\t", "\t", 
                "\t\t\t\t", 
                RowBox[{
                "Replace", "[", "\n", "\t", "\t", "\t", "\t", "\t", 
                 "\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{
                  "OAuthDialog", "[", "\n", "\t", "\t", "\t", "\t", "\t", 
                   "\t\t\t\t\t\t", 
                   RowBox[{
                   "\"\<Google OAuth Authorization\>\"", ",", "\n", "\t", 
                    "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"{", "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"\"\<Google OAuth\>\"", ",", 
                    RowBox[{"GAOAuthCodeURL", "[", 
                    RowBox[{"cid", ",", "scope"}], "]"}]}], "}"}], ",", "\n", 
                    "\t", "\t", "\t\t\t\t\t\t\t\t\t\t", "$GAKeyExample"}], 
                    "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t\t", "}"}], ",", 
                    "\n", "\t", "\t", "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"$GAParameters", "[", 
                    RowBox[{"\"\<Root\>\"", ",", "\"\<Domain\>\""}], "]"}]}], 
                   "\n", "\t", "\t", "\t", "\t", "\t", "\t\t\t\t\t\t", "]"}], 
                  ",", "\n", "\t", "\t", "\t", "\t", "\t", "\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"s_String", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"StringLength", "@", "#"}], ">", "0"}], "&"}], 
                    ")"}]}], ":>", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"kc", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "u", ",", "cid", ",", "scope", ",", "\"\<code\>\""}], 
                    "}"}], "]"}], "=", "s"}], ")"}]}]}], "\n", "\t", "\t", 
                 "\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", "\t", "\t", 
              "\t\t\t\t\t\t", "]"}], ",", 
             RowBox[{"{", "\n", "\t", "\t", "\t", "\t\t\t\t", 
              RowBox[{
               RowBox[{"code_String", "?", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"StringLength", "@", "#"}], ">", "0"}], "&"}], 
                 ")"}]}], ":>", "\n", "\t", "\t", "\t", "\t\t\t\t\t", 
               RowBox[{"Replace", "[", 
                RowBox[{
                 RowBox[{"Import", "[", 
                  RowBox[{
                   RowBox[{"GAOAuthTokenRequest", "[", "code", "]"}], ",", 
                   "\"\<RawJSON\>\""}], "]"}], ",", "\n", "\t", "\t", "\t", 
                 "\t\t\t\t\t\t", 
                 RowBox[{
                  RowBox[{"r_Association", "?", 
                   RowBox[{"(", 
                    RowBox[{"KeyMemberQ", "[", "\"\<access_token\>\"", "]"}], 
                    ")"}]}], ":>", "\n", "\t\t\t\t\t\t\t\t\t\t", 
                  RowBox[{"(", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                   RowBox[{
                    RowBox[{"kc", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    "u", ",", "cid", ",", "scope", ",", "\"\<token\>\""}], 
                    "}"}], "]"}], "=", "\n", "\t", "\t", "\t", 
                    "\t\t\t\t\t\t\t\t\t", 
                    RowBox[{"Append", "[", 
                    RowBox[{"r", ",", 
                    RowBox[{"\"\<LastUpdated\>\"", "\[Rule]", "Now"}]}], 
                    "]"}]}], "\n", "\t", "\t", "\t", "\t\t\t\t\t\t\t\t", 
                   ")"}]}]}], "\n", "\t", "\t", "\t", "\t\t\t\t\t\t", "]"}]}],
               "\n", "\t", "\t", "\t", "\t\t\t\t", "}"}]}], "]"}]}]}], "\n", 
         "\t", "\t\t\t\t", "]"}]}], "\n", "\t", "\t\t\t", "]"}]}]}], "\n", 
    "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.704152245937763*^9, 3.704152269085229*^9}, 
   3.704152407314834*^9, {3.7041535079072866`*^9, 3.70415354488306*^9}, {
   3.704153631881968*^9, 3.704153635360695*^9}, {3.704153666172489*^9, 
   3.7041536683943167`*^9}, {3.704153734955559*^9, 3.7041537478609962`*^9}, {
   3.704153903459049*^9, 3.704153941235005*^9}, 3.7041547920198717`*^9, {
   3.704157568233798*^9, 3.7041575687684717`*^9}, {3.70415800661298*^9, 
   3.70415804969309*^9}, {3.704158091569962*^9, 3.7041581582183027`*^9}, {
   3.704217211835392*^9, 3.704217255898592*^9}, 3.704217351381868*^9, {
   3.7042174890102167`*^9, 3.7042175495910807`*^9}, {3.704217914650906*^9, 
   3.704217926049142*^9}, {3.704218060444283*^9, 3.704218066361372*^9}, {
   3.7043998549757547`*^9, 3.704399938082333*^9}, {3.7044048088779373`*^9, 
   3.704404809452928*^9}, {3.70440502568195*^9, 3.7044052113378267`*^9}, {
   3.7044055470908213`*^9, 3.7044055600575047`*^9}, {3.704406572944916*^9, 
   3.704406652555252*^9}, {3.704406776670209*^9, 3.704406854238793*^9}, {
   3.7044068947638397`*^9, 3.70440691684188*^9}, {3.704407697339944*^9, 
   3.70440770389034*^9}, {3.70441239744532*^9, 3.704412397592751*^9}, {
   3.704412531050218*^9, 3.704412542266304*^9}, {3.7045801343835297`*^9, 
   3.7045801521283207`*^9}, {3.7045802713902073`*^9, 
   3.7045803105365877`*^9}, {3.704580573831892*^9, 3.70458057507514*^9}, {
   3.704639971725464*^9, 3.704640001261196*^9}, 3.704652568462626*^9, {
   3.704653564427356*^9, 3.704653592418604*^9}, {3.704654120148748*^9, 
   3.7046541229825478`*^9}, 3.7046542169442253`*^9, {3.733697127903844*^9, 
   3.733697127925744*^9}, {3.7348375309944677`*^9, 
   3.73483758748048*^9}},ExpressionUUID->"df1143bd-d594-4904-b5d8-\
9fcd0f58fed5"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]Requests\[RightFloor]", "CodeSubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.704152120208335*^9, 3.704152124590876*^9}, 
   3.704152232959446*^9},ExpressionUUID->"501b8b18-bedc-4680-8c50-\
6da5743ec2fa"],

Cell[CellGroupData[{

Cell["\[LeftCeiling]PrepParams\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{{3.728235778742734*^9, 3.7282357810253897`*^9}, {
  3.734838457076256*^9, 
  3.734838457405634*^9}},ExpressionUUID->"f4938c78-20b3-446b-9dca-\
f5fc84dbfb72"],

Cell[BoxData[
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"!", 
     RowBox[{"AssociationQ", "@", "$GAParamMap"}]}], ",", " ", 
    RowBox[{"$GAParamMap", "=", 
     RowBox[{"<|", "|>"}]}]}], "]"}], 
  ";"}]], "CodeInput",ExpressionUUID->"170acded-4d7d-4e92-b3b3-209f710d2a6e"],

Cell[BoxData[{
 RowBox[{"GAPrepType", "//", "Clear"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GAPrepType", "[", 
    RowBox[{"n_", "?", "NumericQ"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"ToString", "[", "n", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GAPrepType", "[", 
    RowBox[{"n_", "?", "DateObjectQ"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"DateString", "[", 
    RowBox[{"n", ",", " ", "\"\<ISODate\>\""}], "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GAPrepType", "[", "q_Quantity", "]"}], ":=", "\n", "\t", 
   RowBox[{"ToString", "@", "\n", "\t\t", 
    RowBox[{"QuantityMagnitude", "@", "\n", "\t\t\t", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"CompatibleUnitQ", "[", 
        RowBox[{"q", ",", " ", "\"\<Seconds\>\""}], "]"}], ",", " ", "\n", 
       "\t\t\t\t", 
       RowBox[{"UnitConvert", "[", 
        RowBox[{"q", ",", " ", "\"\<Seconds\>\""}], "]"}], ",", "\n", 
       "\t\t\t\t", "q"}], "\n", "\t\t\t\t", "]"}]}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GAPrepType", "[", "l_List", "]"}], ":=", "\n", "\t", 
   RowBox[{"GAPrepType", "/@", "l"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GAPrepType", "[", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"Rule", "|", "RuleDelayed"}], ")"}], "[", 
     RowBox[{"k_", ",", " ", "v_"}], "]"}], "]"}], ":=", "\n", "\t", 
   RowBox[{"k", "->", 
    RowBox[{"GAPrepType", "[", "v", "]"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GAPrepType", "[", "e_", "]"}], ":=", "e"}], ";"}]}], "CodeInput",
 CellChangeTimes->{{3.728235782741666*^9, 3.728235948098342*^9}, {
  3.728236137128954*^9, 3.7282361603185*^9}, {3.728308991176546*^9, 
  3.7283095047581043`*^9}, {3.728309691969823*^9, 3.728309695649152*^9}, {
  3.7283693220790663`*^9, 3.7283694212155848`*^9}, {3.7348384725263977`*^9, 
  3.734838479594509*^9}, {3.7348391874171257`*^9, 3.7348391973181143`*^9}, {
  3.734843579621167*^9, 
  3.734843629545825*^9}},ExpressionUUID->"3c6ebaec-93e9-4b59-b040-\
75cf5fd3de9e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GAPrepParamVals", "[", "ops_", "]"}], ":=", "\n", "\t", 
   RowBox[{"Replace", "[", "\n", "\t\t", 
    RowBox[{"ops", ",", "\n", "\t\t", 
     RowBox[{"{", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"h", ":", 
          RowBox[{"Rule", "|", "RuleDelayed"}]}], ")"}], "[", 
        RowBox[{"s_String", ",", " ", "o_"}], "]"}], ":>", "\n", "\t\t\t\t", 
       RowBox[{"s", "->", 
        RowBox[{"GAPrepType", "[", "o", "]"}]}]}], "\n", "\t\t\t", "}"}], ",",
      "\n", "\t\t", "1"}], "\n", "\t\t", "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GAPrepParams", "[", "ops_", "]"}], ":=", "\n", "\t", 
   RowBox[{"DeleteCases", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"GAPrepParamVals", "@", 
      RowBox[{"Flatten", "@", 
       RowBox[{"Normal", "@", 
        RowBox[{"{", "ops", "}"}]}]}]}], ",", "\n", "\t\t", 
     RowBox[{"_", "\[Rule]", "Automatic"}]}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GAPrepParams", "[", 
     RowBox[{"ops_", ",", " ", "fn_", ",", " ", "key_"}], "]"}], ":=", "\n", 
    "\t", 
    RowBox[{"GAPrepParams", "@", "\n", "\t\t", 
     RowBox[{"FilterRules", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"ops", ",", " ", 
         RowBox[{"Options", "[", "fn", "]"}]}], "}"}], ",", " ", 
       RowBox[{"Lookup", "[", 
        RowBox[{"$GAParamMap", ",", " ", "key", ",", " ", 
         RowBox[{"Options", "[", "fn", "]"}]}], "]"}]}], "]"}]}]}], ";"}], 
  " "}], "\n", 
 RowBox[{
  RowBox[{"GAPrepParams", "[", 
   RowBox[{"ops_", ",", " ", "fn_"}], "]"}], ":=", "\n", "\t", 
  RowBox[{"GAPrepParams", "[", 
   RowBox[{"ops", ",", " ", "fn", ",", " ", "None"}], "]"}]}]}], "CodeInput",
 CellChangeTimes->{{3.728235782741666*^9, 3.728235948098342*^9}, {
  3.728236137128954*^9, 3.7282361603185*^9}, {3.728308991176546*^9, 
  3.7283095047581043`*^9}, {3.728309691969823*^9, 3.728309695649152*^9}, {
  3.7283693220790663`*^9, 3.7283694212155848`*^9}, {3.731127144619266*^9, 
  3.73112714753564*^9}, {3.7311275516829643`*^9, 3.731127608840119*^9}, {
  3.731128648639967*^9, 3.731128655269655*^9}, {3.733505563910515*^9, 
  3.733505648187348*^9}, {3.733941629385907*^9, 3.733941646445147*^9}, {
  3.7339416834800053`*^9, 3.733941694170142*^9}, {3.734838481467545*^9, 
  3.734838500596046*^9}, {3.7348431781131*^9, 3.734843178453183*^9}, {
  3.7348432462325163`*^9, 3.734843307460021*^9}, {3.734843663724492*^9, 
  3.734843721967519*^9}},ExpressionUUID->"17955aa3-c45a-4e95-a0fb-\
3a8cd0d32278"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]GARequest\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.734838529289238*^9, {3.734841573189925*^9, 
   3.734841573489768*^9}},ExpressionUUID->"c7fd56cd-4572-45ab-9e34-\
e1ffe7dff369"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GARequest", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"root", ":", 
      RowBox[{"_String", "|", "None"}], ":", "None"}], ",", "\n", "\t", 
     "passoc_Association", ",", "\n", "\t", 
     RowBox[{"assoc", ":", "_Association", ":", 
      RowBox[{"<|", "|>"}]}]}], "\n", "\t", "]"}], ":=", "\n", "\t", 
   RowBox[{"HTTPRequest", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"With", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t\t\t", 
        RowBox[{"urla", "=", "\n", "\t\t\t\t\t", 
         RowBox[{"GAURLAssoc", "[", "\n", "\t", "\t\t\t\t\t", 
          RowBox[{"root", ",", "\n", "\t", "\t", "\t", "\t\t\t", 
           RowBox[{"Sequence", "@@", 
            RowBox[{"Norm", "[", "passoc", "]"}]}]}], "\n", "\t", 
          "\t\t\t\t\t", "]"}]}], "\n", "\t", "\t\t\t", "}"}], ",", "\n", 
       "\t\t\t", 
       RowBox[{
        RowBox[{"URLBuild", "[", 
         RowBox[{"KeyDrop", "[", 
          RowBox[{"urla", ",", " ", "\"\<Port\>\""}], "]"}], "]"}], "<>", 
        "\n", "\t\t\t\t", 
        RowBox[{"Replace", "[", 
         RowBox[{
          RowBox[{"urla", "[", "\"\<Port\>\"", "]"}], ",", "\n", "\t\t\t\t\t", 
          RowBox[{"{", "\n", "\t\t\t\t\t\t", 
           RowBox[{
            RowBox[{"s_String", "\[RuleDelayed]", 
             RowBox[{"\"\<:\>\"", "<>", "s"}]}], ",", "\n", "\t\t\t\t\t\t", 
            RowBox[{"i_Integer", "\[RuleDelayed]", 
             RowBox[{"\"\<:\>\"", "<>", 
              RowBox[{"ToString", "[", "i", "]"}]}]}], ",", "\n", 
            "\t\t\t\t\t\t", 
            RowBox[{"_", "\[Rule]", "\"\<\>\""}]}], "\n", "\t\t\t\t\t\t", 
           "}"}]}], "\n", "\t\t\t\t\t", "]"}]}]}], "\n", "\t\t\t", "]"}], ",",
      "\n", "\t\t", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"$GAParameters", "[", "\"\<RequestData\>\"", "]"}], "/.", 
          "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"HoldPattern", "[", "$GAOAuthToken", "]"}], 
           "\[RuleDelayed]", "$GAOAuthToken"}]}], ",", "\n", "\t\t\t", 
         "assoc"}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"Replace", "[", 
         RowBox[{"{", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "f_", "}"}], "\[RuleDelayed]", "\n", "\t\t\t\t\t", 
            "f"}], ",", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{"o", ":", 
             RowBox[{"{", 
              RowBox[{"__", "?", "OptionQ"}], "}"}]}], ":>", "\n", 
            "\t\t\t\t\t", 
            RowBox[{"Merge", "[", 
             RowBox[{"o", ",", "Last"}], "]"}]}]}], "\n", "\t\t\t\t", "}"}], 
         "]"}], "@*", "Flatten"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
    "]"}]}], ";"}]], \
"CodeInput",ExpressionUUID->"f9b2f3f4-79c9-4ac8-941b-41d7f28da4a3"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GARequest", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"root", ":", 
      RowBox[{"_String", "|", "None"}], ":", "None"}], ",", "\n", "\t", 
     RowBox[{"path", ":", 
      RowBox[{"_String", "|", 
       RowBox[{"{", "__String", "}"}], "|", "Nothing"}]}], ",", "\n", "\t", 
     RowBox[{"query", ":", 
      RowBox[{"_Rule", "|", 
       RowBox[{"{", "___Rule", "}"}]}], ":", 
      RowBox[{"{", "}"}]}], ",", "\n", "\t", 
     RowBox[{"assoc", ":", "_Association", ":", 
      RowBox[{"<|", "|>"}]}]}], "\n", "\t", "]"}], ":=", "\n", "\t", 
   RowBox[{"HTTPRequest", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"GAURLAssoc", "[", "\n", "\t\t\t", 
      RowBox[{"root", ",", "\n", "\t\t\t", 
       RowBox[{"\"\<Path\>\"", "\[Rule]", "path"}], ",", "\n", "\t\t\t", 
       RowBox[{"\"\<Query\>\"", "\[Rule]", "query"}]}], "\n", "\t\t\t", "]"}],
      ",", "\n", "\t\t", 
     RowBox[{"Merge", "[", 
      RowBox[{
       RowBox[{"{", "\n", "\t\t\t", 
        RowBox[{
         RowBox[{
          RowBox[{"$GAParameters", "[", "\"\<RequestData\>\"", "]"}], "/.", 
          "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"HoldPattern", "[", "$GAOAuthToken", "]"}], 
           "\[RuleDelayed]", "$GAOAuthToken"}]}], ",", "\n", "\t\t\t", 
         "assoc"}], "\n", "\t\t\t", "}"}], ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"Replace", "[", 
         RowBox[{"{", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "f_", "}"}], "\[RuleDelayed]", "\n", "\t\t\t\t\t", 
            "f"}], ",", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{"o", ":", 
             RowBox[{"{", 
              RowBox[{"__", "?", "OptionQ"}], "}"}]}], ":>", "\n", 
            "\t\t\t\t\t", 
            RowBox[{"Merge", "[", 
             RowBox[{"o", ",", "Last"}], "]"}]}]}], "\n", "\t\t\t\t", "}"}], 
         "]"}], "@*", "Flatten"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
    "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.704646426718174*^9, 3.704646499152542*^9}, {
  3.7046465318811083`*^9, 3.7046465420238256`*^9}, {3.704646613493123*^9, 
  3.704646616696308*^9}, {3.7046482716016006`*^9, 3.704648311235985*^9}, {
  3.7046534407348747`*^9, 3.7046534654795856`*^9}, {3.704653602136012*^9, 
  3.704653645920281*^9}, {3.7046537160061817`*^9, 3.7046537255741787`*^9}, {
  3.704657436691249*^9, 3.704657444602353*^9}, {3.7348406016953783`*^9, 
  3.7348406068146343`*^9}},ExpressionUUID->"aca66750-687c-4406-9890-\
3fb5ced4faf1"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]GACall\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,ExpressionUUID->"9089f2f5-cca1-46c3-bbc1-de14672b6990"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GACall", "[", "\n", "\t", 
    RowBox[{"h_HTTPRequest", ",", "\n", "\t", 
     RowBox[{"read", ":", 
      RowBox[{
      "\"\<Body\>\"", "|", "\"\<BodyBytes\>\"", "|", "\"\<BodyByteArray\>\"", 
       "|", "Automatic"}], ":", "Automatic"}]}], "\n", "\t", "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"read", "===", "Automatic"}], ",", "\n", "\t\t", 
     RowBox[{"GAParse", "@", 
      RowBox[{"URLRead", "@", "h"}]}], ",", "\n", "\t\t", 
     RowBox[{"URLRead", "[", 
      RowBox[{"h", ",", " ", 
       RowBox[{"{", 
        RowBox[{"\"\<StatusCode\>\"", ",", "read"}], "}"}]}], "]"}]}], "\n", 
    "\t\t", "]"}]}], ";"}]], "CodeInput",
 CellChangeTimes->{{3.704148768563205*^9, 3.704148811896933*^9}, {
   3.704149125911503*^9, 3.70414912682544*^9}, {3.704217606171853*^9, 
   3.704217619269453*^9}, {3.704578864019948*^9, 3.704578876901209*^9}, {
   3.704633390502842*^9, 3.7046334643848543`*^9}, {3.704633522162574*^9, 
   3.7046335414111834`*^9}, 3.704635976046574*^9, 3.704646660595992*^9, {
   3.7046483294693747`*^9, 3.704648348544711*^9}, {3.7046491090729847`*^9, 
   3.7046491099669943`*^9}, 3.704649518119712*^9, {3.70465747126755*^9, 
   3.704657473463687*^9}, 3.7046577878973293`*^9, 3.734838533250247*^9, {
   3.734840399857967*^9, 3.734840400017151*^9}, 
   3.73484067330881*^9},ExpressionUUID->"a98e35dd-0369-49c8-a52a-\
769fe8098f84"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"GACall", "[", "\n", "\t", 
    RowBox[{
     RowBox[{"root", ":", 
      RowBox[{"_String", "|", "None"}], ":", "None"}], ",", "\n", "\t", 
     RowBox[{"path", ":", 
      RowBox[{"_String", "|", 
       RowBox[{"{", "__String", "}"}], "|", "Nothing"}], ":", "Nothing"}], 
     ",", "\n", "\t", 
     RowBox[{"query", ":", 
      RowBox[{"_Rule", "|", 
       RowBox[{"{", "___Rule", "}"}]}], ":", 
      RowBox[{"{", "}"}]}], ",", "\n", "\t", 
     RowBox[{"assoc", ":", "_Association", ":", 
      RowBox[{"<|", "|>"}]}], ",", "\n", "\t", 
     RowBox[{"read", ":", 
      RowBox[{
      "\"\<Body\>\"", "|", "\"\<BodyBytes\>\"", "|", "\"\<BodyByteArray\>\"", 
       "|", "Automatic"}], ":", "Automatic"}]}], "\n", "\t", "]"}], ":=", 
   "\n", "\t", 
   RowBox[{"GACall", "[", "\n", "\t\t", 
    RowBox[{
     RowBox[{"GARequest", "[", 
      RowBox[{"root", ",", "path", ",", "query", ",", "assoc", ",", "read"}], 
      "]"}], ",", "\n", "\t\t", "read"}], "\n", "\t\t", "]"}]}], 
  ";"}]], "CodeInput",
 CellChangeTimes->{{3.704148768563205*^9, 3.704148811896933*^9}, {
   3.704149125911503*^9, 3.70414912682544*^9}, {3.704217606171853*^9, 
   3.704217619269453*^9}, {3.704578864019948*^9, 3.704578876901209*^9}, {
   3.704633390502842*^9, 3.7046334643848543`*^9}, {3.704633522162574*^9, 
   3.7046335414111834`*^9}, 3.704635976046574*^9, 3.704646660595992*^9, {
   3.7046483294693747`*^9, 3.704648348544711*^9}, {3.7046491090729847`*^9, 
   3.7046491099669943`*^9}, 3.704649518119712*^9, {3.70465747126755*^9, 
   3.704657473463687*^9}, 3.7046577878973293`*^9, 
   3.734838533250247*^9},ExpressionUUID->"8377265d-fc6b-4169-8062-\
7b18a906baed"]
}, Closed]],

Cell[CellGroupData[{

Cell["\[LeftCeiling]GAParse\[RightFloor]", "CodeSubsubsection",
 Evaluatable->True,
 CellChangeTimes->{
  3.734840663632875*^9},ExpressionUUID->"b2b06537-154a-49f3-a7af-\
955a8c234b08"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GAErrorString", "[", "h_HTTPResponse", "]"}], ":=", "\n", "\t", 
  RowBox[{"TemplateApply", "[", "\n", "\t\t", 
   RowBox[{"\"\<(`code`) `message`\>\"", ",", "\n", "\t\t", 
    RowBox[{"Lookup", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{"h", ",", "\"\<RawJSON\>\""}], "]"}], ",", "\n", "\t\t\t", 
      "\"\<error\>\"", ",", "\n", "\t\t\t", 
      RowBox[{"<|", "\n", "\t\t\t\t", 
       RowBox[{
        RowBox[{"\"\<code\>\"", "\[Rule]", "\"\<N/A\>\""}], ",", "\n", 
        "\t\t\t\t", 
        RowBox[{
        "\"\<message\>\"", "\[Rule]", "\"\<Unknown error format\>\""}]}], 
       "\n", "\t\t\t\t", "|>"}]}], "\n", "\t\t\t", "]"}]}], "\n", "\t\t", 
   "]"}]}]], "CodeInput",
 CellChangeTimes->{{3.7046383089254007`*^9, 3.704638354161599*^9}, {
  3.7046384220803328`*^9, 3.704638495302215*^9}, {3.704638536368492*^9, 
  3.7046385972370577`*^9}},ExpressionUUID->"dda30932-091f-43ea-95b7-\
c14838d0250d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GAParse", "[", "a_Association", "]"}], ":=", "\n", "\t", 
   RowBox[{"Association", "@", "\n", "\t\t", 
    RowBox[{"KeyValueMap", "[", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"StringReplace", "[", "\n", "\t\t\t\t", 
         RowBox[{
          RowBox[{"StringJoin", "[", "\n", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"Replace", "[", "\n", "\t\t\t\t\t\t", 
              RowBox[{
               RowBox[{"HoldPattern", "[", 
                RowBox[{"Capitalize", "[", "s_String", "]"}], "]"}], 
               "\[RuleDelayed]", "\n", "\t\t\t\t\t\t\t", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"ToUpperCase", "@", 
                  RowBox[{"StringTake", "[", 
                   RowBox[{"s", ",", "1"}], "]"}]}], "<>", 
                 RowBox[{"StringDrop", "[", 
                  RowBox[{"s", ",", "1"}], "]"}]}], ")"}]}], "\n", 
              "\t\t\t\t\t\t", "]"}], "@*", "Capitalize"}], "/@", 
            RowBox[{"StringSplit", "[", 
             RowBox[{"#", ",", "\"\<_\>\""}], "]"}]}], "\n", "\t\t\t\t\t", 
           "]"}], ",", 
          RowBox[{"{", "\n", "\t\t\t\t", 
           RowBox[{
            RowBox[{
             RowBox[{"\"\<Id\>\"", "~~", "EndOfString"}], "\[Rule]", 
             "\"\<ID\>\""}], ",", "\n", "\t\t\t\t", 
            RowBox[{"\"\<Url\>\"", "\[Rule]", "\"\<URL\>\""}], ",", "\n", 
            "\t\t\t\t", 
            RowBox[{"\"\<Html\>\"", "\[Rule]", "\"\<HTML\>\""}]}], "\n", 
           "\t\t\t\t", "}"}]}], "]"}], "->", "\n", "\t\t\t\t", 
        RowBox[{"Which", "[", "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"StringEndsQ", "[", 
           RowBox[{"#", ",", "\"\<_at\>\""}], "]"}], ",", "\n", "\t", "\t", 
          "\t\t\t\t", 
          RowBox[{"DateObject", "@", "#2"}], ",", "\n", "\t", "\t\t\t\t", 
          RowBox[{"StringEndsQ", "[", 
           RowBox[{"#", ",", "\"\<url\>\""}], "]"}], ",", "\n", "\t", 
          "\t\t\t\t\t", 
          RowBox[{"URL", "[", "#2", "]"}], ",", "\n", "\t\t\t\t\t", "True", 
          ",", "\n", "\t\t\t\t\t\t", 
          RowBox[{"GAParse", "@", "#2"}]}], "\n", "\t\t\t\t\t", "]"}]}], 
       "&"}], ",", "\n", "\t\t", "a"}], "\n", "\t\t", "]"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GAParse", "[", "h_HTTPResponse", "]"}], ":=", "\n", "\t", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"200", "<=", 
       RowBox[{"h", "[", "\"\<StatusCode\>\"", "]"}], "<", "300"}], ",", " ", 
      "\n", "\t", "\t", 
      RowBox[{
       RowBox[{"Success", "[", 
        RowBox[{
         RowBox[{"\"\<Status:\>\"", "<>", 
          RowBox[{"ToString", "@", 
           RowBox[{"h", "[", "\"\<StatusCode\>\"", "]"}]}]}], ",", " ", "\n", 
         "\t\t\t", 
         RowBox[{"Insert", "[", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"AssociationQ", "@", 
              RowBox[{"#", "[", "\"\<Content\>\"", "]"}]}], ",", " ", "\n", 
             "\t", "\t\t\t\t", 
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"KeyDrop", "[", 
                RowBox[{"#", ",", " ", "\"\<Content\>\""}], "]"}], ",", " ", 
               RowBox[{"#", "[", "\"\<Content\>\"", "]"}]}], "]"}], ",", "\n",
              "\t\t\t\t\t", "#"}], "\n", "\t\t\t\t\t", "]"}], ",", "\n", 
           "\t\t\t\t", 
           RowBox[{"\"\<ContentBytes\>\"", "\[Rule]", 
            RowBox[{"ByteCount", "[", 
             RowBox[{"#", "[", "\"\<Content\>\"", "]"}], "]"}]}], ",", "\n", 
           "\t\t\t\t", "2"}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", 
        "]"}], "&"}], ",", "\n", "\t\t", 
      RowBox[{
       RowBox[{"Failure", "[", 
        RowBox[{
         RowBox[{"\"\<Status:\>\"", "<>", 
          RowBox[{"ToString", "@", 
           RowBox[{"h", "[", "\"\<StatusCode\>\"", "]"}]}]}], ",", " ", "\n", 
         "\t\t\t", 
         RowBox[{"Insert", "[", 
          RowBox[{"#", ",", "\n", "\t\t\t\t", 
           RowBox[{"\"\<ContentBytes\>\"", "\[Rule]", 
            RowBox[{"ByteCount", "[", 
             RowBox[{"#", "[", "\"\<Content\>\"", "]"}], "]"}]}], ",", "\n", 
           "\t\t\t\t", "2"}], "\n", "\t\t\t\t", "]"}]}], "\n", "\t\t\t", 
        "]"}], "&"}]}], "\n", "\t\t", "]"}], "@", "\n", "\t\t", 
    RowBox[{"<|", "\n", "\t\t\t", 
     RowBox[{
      RowBox[{"\"\<StatusCode\>\"", "->", "\n", "\t", "\t\t\t", 
       RowBox[{"h", "[", "\"\<StatusCode\>\"", "]"}]}], ",", "\n", "\t", 
      "\t\t", 
      RowBox[{"\"\<Content\>\"", "->", "\n", "\t", "\t\t\t", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MatchQ", "[", 
          RowBox[{
           RowBox[{"h", "[", "\"\<StatusCode\>\"", "]"}], ",", 
           RowBox[{"0", "|", 
            RowBox[{"(", 
             RowBox[{"_", "?", 
              RowBox[{"(", 
               RowBox[{"Between", "@", 
                RowBox[{"{", 
                 RowBox[{"200", ",", "299"}], "}"}]}], ")"}]}], ")"}]}]}], 
          "]"}], ",", "\n", "\t", "\t\t\t\t", 
         RowBox[{"Switch", "[", "\n", "\t", "\t\t\t\t\t", 
          RowBox[{
           RowBox[{"h", "[", "\"\<ContentType\>\"", "]"}], ",", "\n", "\t", 
           "\t\t\t\t\t\t", 
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{"StringContainsQ", "@", "\"\<text/x-objcsrc\>\""}], 
             ")"}]}], ",", "\n", "\t", "\t\t\t\t\t\t\t", 
           RowBox[{"h", "[", "\"\<BodyByteArray\>\"", "]"}], ",", "\n", "\t", 
           "\t\t\t\t\t\t", 
           RowBox[{"_", "?", 
            RowBox[{"(", 
             RowBox[{"StringContainsQ", "@", "\"\<text/\>\""}], ")"}]}], ",", 
           "\n", "\t", "\t\t\t\t\t\t\t", 
           RowBox[{"Import", "[", 
            RowBox[{"h", ",", "\"\<Text\>\""}], "]"}], ",", "\n", 
           "\t\t\t\t\t\t\t", "_", ",", "\n", "\t\t\t\t\t\t\t\t", 
           RowBox[{"With", "[", "\n", "\t\t\t\t\t\t\t\t\t", 
            RowBox[{
             RowBox[{"{", "\n", "\t\t\t\t\t\t\t\t\t\t", 
              RowBox[{"clean", "=", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
               RowBox[{
               "FromCharacterCode", "@", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                RowBox[{"ToCharacterCode", "[", 
                 RowBox[{
                  RowBox[{"Import", "[", 
                   RowBox[{"h", ",", " ", "\"\<Text\>\""}], "]"}], ",", " ", 
                  "\"\<UTF-8\>\""}], "]"}]}]}], "\n", "\t\t\t\t\t\t\t\t\t\t", 
              "}"}], ",", "\n", "\t\t\t\t\t\t\t\t\t", 
             RowBox[{"GAParse", "@", "\n", "\t\t\t\t\t\t\t\t\t\t", 
              RowBox[{"Replace", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
               RowBox[{
                RowBox[{"Quiet", "@", 
                 RowBox[{"ImportString", "[", 
                  RowBox[{"clean", ",", " ", "\"\<RawJSON\>\""}], "]"}]}], 
                ",", "\n", "\t\t\t\t\t\t\t\t\t\t\t", 
                RowBox[{
                 RowBox[{"Except", "[", 
                  RowBox[{"_String", "|", "_Association", "|", "_List"}], 
                  "]"}], ":>", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                 RowBox[{"Replace", "[", "\n", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                  RowBox[{
                   RowBox[{"Quiet", "@", 
                    RowBox[{"ImportString", "[", 
                    RowBox[{"clean", ",", " ", "\"\<JSON\>\""}], "]"}]}], ",",
                    "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t", 
                   RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t\t\t\t\t\t\t\t", 
                    RowBox[{
                    RowBox[{"Except", "[", 
                    RowBox[{"_Association", "?", "AssociationQ"}], "]"}], ":>", 
                    RowBox[{"Import", "[", 
                    RowBox[{"h", ",", "\"\<Text\>\""}], "]"}]}], "\n", 
                    "\t\t\t\t\t\t\t\t\t\t\t\t\t\t", "}"}]}], "\n", 
                  "\t\t\t\t\t\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", 
               "\t\t\t\t\t\t\t\t\t\t\t", "]"}]}]}], "\n", 
            "\t\t\t\t\t\t\t\t\t", "]"}]}], "\n", "\t\t\t\t\t\t", "]"}], ",", 
         "\n", "\t\t\t\t\t", 
         RowBox[{
          RowBox[{"With", "[", "\n", "\t", "\t\t\t\t\t", 
           RowBox[{
            RowBox[{"{", "\n", "\t", "\t\t\t\t\t\t", 
             RowBox[{
              RowBox[{"head", "=", "\n", "\t", "\t\t\t\t\t\t\t", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"$GAActiveHead", "===", 
                  RowBox[{"Unevaluated", "[", "$GAActiveHead", "]"}]}], ",", 
                 " ", "\n", "\t", "\t\t\t\t\t\t\t\t", "GoogleDrive", ",", " ",
                  "\n", "\t", "\t\t\t\t\t\t\t\t", "$GAActiveHead"}], "\n", 
                "\t", "\t\t\t\t\t\t\t\t", "]"}]}], ",", "\n", "\t", 
              "\t\t\t\t\t\t", 
              RowBox[{"errStr", "=", 
               RowBox[{"GAErrorString", "@", "h"}]}]}], "\n", "\t", 
             "\t\t\t\t\t\t", "}"}], ",", "\n", "\t", "\t\t\t\t\t", 
            RowBox[{
             RowBox[{"$GALastError", "=", "errStr"}], ";", "\n", "\t", 
             "\t\t\t\t\t", 
             RowBox[{"Message", "[", 
              RowBox[{
               RowBox[{"head", "::", "err"}], ",", " ", "errStr"}], "]"}]}]}],
            "\n", "\t", "\t\t\t\t\t", "]"}], ";", "\n", "\t", "\t\t\t\t", 
          "$Failed"}]}], "\n", "\t", "\t\t\t\t", "]"}]}]}], "\n", "\t", 
     "\t\t", "|>"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GAParse", "[", "s_String", "]"}], ":=", "\n", "\t", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"StringLength", "@", 
       RowBox[{"StringTrim", "@", "s"}]}], ">", "0"}], ",", "\n", "\t\t", 
     RowBox[{"Which", "[", "\n", "\t\t\t", 
      RowBox[{
       RowBox[{"Quiet", "[", "\n", "\t", "\t\t\t", 
        RowBox[{
         RowBox[{"AllTrue", "[", "\n", "\t", "\t\t\t\t", 
          RowBox[{
           RowBox[{"URLParse", "[", 
            RowBox[{"s", ",", 
             RowBox[{"{", 
              RowBox[{"\"\<Scheme\>\"", ",", "\"\<Domain\>\""}], "}"}]}], 
            "]"}], ",", "\n", "\t", "\t\t\t\t", "StringQ"}], "\n", "\t", 
          "\t\t\t\t", "]"}], ",", "\n", "\t", "\t\t\t", 
         RowBox[{"URLParse", "::", "nvldval"}]}], "\n", "\t", "\t\t\t", "]"}],
        ",", "\n", "\t", "\t\t\t", 
       RowBox[{"URL", "[", "s", "]"}], ",", "\n", "\t\t\t", 
       RowBox[{
        RowBox[{"StringContainsQ", "[", 
         RowBox[{"s", ",", 
          RowBox[{"Verbatim", "[", "\"\<@\>\"", "]"}]}], "]"}], "&&", "\n", 
        "\t\t\t", 
        RowBox[{"Not", "@", 
         RowBox[{"FailureQ", "@", "\n", "\t\t\t\t", 
          RowBox[{
           RowBox[{"Interpreter", "[", "\"\<EmailAddress\>\"", "]"}], "[", 
           "s", "]"}]}]}]}], ",", "\n", "\t", "\t", "\t\t\t", 
       RowBox[{"Interpretation", "[", "\n", "\t", "\t", "\t\t\t\t", 
        RowBox[{
         RowBox[{"Hyperlink", "[", 
          RowBox[{"s", ",", 
           RowBox[{"\"\<mailto:\>\"", "<>", "s"}]}], "]"}], ",", "\n", "\t", 
         "\t", "\t\t\t\t", "s"}], "\n", "\t", "\t", "\t\t\t\t", "]"}], ",", 
       "\n", "\t", "\t\t", "True", ",", "\n", "\t\t\t\t", "s"}], "\n", 
      "\t\t\t", "]"}], ",", "\n", "\t\t", "s"}], "\n", "\t\t", "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GAParse", "[", "l_List", "]"}], ":=", "\n", "\t", 
   RowBox[{"GAParse", "/@", "l"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"GAParse", "[", "e_", "]"}], ":=", "\n", "\t", "e"}], 
  ";"}]}], "CodeInput",ExpressionUUID->"9a5df5d2-4cc2-4724-83cc-eaacf988355e"]\

}, Closed]]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"End", "[", "]"}], 
  ";"}]], "InputSection",ExpressionUUID->"f83d489e-71b0-4387-ba75-\
f12100be1d3e"]
}, Open  ]],

Cell["", "SectionSeparator",ExpressionUUID->"7d46921f-36b4-414a-b43f-\
6fecf718d29f"]
},
WindowSize->{748, 767},
WindowMargins->{{Automatic, 166}, {29, Automatic}},
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->FrontEnd`FileName[{"BTools"}, "CodePackage.nb", 
  CharacterEncoding -> "UTF-8"]
]

